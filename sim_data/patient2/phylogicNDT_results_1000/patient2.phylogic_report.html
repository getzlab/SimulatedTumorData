<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head>
  <title>patient2 Phylogic Report</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
  <script src="https://d3js.org/d3.v5.js"></script>
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.sample_name_table", {

        options: {
          columns: [],
          sample_names: [],
          sample_aliases: [],
          sample_dates: [],
          pie_plots: []
        },


        _create: function() {
          let columns = this.options.columns;

          let table = d3.select(this.element.context).append("table")
            .attr("class", "table table-bordered hover");

          table.append("thead")
            .selectAll("td")
            .data(columns)
            .join("td")
            .attr("style", "font-weight:bold; font-size: 12px")
            .html(d => d);

          table.append("tbody")
            .selectAll("tr")
            .data(this.options.sample_names)
            .join("tr")
            .attr("style", "font-size: 12px; cursor: pointer;")
            .attr("class", "active-sample")
            .attr("onclick", "$(\"#sample-name-table\").sample_name_table(\"toggle_sample\", this)")
            .html((d, i) => "<td>" + d + "</td>"
              + (this.options.sample_aliases.length ? "<td>" + this.options.sample_aliases[i] + "</td>" : "")
              + (this.options.sample_dates.length ? "<td>" + this.options.sample_dates[i] + "</td>" : "")
              + "<td><img src=data:image/png;base64," + this.options.pie_plots[i] + " alt=\"Run BuildTree to display\"></td>");

        },

        toggle_sample: function(row) {
          if (row.className === "active-sample") {
            row.className = "removed-sample";
          } else {
            row.className = "active-sample"
          }
        }

      });

      $("#sample-name-table").sample_name_table({"sample_aliases": ["T0", "T1", "T2"], "pie_plots": ["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"], "sample_names": ["p2_t1", "p2_t2", "p2_t3"], "sample_dates": [100.0, 150.0, 180.0], "columns": ["Sample Name", "Alias", "Date", "Clonal Abundance"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.clustering_plot", {

        options: {
          xlabels: [],
          time_points: [],
          cluster_dict: {},
          width: 500,
          height: 400,
          margins: {top: 20, right: 50, bottom: 35, left: 50}
        },

        _elements: {
          nd: undefined,
          real_time: undefined,
          scaled: undefined,
          time_agnostic_plot: undefined,
          time_scaled_plot: undefined,
          plot_1d: undefined,
          t: undefined,
          n: undefined,
          y: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            n_samples = xlabels.length,
            unscaled_x = [...Array(n_samples).keys()];

          this._elements.nd = xlabels.length > 1;
          this._elements.real_time = time_points.reduce((a, c, i) => a || !(c===i), false);
          this._elements.scaled = this._elements.real_time;

          if (this._elements.nd) {
            let n = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let time_agnostic_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("overflow", "visible")
              .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
              .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
              .style("display", this._elements.real_time ? "none" : "block")
              .style("max-height", "450px");
            time_agnostic_plot.append("g")
              .call(g => g
                .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                .call(d3.axisBottom(n).tickValues(unscaled_x).tickFormat(d => xlabels[d]))
              );
            time_agnostic_plot.append("g")
              .call(yAxis);
            time_agnostic_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            time_agnostic_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            for (let clust in cluster_dict) {
              time_agnostic_plot.append("path")
                .datum(unscaled_x)
                .attr("fill", "none")
                .attr("stroke", cluster_dict[clust].color)
                .attr("stroke-width", cluster_dict[clust].line_width)
                .attr("opacity", 0.5)
                .attr("d", d3.line()
                  .x(d => n(d))
                  .y(d => y(cluster_dict[clust].ccf_hat[d])));
              time_agnostic_plot.append("polygon")
                .attr("fill", cluster_dict[clust].color)
                .attr("stroke", "none")
                .attr("opacity", 0.2)
                .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + n(i) + "," + y(c) + " ", "") +
                  cluster_dict[clust].ccf_low.reverse().reduce((a, c, i) => a + n(n_samples - i - 1) + "," + y(c) + " ", "")
                );
              time_agnostic_plot.append("g").selectAll("circle")
                .data(unscaled_x)
                .join("circle")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("r", 7)
                  .attr("opacity", 1.0)
                  .attr("cx", d => n(d))
                  .attr("cy", d => y(cluster_dict[clust].ccf_hat[d]))
            }
            time_agnostic_plot.append("g")
              .style("display", "none")
              .attr("class", "tooltip_");

            this._elements.n = n;
            this._elements.time_agnostic_plot = time_agnostic_plot.node();

            if (this._elements.real_time) {
              let t = d3.scaleLinear()
                .domain([Math.min(...time_points), Math.max(...time_points)])
                .range([margins.left, width - margins.right]);

              let time_scaled_plot = d3.select(document.createElement("svg"))
                .attr("baseProfile", "full")
                .attr("viewBox", "0 0 " + width + " " + height)
                .attr("version", "1.1")
                .attr("xmlns", "http://www.w3.org/2000/svg")
                .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
                .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
                .attr("overflow", "visible")
                .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
                .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
                .style("display", "block")
                .style("max-height", "450px");
              time_scaled_plot.append("g")
                .call(g => g
                  .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                  .call(d3.axisBottom(t))
                );
              time_scaled_plot.append("g")
                .call(yAxis);
              time_scaled_plot.append("text")
                .attr("x", (width + margins.left - margins.right) / 2)
                .attr("y", height - 5)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("Time");
              time_scaled_plot.append("text")
                .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
                .attr("x", 10)
                .attr("y", (height + margins.top - margins.bottom) / 2)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("CCF(x)");
              for (let clust in cluster_dict) {
                time_scaled_plot.append("path")
                  .datum(time_points)
                  .attr("fill", "none")
                  .attr("stroke", cluster_dict[clust].color)
                  .attr("stroke-width", cluster_dict[clust].line_width)
                  .attr("opacity", 0.5)
                  .attr("d", d3.line()
                    .x(d => t(d))
                    .y((d, i) => y(cluster_dict[clust].ccf_hat[i])));
                time_scaled_plot.append("polygon")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("opacity", 0.2)
                  .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + t(time_points[i]) + "," + y(c) + " ", "") +
                    cluster_dict[clust].ccf_low.reduce((a, c, i) => a + t(time_points[n_samples - i - 1]) + "," + y(c) + " ", "")
                  );
                time_scaled_plot.append("g").selectAll("circle")
                  .data(time_points)
                  .join("circle")
                    .attr("fill", cluster_dict[clust].color)
                    .attr("stroke", "none")
                    .attr("r", 7)
                    .attr("opacity", 1.0)
                    .attr("cx", d => t(d))
                    .attr("cy", (d, i) => y(cluster_dict[clust].ccf_hat[i]))
              }
              time_scaled_plot.append("g")
                .style("display", "none")
                .attr("class", "tooltip_");
              
              this._elements.t = t;
              this._elements.time_scaled_plot = time_scaled_plot.node()
            }
            for (let clust in cluster_dict) {
              cluster_dict[clust].ccf_low.reverse();
            }
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              max_bin = Math.max(max_bin, ...cluster_dict[c].ccf_dist);
              n_bins = cluster_dict[c].ccf_dist.length
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("style", "max-height: 450px");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            plot_1d.selectAll("polygon")
              .data(Object.keys(cluster_dict))
              .join("polygon")
              .attr("points", d =>
                cluster_dict[d].ccf_dist.reduce(
                  (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                ) + zero_str
              )
              .attr("fill", d => cluster_dict[d].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");

            this._elements.plot_1d = plot_1d.node()
          }
          
          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.nd ?
            (this._elements.real_time ? this._elements.time_scaled_plot.outerHTML : "") + this._elements.time_agnostic_plot.outerHTML :
            this._elements.plot_1d.outerHTML;
        },

        switch_plot: function() {
          let display = this._elements.time_agnostic_plot.style.display === "none";
          this._elements.time_agnostic_plot.style.display = display ? "block" : "none";
          this._elements.time_scaled_plot.style.display = display ? "none" : "block";
          this._elements.scaled = !this._elements.scaled;

          this._refresh();
        },

        show_value: function(eve, plot) {
          let {width, height} = plot.getBoundingClientRect(),
            mouse_pos_x = eve.layerX * this.options.width / width,
            mouse_pos_y = eve.layerY * this.options.height / height,
            cluster_dict = this.options.cluster_dict,
            xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tooltip = d3.select(plot).select(".tooltip_"),
            x,
            n;

          if (this._elements.scaled) {
            let scale_x = this._elements.t,
              x_s = scale_x.invert(mouse_pos_x),
              t = time_points.reduce((a, c) => (Math.abs(c - x_s) < Math.abs(a - x_s) ? c : a));
            n = time_points.indexOf(t);
            x = scale_x(t);
          } else {
            let scale_x = this._elements.n;
            n = Math.round(scale_x.invert(mouse_pos_x));
            x = scale_x(n);
          }

          tooltip
            .attr("style", "display: block;")
            .attr("transform", "translate(" + x + "," + mouse_pos_y + ")");

          let border = tooltip.selectAll("path")
            .data([null])
            .join("path")
              .attr("fill", "white")
              .attr("stroke", "black");

          let text_el = tooltip.selectAll("text")
            .data([null])
            .attr("font-size", "9px")
            .join("text")
            .call(t => t
              .selectAll("tspan")
              .data([xlabels[n], ...Object.keys(cluster_dict)])
              .join("tspan")
                .attr("x", 0)
                .attr("y", (d, i) => (i * 1.1) + "em")
                .style("font-weight", (d, i) => i ? null : "bold")
                .style("fill", (d, i) => i ? cluster_dict[d].color : "black")
                .text((d, i) => i ? cluster_dict[d].ccf_hat[n] + " (" + cluster_dict[d].ccf_low[n] + "-" +
                  cluster_dict[d].ccf_high[n] + ")" : d)
            );

          let {y, width: w, height: h} = text_el.node().getBBox();

          text_el.attr("transform", "translate(" + (-w / 2) + "," + (15 - y) + ")");
          border.attr("d", "M" + (-w / 2 - 10) + ",5H-5l5,-5l5,5H" +
            (w / 2 + 10) + "v" + (h + 20) +
            "h-" + (w + 20) + "z");
        },

        hide_value: function(plot) {
          d3.select(plot).select(".tooltip_").style("display", "none")
        },

        download: function() {
          let dl_link;
          if (this._elements.scaled) {
            let time_scaled_plot = this._elements.time_scaled_plot.cloneNode(true);
            time_scaled_plot.removeAttribute("onmousemove");
            time_scaled_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_scaled_plot.outerHTML);
          } else if (this._elements.nd) {
            let time_agnostic_plot = this._elements.time_agnostic_plot.cloneNode(true);
            time_agnostic_plot.removeAttribute("onmousemove");
            time_agnostic_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_agnostic_plot.outerHTML);
          } else {
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.plot_1d.outerHTML);
          }
          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".clustering_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
        }

      });

      $("#clustering-plot").clustering_plot({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"], "time_points": [100.0, 150.0, 180.0]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.time_switch", {

        options: {show: true},

        _elements: {time_switch: undefined, input: undefined},

        _create: function() {
          if (this.options.show) {
            let time_switch = d3.select(document.createElement("label"))
              .html("Time-scaled");
            this._elements.input = time_switch.append("input")
              .attr("type", "checkbox")
              .attr("checked", "")
              .attr("onclick", "$(\"#time-switch\").time_switch(\"switch_plot\")")
              .node();

            this._elements.time_switch = time_switch.node();

            this._refresh()

          }
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.time_switch.outerHTML;
        },

        is_checked: function() {
          if (this.options.show) {
            return this._elements.input.hasAttribute("checked")
          }
          return true
        },

        switch_plot: function() {
          if (this.is_checked()) {
            this._elements.input.removeAttribute("checked");
          } else {
            this._elements.input.setAttribute("checked", "");
          }
          $("#clustering-plot").clustering_plot("switch_plot");

          this._refresh();
        }

      });

      $("#time-switch").time_switch({"show": true})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_switches", {
        options: {
          cluster_dict: {},
          time_points: [],
          xlabels: [],
          tumor_sizes: {},
          child_dict: {}
        },

        _elements: {
          active_clusters: [],
          svg_switches: undefined
        },

        _create: function() {
          let cluster_dict = this.options.cluster_dict,
            svg_layout = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          for (let c in cluster_dict) {
            this._elements.active_clusters.push(c);
          }
          svg_layout.attr("viewBox", "0 0 120 " + ((this._elements.active_clusters.length + 2) * 30));
          svg_layout.selectAll("rect")
            .data(this._elements.active_clusters)
            .join("rect")
            .attr("class", "active-cluster")
            .attr("style", "cursor: pointer;")
            .attr("cluster", (_, i) => i + 1)
            .attr("x", 0)
            .attr("y", (_, i) => i * 30 + 30)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", d => cluster_dict[d].color)
            .attr("stroke", "none")
            .attr("opacity", 0.8)
            .attr("onclick", "$(\"#cluster-switches\").cluster_switches(\"toggle_cluster\", this)");
          svg_layout.selectAll("text")
            .data(this._elements.active_clusters)
            .join("text")
            .attr("x", 30)
            .attr("y", (_, i) => i * 30 + 45)
            .attr("fill", d => cluster_dict[d].color)
            .text(d => d + " (" + Object.keys(cluster_dict[d].muts).length.toString() + ")");
          svg_layout.append("text")
            .attr("x", 0)
            .attr("y", 15)
            .attr("font-size", "11.5px")
            .text("Cluster (# variants)");

          this._elements.svg_switches = svg_layout.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_switches.outerHTML;
        },

        toggle_cluster: function(cluster_switch) {
          let c = cluster_switch.getAttribute("cluster"),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            active_clusters = this._elements.active_clusters,
            cluster_dict_subset = {},
            altered_child_dict = {};
          if (cluster_switch.getAttribute("class") === "active-cluster") {
            cluster_switch.setAttribute("class", "removed-cluster");
            for (let i in active_clusters) {
              if (active_clusters[i] === c) {
                active_clusters.splice(i, 1);
                break;
              }
            }
          } else {
            cluster_switch.setAttribute("class", "active-cluster");
            active_clusters.push(c);
          }

          let get_new_children = function(cluster) {
            let children = [];
            for (let i in child_dict[cluster]) {
              if (active_clusters.includes(child_dict[cluster][i].toString())) {
                children.push(child_dict[cluster][i])
              } else {
                children.push(...get_new_children(child_dict[cluster][i]))
              }
            }
            return children
          };

          for (let i in active_clusters) {
            let active_cluster = active_clusters[i];
            cluster_dict_subset[active_cluster] = cluster_dict[active_cluster];
            if (child_dict) {
              altered_child_dict[active_cluster] = get_new_children(active_cluster)
            }
          }
          if (child_dict) {
            altered_child_dict[null] = get_new_children(null);
          }

          let clustering_plot = $("#clustering-plot");
          clustering_plot.clustering_plot("destroy");
          clustering_plot.clustering_plot({
            xlabels: this.options.xlabels,
            time_points: this.options.time_points,
            cluster_dict: cluster_dict_subset});
          if (!$("#time-switch").time_switch("is_checked")) {
            clustering_plot.clustering_plot("switch_plot");
          }

          let mutation_plot = $("#mutation-plot");
          mutation_plot.mutation_plot("destroy");
          mutation_plot.mutation_plot({
            xlabels: this.options.xlabels,
            cluster_dict: cluster_dict_subset});

          if (child_dict) {
            let fish_plot = $("#fish-plot");
            fish_plot.fish_plot("destroy");
            fish_plot.fish_plot({
              xlabels: this.options.xlabels,
              time_points: this.options.time_points,
              tumor_sizes: this.options.tumor_sizes,
              cluster_dict: cluster_dict_subset,
              child_dict: altered_child_dict
            })
          }
        }
      });

      $("#cluster-switches").cluster_switches({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"], "child_dict": {"1": [2, 3], "2": [4], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, "time_points": [100.0, 150.0, 180.0], "tumor_sizes": [[100.0, 1.0], [150.0, 1.0], [180.0, 1.0]]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree", {

        options: {
          patient: "",
          child_dict: {},
          tree_coordinates: {},
          cluster_dict: {}
        },

        _elements: {
          svg_tree: undefined,
          branch_trunc_labels: {},
          branch_full_labels: {}
        },

        _create: function() {
          let patient = this.options.patient,
            child_dict = this.options.child_dict,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            clusters = Object.keys(tree_coordinates),
            edges = [];

          for (let parent in child_dict) {
            child_dict[parent].forEach(function(child) {
              edges.push([parent, child])
            })
          }

          let svg_tree = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("style", "max-height: 600px;")
            .attr("width", this.element.context.parentNode.getBoundingClientRect().width);
          svg_tree.append("g")
            .append("text")
              .attr("x", -20)
              .attr("y", 40)
              .attr("text-anchor", "end")
              .attr("font", "Arial")
              .attr("font-size", "20px")
              .html(patient);

          let branch_cont = svg_tree.append("g")
            .selectAll("line")
            .data(edges)
            .join("line")
            .attr("x1", d => tree_coordinates[d[0]][0])
            .attr("y1", d => tree_coordinates[d[0]][1])
            .attr("x2", d => tree_coordinates[d[1]][0])
            .attr("y2", d => tree_coordinates[d[1]][1])
            .attr("stroke", d => cluster_dict[d[1]].color)
            .attr("stroke-width", 8)
            .attr("opacity", 1.0)
            .attr("class", d => d[1]);

          let node_cont = svg_tree.append("g")
            .selectAll("circle")
            .data(clusters)
            .join("circle")
            .attr("cx", d => tree_coordinates[d][0])
            .attr("cy", d => tree_coordinates[d][1])
            .attr("r", d => d !== "null" ? 12 : 24)
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .attr("fill", d => d !== "null" ? cluster_dict[d].color : "blue")
            .attr("opacity", 1.0);

          let node_label_cont = svg_tree.append("g")
            .selectAll("text")
            .data(clusters)
            .join("text")
            .attr("x", d => tree_coordinates[d][0])
            .attr("y", d => tree_coordinates[d][1] + 5)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .text(d => d !== "null" ? d : "normal");

          let branch_label_cont = svg_tree.append("g"),
            branch_trunc_labels = {},
            branch_full_labels = {};
          for (let e in edges) {
            let edge = edges[e],
              cnvs = Object.keys(cluster_dict[edge[1]].muts).filter(m => m.startsWith("loss") || m.startsWith("gain") || m === "WGD"),
              branch_height = Math.abs(tree_coordinates[edge[0]][1] - tree_coordinates[edge[1]][1]),
              n_labels = Math.max(4, branch_height / 10 - 2),
              label_list = [Object.keys(cluster_dict[edge[1]].muts).length, ...cluster_dict[edge[1]].drivers, ...cnvs],
              truncate = label_list.length > n_labels + 1,
              trunc_labels = truncate ? [...label_list.slice(0, n_labels), "..."] : label_list;
            branch_trunc_labels[edge[1]] = (trunc_labels);
            branch_full_labels[edge[1]] = (label_list);
            branch_label_cont.append("text")
              .attr("y", (tree_coordinates[edge[0]][1] + tree_coordinates[edge[1]][1]) / 2 - (5 * (trunc_labels.length)))
              .attr("text-anchor", "middle")
              .attr("font-size", 10)
              .attr("font-weight", "bold")
              .attr("parent", edge[0])
              .attr("child", edge[1])
              .selectAll("tspan")
              .data(trunc_labels)
              .join("tspan")
              .attr("x", (tree_coordinates[edge[0]][0] + tree_coordinates[edge[1]][0]) / 2)
              .attr("dy", 10)
              .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
              .attr("style", d => d === "..." ? "cursor: pointer;" : "")
              .text((d, i) => i ? d : "(" + d + ")");
          }

          let x_values = Object.values(tree_coordinates).map(p => p[0]),
            y_values = Object.values(tree_coordinates).map(p => p[1]),
            x_min = Math.min(...x_values),
            x_max = Math.max(...x_values),
            y_min = Math.min(...y_values),
            y_max = Math.max(...y_values),
            view_x_min = x_max - x_min > 300 ? x_min - 50 : (x_min + x_max) / 2 - 200,
            view_y_min = y_max - y_min > 400 ? y_min - 50 : (y_min + y_max) / 2 - 250,
            view_width = x_max - x_min > 300 ? x_max - x_min + 100 : 400,
            view_height = y_max - y_min > 400 ? y_max - y_min + 100 : 500;

          svg_tree.attr("viewBox", [view_x_min, view_y_min, view_width, view_height].join(","));

          this._elements.svg_tree = svg_tree.node();
          this._elements.branch_full_labels = branch_full_labels;
          this._elements.branch_trunc_labels = branch_trunc_labels;

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_tree.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.svg_tree.outerHTML.replace("viewbox", "viewBox")),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".tree.svg");
          dl.click();
        },

        expand: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            label_list = [...this._elements.branch_full_labels[child], "Condense ^"],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (label_list.length)))
            .selectAll("tspan")
            .data(label_list)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "Condense ^" ? "$(\"#tree\").tree(\"condense\", this)" : "")
            .attr("style", d => d === "Condense ^" ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        condense: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            trunc_labels = this._elements.branch_trunc_labels[child],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (trunc_labels.length)))
            .selectAll("tspan")
            .data(trunc_labels)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
            .attr("style", d => d === "..." ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }

      });

      let tree_options = {"tree_coordinates": {"1": [0.0, 200.0], "2": [-71.7700161798944, 353.91129638286657], "3": [137.540386107055, 296.3068151604339], "4": [-98.30102280437211, 504.3761119084241], "5": [235.209610368322, 412.7044640596884], "6": [192.63400158526562, 270.6162403474975], "null": [0.0, 0.0]}, "cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "child_dict": {"1": [2, 3], "2": [4], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, "patient": "patient2"};

      if (tree_options) {
        let tree_div = $("#tree");
        d3.select(tree_div[0].parentElement).append("button")
          .attr("onclick", "$(\"#tree\").tree(\"download\")")
          .attr("style", "font-size: 12px;")
          .html("Download as SVG");
        tree_div.tree(tree_options)
      } else {
        $("#tree").append("h3")
          .html("Run BuildTree to display tree")
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree_switch", {
        options: {
          patient: "",
          tree_iterations: [],
          child_dicts: [],
          tree_coordinates: [],
          cluster_dict: {}
        },

        _create: function() {
          let tree_iterations = this.options.tree_iterations,
            widg = this;

          let dropdown = d3.select(this.element.context).append("select")
            .attr("class", "form-control");

          dropdown.selectAll("option")
            .data(tree_iterations)
            .join("option")
            .html((d, i) => "Tree " + (i + 1) + " (" + d + ")");

          dropdown.on("change", function() {widg.switch_tree(this.selectedIndex)})
        },

        switch_tree: function(i) {
          let patient = this.options.patient,
            child_dicts = this.options.child_dicts,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            tree = $("#tree");

          tree.tree("destroy");

          tree.tree({
            patient: patient,
            child_dict: child_dicts[i],
            tree_coordinates: tree_coordinates[i],
            cluster_dict: cluster_dict
          })
        }
      });

      let tree_switch_options = {"tree_coordinates": [{"1": [0.0, 200.0], "2": [-71.7700161798944, 353.91129638286657], "3": [137.540386107055, 296.3068151604339], "4": [-98.30102280437211, 504.3761119084241], "5": [235.209610368322, 412.7044640596884], "6": [192.63400158526562, 270.6162403474975], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [120.08251824623954, 320.08251824623954], "3": [-118.7273356410051, 318.7273356410051], "4": [133.3986936260619, 472.2870993103519], "5": [270.42438683047544, 333.2357274006644], "6": [-161.7117054786566, 361.7117054786566], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [84.91116295387332, 347.07044836586874], "3": [224.93737329746165, 412.36574259150666], "4": [20.341018581992202, 485.5415698296692], "5": [-135.08283263344734, 294.58601769266045], "6": [280.21135872983047, 444.2781929600683], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-14.800990949624502, 369.17610068690567], "3": [165.35494177773685, 229.15653762889235], "4": [-79.37113532150562, 507.6472221507061], "5": [314.9928747959065, 255.54174255744172], "6": [39.56605447119988, 394.5278703178967], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [71.77001617989441, 353.91129638286657], "3": [-27.54184489824496, 472.2665636099563], "4": [148.16300509845968, 486.2278345318678], "5": [-149.45531048137198, 269.6921558293968], "6": [129.71339261574255, 338.3854154601485], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [97.40608450701123, 339.11030543324205], "3": [237.43229485059956, 404.40559965887996], "4": [45.1502024690034, 482.68216136635294], "5": [372.2050052050274, 482.2166602614243], "6": [-46.88348079388023, 255.8735566694284], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [14.800990949624557, 369.17610068690567], "3": [-62.44992333493173, 502.97860915890556], "4": [131.84184025825772, 467.38503417445537], "5": [-149.45531048137198, 269.6921558293968], "6": [63.165942798959904, 236.468874078596], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [97.40608450701123, 339.11030543324205], "3": [-128.6233114063707, 307.92777316188614], "4": [97.40608450701124, 491.8962832703726], "5": [248.3222346052022, 339.11030543324205], "6": [97.40608450701124, 556.4069318560786], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [29.489337421039743, 367.24234318851484], "3": [69.47735315789083, 516.479649612307], "4": [-108.98178404276067, 431.812487560396], "5": [135.2461035099859, 657.5211898956402], "6": [89.24846469967162, 362.01409700943174], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-29.489337421039725, 367.24234318851484], "3": [157.77984903526308, 257.42716861585075], "4": [-16.173162041217346, 519.4469242526272], "5": [307.41778205343275, 283.81237354440015], "6": [16.082162251635665, 575.3147847424593], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [97.40608450701123, 339.11030543324205], "3": [44.56334695572543, 484.29453363756664], "4": [240.97794044012213, 391.3661874712499], "5": [-126.3250870471079, 305.9993339496661], "6": [301.59812087822297, 413.4301287465649], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [71.77001617989441, 353.91129638286657], "3": [98.59897715712931, 506.0658950122918], "4": [222.23483170545194, 327.3802897583888], "5": [-1.4329941466385776, 625.2793561878381], "6": [156.44398170202527, 533.0394636175874], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [84.91116295387332, 347.07044836586874], "3": [-145.41069542030883, 283.95290414396595], "4": [-2.7232737383578893, 472.2253944498468], "5": [171.47311051501327, 470.6937212350262], "6": [141.2808776651682, 326.5535500968797], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [58.08265624686594, 359.58078650020906], "3": [-7.212637978771966, 499.6069968437974], "4": [201.65451217997685, 411.8366685382169], "5": [-72.98138833086699, 640.6485371271307], "6": [265.91967827151694, 417.45914203083726], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [84.91116295387332, 347.07044836586874], "3": [162.16207723842965, 480.8729568378686], "4": [-127.5289878735695, 307.009526689124], "5": [121.88410843129985, 631.1923828517515], "6": [225.98697797555283, 480.8729568378686], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-58.082656246865916, 359.5807865002091], "3": [-98.07067198371699, 508.81809292400123], "4": [136.37019635232244, 295.48743947303444], "5": [-84.50731042212136, 663.8480249743017], "6": [196.78738639905876, 306.14062017686496], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-29.489337421039725, 367.24234318851484], "3": [-118.10794566143154, 493.80283190729085], "4": [160.80469494177115, 243.0874881487806], "5": [77.22449570395797, 473.9561763135125], "6": [221.92046521679862, 248.43442521050017], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [97.40608450701123, 339.11030543324205], "3": [110.87180613182362, 493.0242078992718], "4": [-117.71720679299051, 317.7172067929905], "5": [248.3222346052022, 339.11030543324205], "6": [127.390905994369, 554.6743278815953], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [109.1596869416489, 330.09144907916937], "3": [162.00242449293472, 475.2756772834939], "4": [-117.71720679299051, 317.7172067929905], "5": [239.8134850954791, 610.0483876379217], "6": [169.14708437821736, 330.09144907916937], "null": [0.0, 0.0]}], "cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "child_dicts": [{"1": [2, 3], "2": [4], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 3], "2": [4, 5], "3": [6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 5], "2": [3, 4], "3": [6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 3], "2": [4, 6], "3": [5], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 5], "2": [3, 4, 6], "3": [], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 6], "2": [3, 4], "3": [5], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 5, 6], "2": [3, 4], "3": [], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 3], "2": [4, 5], "3": [], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2], "2": [3, 4, 6], "3": [5], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 3], "2": [4], "3": [5], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2, 5], "2": [3, 4], "3": [], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2], "2": [3, 4], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 3], "2": [4, 5, 6], "3": [], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2], "2": [3, 4], "3": [5], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2, 4], "2": [3], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 4], "2": [3], "3": [5], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2, 4], "2": [3, 5], "3": [], "4": [6], "5": [], "6": [], "null": [1]}, {"1": [2, 4], "2": [3, 5], "3": [6], "4": [], "5": [], "6": [], "null": [1]}, {"1": [2, 4], "2": [3, 6], "3": [5], "4": [], "5": [], "6": [], "null": [1]}], "patient": "patient2", "tree_iterations": ["89", "69", "69", "65", "64", "63", "61", "55", "54", "53", "51", "50", "44", "41", "39", "38", "34", "34", "26"]};

      if (tree_switch_options) {
        $("#tree-switch").tree_switch(tree_switch_options)
      }
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.treatment_plot", {

        options: {
          width: 500,
          height: 50,
          margins: {right: 50, left: 50},
          treatments: [],
          samples: [],
          treatment_color_map: {}
        },

        _elements: {
          treatment_plot: undefined,
          tooltip: undefined
        },

        _create: function() {
          const width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            treatments = this.options.treatments,
            samples = this.options.samples,
            treatment_color_map = this.options.treatment_color_map;

          let t = d3.scaleLinear()
            .domain([Math.min(...samples), Math.max(...samples)])
            .range([margins.left, width - margins.right]);

          let xAxis = g => g
            .attr("transform", "translate(0 " + height.toString() + ")")
            .call(d3.axisBottom(t));

          let treatment_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + (height * 2))
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("onclick", "$(\"#treatment-plot\").treatment_plot(\"toggle_tx\", event)")
            .style("max-height", "100px");
          treatment_plot.append("g")
            .call(xAxis);

          for (let tx in treatments) {
            let tx_start = Math.max(treatments[tx].tx_start, samples[0]),
              tx_end = Math.min(treatments[tx].tx_end, samples[samples.length - 1]);
            if (tx_end > samples[0] && tx_start < samples[samples.length - 1]) {
              let color = treatment_color_map[treatments[tx].tx];
              treatment_plot.append("line")
                .attr("stroke", color)
                .attr("stroke-width", 10)
                .attr("x1", t(tx_start))
                .attr("x2", t(tx_end))
                .attr("y1", 25)
                .attr("y2", 25)
                .attr("opacity", 1.0)
                .attr("tx", treatments[tx].tx)
                .attr("style", "cursor: pointer;")
            }
          }

          for (let s in samples) {
            treatment_plot.append("line")
              .attr("stroke", "black")
              .attr("stroke-width", 1)
              .attr("x1", t(samples[s]))
              .attr("x2", t(samples[s]))
              .attr("y1", 10)
              .attr("y2", 40)
              .attr("opacity", 1.0);
          }

          this._elements.tooltip = treatment_plot.append("g")
            .attr("style", "display: none;")
            .node();
          this._elements.treatment_plot = treatment_plot.node();

          this._refresh()
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.treatment_plot.outerHTML
        },

        toggle_tx: function(eve) {
          if (typeof eve.target.getAttribute("tx") === "string") {
            let tx_line = eve.target,
              tooltip = d3.select(this._elements.tooltip);
            let {x, width} = tx_line.getBBox(),
              tx_mid = x + (width / 2);
            tooltip.attr("style", "display: block;")
              .attr("transform", "translate(" + tx_mid.toString() + ",60)");

            let border = tooltip.selectAll("path")
              .data([null])
              .join("path")
                .attr("fill", "white")
                .attr("stroke", "black");

            tooltip.selectAll("text")
              .data([null])
              .join("text")
              .attr("id", "treatment-text")
              .attr("text-anchor", "middle")
              .call(t => t
                .selectAll("tspan")
                .data([tx_line.getAttribute("tx")])
                .join("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(d => d));

            this._refresh();

            let {width: w, height: h} = $("#treatment-text")[0].getBBox();

            border.attr("d", "M" + (-w / 2 - 10).toString() + " " + (-h / 2 - 15).toString() + " H " +
              (w / 2 + 10).toString() + " V " + (h / 2 + 5).toString() + " H " + (-w / 2 - 10).toString() + " Z");
          } else {
            this._elements.tooltip.setAttribute("style", "display: none;");
          }

          this._refresh();
        }

      });

      let treatment_data = false;

      if (treatment_data) {
        $("#treatment-plot").treatment_plot(treatment_data);
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_visual", {
        options: {
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}, drivers: []}},
          aliases: []
        },

        _elements: {
          mutation_visual: undefined
        },

        _create: function() {
          const cluster_dict = this.options.cluster_dict,
            aliases = this.options.aliases;
          let svg_visual = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "auto"),
            c_groups = [[], [], [], []],
            group_names = ["UNIVERSAL MUTATIONS", "OTHER COMMON MUTATIONS", "OTHER CLONAL", "SUBCLONAL"],
            group_min_lens = [200, 200, 150, 150];
          for (let c in cluster_dict) {
            let clonality = [];
            for (let s in cluster_dict[c].ccf_hat) {
              let cl = cluster_dict[c].ccf_hat[s];
              if (cl > 0.9) {
                clonality.push(1);
              } else if (cl > 0.1) {
                clonality.push(0.5);
              } else {
                clonality.push(0);
              }
            }
            if (clonality.every(v => v === 1)) {
              c_groups[0].push(c);
            } else if (clonality.reduce((p, a) => p + a) > 1) {
              c_groups[1].push(c);
            } else if (clonality.some(v => v === 1)) {
              c_groups[2].push(c);
            } else {
              c_groups[3].push(c);
            }
          }

          for (let a in aliases) {
            svg_visual.append("g")
              .attr("transform", "translate(15," + (a * 12 + 133).toString() + ")")
              .append("svg")
                .attr("width", "100px")
                .attr("height", "20px")
                .attr("x", 10)
                .attr("y", 10)
                .attr("stroke-width", 1)
                .attr("stroke", "black")
                .append("text")
                  .html(aliases[a])
                  .attr("font-size", "9px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("text-anchor", "start")
                  .attr("textLength", 50)
                  .attr("class", "samples");
          }

          let x_offset = 20,
            y_offset = 30,
            header_x_offset = 70;

          for (let g in c_groups) {
            if (c_groups[g].length) {
              let g_len = 0;
              for (let i in c_groups[g]) {
                let c = c_groups[g][i],
                  box_stroke = cluster_dict[c].color,
                  drivers = cluster_dict[c].drivers,
                  muts = cluster_dict[c].muts,
                  sorted_muts = Object.keys(muts).sort(function(a, b) {
                    if (drivers.includes(a) && drivers.includes(b)) {
                      return 0
                    }
                    if (drivers.includes(a)) {
                      return -1
                    }
                    if (drivers.includes(b)) {
                      return 1
                    }
                    return 0
                  }),
                  cnvs = cluster_dict[c].cnvs,
                  sorted_vars = [...sorted_muts, ...Object.keys(cnvs)];
                g_len += sorted_vars.length * 12;
                for (let ii in sorted_vars) {
                  let mut = sorted_vars[ii],
                    mut_group = svg_visual.append("g")
                    .attr("class", "mut_group"),
                    mut_suffix = mut.includes("_") ? mut.split("_")[1] : "p.A0A",
                    text_color = mut.startsWith("loss") || mut.startsWith("gain") ?
                      "black" : ((mut_suffix.length > 3 && mut_suffix[2] === mut_suffix[mut_suffix.length - 1]) ? "gray" : "black"),
                    text_weight = drivers.includes(mut) ? "bold" : "normal";
                  mut_group.append("g")
                    .attr("transform", "rotate(-75," + (x_offset + 53).toString() + ",145) " +
                      "translate(" + (x_offset + 53).toString() + ",145)")
                    .append("svg")
                      .attr("width", "100px")
                      .attr("height", "20px")
                      .attr("x", 10)
                      .attr("y", 10)
                      .append("text")
                        .html(mut)
                        .attr("font-size", "9px")
                        .attr("font-family", "Arial")
                        .attr("fill", text_color)
                        .attr("x", 10)
                        .attr("y", 10)
                        .attr("text-anchor", "start")
                        .attr("textLength", 70)
                        .attr("font-weight", text_weight)
                        .attr("class", "cluster_" + c.toString());
                  for (let a in aliases) {
                    let ccf_hat = cluster_dict[c].ccf_hat[a],
                      ccf_1d = mut in muts ? muts[mut].ccf_hat[a] : cnvs[mut].ccf_hat[a],
                      box_color = ccf_1d < 0.1 ? "white" : cluster_dict[c].color,
                      box_size = ccf_hat * 9 + 1,
                      a_box_stroke = ccf_hat > 0.9 ? "red" : box_stroke;
                    mut_group.append("rect")
                      .attr("x", x_offset + 75 - (box_size / 2.0))
                      .attr("y", y_offset + 120 + (a * 12) - (box_size / 2.0))
                      .attr("width", box_size.toString() + "px")
                      .attr("height", box_size.toString() + "px")
                      .attr("stroke-width", 1)
                      .attr("stroke", a_box_stroke)
                      .attr("fill", box_color)
                      .attr("opacity", 0.8)
                      .attr("class", "cluster_" + c.toString());
                  }
                  x_offset += 12;
                }
              }
              svg_visual.append("g")
                .attr("transform", "translate(" + (20 + header_x_offset).toString() + ",30)")
                .append("svg")
                  .attr("width", g_len)
                  .attr("height", "20px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("stroke-width", 1)
                  .attr("stroke", "black")
                  .append("text")
                    .html(group_names[g])
                    .attr("font-size", g_len > group_min_lens[g] ? "12px" : "8px")
                    .attr("x", 10)
                    .attr("y", 10)
                    .attr("text-anchor", "start");
              header_x_offset += g_len + 8;
              x_offset += 10;
            }
          }
          svg_visual
            .attr("width", x_offset + 110)
            .attr("height", y_offset + 160 + (aliases.length * 12));
          this._elements.mutation_visual = svg_visual.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_visual.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_visual.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".clonality_chart.svg");
          dl.click();
        }
      });

      $("#mutation-visual").mutation_visual({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "aliases": ["T0", "T1", "T2"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_table", {

        options: {
          aliases: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}}},
        },

        _elements: {
          cluster_table: undefined,
          column_data: undefined,
          table_data: undefined,
          cluster_datatable: undefined
        },

        _create: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            table_el = d3.select(document.createElement("table"))
              .attr("id", "cluster_table")
              .attr("class", "hover"),
            col_width = Math.round(82 / (aliases.length + 1.3)),
            cluster_col_width = 82 - (aliases.length * col_width),
            columns = [{"data": "Cluster", "width": cluster_col_width + "%"},
              {"data": "Chromosome", "width": "9%"},
              {"data": "Position", "width": "9%"}
            ],
            col_list = ["Cluster", "Chromosome", "Position"];
          for (let i in aliases) {
            columns.push({"data": aliases[i] + " CCF", "width": col_width + "%"});
            col_list.push(aliases[i] + " CCF");
          }
          table_el.append("thead")
            .selectAll("th")
            .data(col_list)
            .join("th")
            .text(d => d);
          let cluster_data = [];
          for (let c in cluster_dict) {
            let cluster_dat = {"Cluster": c, "Chromosome": null, "Position": null};
            for (let i in aliases) {
              cluster_dat[aliases[i] + " CCF"] = cluster_dict[c].ccf_hat[i] + " (" + cluster_dict[c].ccf_low[i] + "-" + cluster_dict[c].ccf_high[i] + ")";
            }
            cluster_data.push(cluster_dat);
          }
          this._elements.cluster_table = table_el.node();
          this._elements.column_data = columns;
          this._elements.table_data = {"columns": columns,
            "data": cluster_data,
            "order": [[0, "asc"]],
            "paging": false,
            "bInfo": false,
            "createdRow": function(row, data, dataIndex) {
              $(row).css("color", cluster_dict[dataIndex + 1].color)
                .css("cursor", "pointer")
                .attr("id", "mutation_row_cluster " + (dataIndex + 1).toString())
            }};

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.cluster_table.outerHTML;
          this._elements.cluster_datatable = $("#cluster_table").DataTable(this._elements.table_data);
          $("#cluster_table tbody").on("click", "tr", this.toggle_mutations(this));
          let search_input = $(".dataTables_filter input");
          search_input.unbind().bind("keyup", function(e) {
            if (search_input.val().length === 0) {
              for (let c in this.options.cluster_dict) {
                this.hide_mutations(c);
              }
            } else if (e.keyCode === 13) {
              for (let c in this.options.cluster_dict) {
                let cluster_table = this.show_mutations(c);
                cluster_table.search(search_input.val()).draw();
                if (cluster_table.page.info().recordsDisplay === 0) {
                  this.hide_mutations(c);
                }
              }
            }
          }
          .bind(this));
        },

        toggle_mutations: function(widg) {
          return function() {
            let row = widg._elements.cluster_datatable.row($(this));
            if (row.data()) {
              if (row.child.isShown()) {
                row.child.hide();
              } else {
                let c = row.data().Cluster,
                  cluster_muts = widg.options.cluster_dict[c].muts,
                  cluster_cnvs = widg.options.cluster_dict[c].cnvs,
                  drivers = widg.options.cluster_dict[c].drivers,
                  color = widg.options.cluster_dict[c].color,
                  aliases = widg.options.aliases,
                  mut_data = [];
                for (let mut in cluster_muts) {
                  let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                    "Cluster": mut,
                    "Chromosome": cluster_muts[mut].chrom,
                    "Position": cluster_muts[mut].pos
                  };
                  for (let i in aliases) {
                    mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                      (" (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
                  }
                  mut_data.push(mut_dat);
                }
                for (let cnv in cluster_cnvs) {
                  let cnv_dat = {"is_driver": 1,
                    "Cluster": cnv,
                    "Chromosome": cluster_cnvs[cnv].chrom,
                    "Position": null
                  };
                  for (let i in aliases) {
                    cnv_dat[aliases[i] + " CCF"] = cluster_cnvs[cnv].ccf_hat[i];
                  }
                  mut_data.push(cnv_dat);
                }
                row.child("<table id=\"cluster_" + row.data().Cluster + "_table\" class=\"hover\"></table>").show();
                $("#cluster_" + row.data().Cluster + "_table").DataTable({
                  "columns": [{"data": "is_driver", "visible": false}].concat(widg._elements.column_data),
                  "data": mut_data,
                  "autoWidth": false,
                  "order": [[0, "asc"]],
                  "paging": false,
                  "scrollY": 320,
                  "scrollCollapse": true,
                  "createdRow": function(row, data) {
                    $(row).css("color", color);
                    if (data.is_driver === 0) {
                      $(row).css("font-weight", "bold");
                    }
                  }
                });
              }
            }
          }
        },

        show_mutations: function(cluster) {
          let row = this._elements.cluster_datatable.row(cluster - 1),
            cluster_table;
          if (~row.child.isShown()) {
            let cluster_muts = this.options.cluster_dict[cluster].muts,
              drivers = this.options.cluster_dict[cluster].drivers,
              color = this.options.cluster_dict[cluster].color,
              aliases = this.options.aliases,
              mut_data = [];
            for (let mut in cluster_muts) {
              let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                  "Cluster": mut,
                  "Chromosome": cluster_muts[mut].chrom,
                  "Position": cluster_muts[mut].pos
                },
                is_cnv = mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD";
              for (let i in aliases) {
                mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                  (is_cnv ? "" : " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
              }
              mut_data.push(mut_dat);
            }
            row.child("<table id=\"cluster_" + cluster.toString() + "_table\" class=\"hover\"></table>").show();
            cluster_table = $("#cluster_" + cluster.toString() + "_table").DataTable({
              "columns": [{"data": "is_driver", "visible": false}].concat(this._elements.column_data),
              "data": mut_data,
              "autoWidth": false,
              "order": [[0, "asc"]],
              "paging": false,
              "scrollY": 320,
              "scrollCollapse": true,
              "createdRow": function(row, data) {
                $(row).css("color", color);
                if (data.is_driver === 0) {
                  $(row).css("font-weight", "bold");
                }
              }
            });
          } else {
            cluster_table = row.child.DataTable();
          }
          return cluster_table;
        },

        hide_mutations: function(cluster) {
          this._elements.cluster_datatable.row(cluster - 1).child.hide();
        },

        download_as_tsv: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            columns = ["Cluster", "Mutation", "Driver", "Chromosome", "Position", ...aliases.map(d => d + " CCF")],
            dl_link = "data:text/plain;charset=utf-8,";
          
          let is_driver = function(mut, drivers) {
            if (mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD") {
              return null
            }
            return drivers.includes(mut)
          };

          dl_link += columns.join("\t") + "\n";
          for (let c in cluster_dict) {
            let cluster_row = [c, null, null, null, null, ...aliases.map(
              (_, i) => cluster_dict[c].ccf_hat[i]
                + " (" + cluster_dict[c].ccf_low[i]
                + "-" + cluster_dict[c].ccf_high[i] + ")")];
            dl_link += cluster_row.join("\t") + "\n";
            let cluster_muts = cluster_dict[c].muts,
              drivers = cluster_dict[c].drivers,
              mut_rows = Object.keys(cluster_muts).map(
                d => [c, d, is_driver(d, drivers), cluster_muts[d].chrom, cluster_muts[d].pos,
                  ...aliases.map((_, i) => cluster_muts[d].ccf_hat[i] + " ("
                    + cluster_muts[d].alt_cnt[i] + ":"
                    + cluster_muts[d].ref_cnt[i] + ")"
                  )
                ].join("\t")
              );
            dl_link += mut_rows.join("\n") + "\n"
          }

          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".cluster_table.tsv");
          dl.click();

        }

      });

      $("#cluster-table").cluster_table({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "aliases": ["T0", "T1", "T2"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_plot", {
        options: {
          xlabels: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          mutation_plot: undefined
        },

        _create: function() {
          const xlabels = this.options.xlabels,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          if (xlabels.length > 1) {
            let x = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x).tickValues([...Array(xlabels.length).keys()]).tickFormat(d => xlabels[d]));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let line = d3.line()
              .x(d => x(d.x))
              .y(d => y(d.y));

            let mutation_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            mutation_plot.append("g")
              .call(xAxis);
            mutation_plot.append("g")
              .call(yAxis);
            mutation_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            mutation_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            mutation_plot.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            for (let cluster in cluster_dict) {
              let muts = cluster_dict[cluster].muts,
                color = cluster_dict[cluster].color;
              for (let mut in muts) {
                let ccf_hat = muts[mut].ccf_hat,
                  mutation_data = [];
                for (let sample in ccf_hat) {
                  mutation_data.push({
                    x: sample,
                    y: ccf_hat[sample]
                  });
                }
                mutation_plot.append("path")
                  .datum(mutation_data)
                  .attr("fill", "none")
                  .attr("stroke", color)
                  .attr("stroke-width", 3)
                  .attr("opacity", 0.3)
                  .attr("d", line);
              }
            }

            this._elements.mutation_plot = mutation_plot.node();
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              for (let mut in cluster_dict[c].muts) {
                max_bin = Math.max(max_bin, ...cluster_dict[c].muts[mut].ccf_dist);
                n_bins = cluster_dict[c].muts[mut].ccf_dist.length
              }
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            for (let c in cluster_dict) {
              plot_1d.append("g")
                .selectAll("polygon")
                .data(Object.keys(cluster_dict[c].muts))
                .join("polygon")
                .attr("fill", cluster_dict[c].color)
                .attr("opacity", 0.05)
                .attr("stroke", "none")
                .attr("points", d =>
                  cluster_dict[c].muts[d].ccf_dist.reduce(
                    (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                  ) + zero_str
                );
            }

            plot_1d.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            this._elements.mutation_plot = plot_1d.node()
          }

          this._refresh();

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".mutation_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }
      });

      $("#mutation-plot").mutation_plot({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.fish_plot", {
        options: {
          xlabels: [],
          time_points: [],
          tumor_sizes: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          child_dict: {},
          timed: true,
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          fish_plot: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tumor_sizes = Object.assign(...this.options.tumor_sizes.map(t => ({[t[0]]: t[1]}))),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            timed = this.options.timed,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          let x = d3.scaleLinear()
            .domain([Math.min(...time_points), Math.max(...time_points)])
            .range([margins.left, width - margins.right]);

          let y = d3.scaleLinear()
            .domain([0, Math.max(...Object.values(tumor_sizes))]).nice()
            .range([height - margins.bottom, margins.top]);

          let xAxis = timed ?
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)) :
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)).tickValues(time_points).tickFormat(d => xlabels[d]);

          let yAxis = g => g
            .attr("transform", "translate(" + margins.left.toString() + " 0)")
            .call(d3.axisLeft(y));

          let interp1d = function(u, population) {
            let p0, p1, t0, t1;
            if (u < time_points[0]) {
              p0 = population[0];
              p1 = population[1];
              t0 = time_points[0];
              t1 = time_points[1];
            } else {
              let n;
              for (n in time_points) {
                n = parseInt(n);
                if (time_points[n] > u) {
                  break;
                }
              }
              p0 = population[n - 1];
              p1 = population[n];
              t0 = time_points[n - 1];
              t1 = time_points[n];
            }
            let m = (p1 - p0) / (t1 - t0),
              dx = u - t0;
            return p0 + (m * dx)
          };

          let h = [],
            tumor_size_t = Object.keys(tumor_sizes).sort((a, b) => a - b);
          for (let i in tumor_size_t) {
            h.push(tumor_size_t[i] - tumor_size_t[i - 1]);
          }

          let pchip = function(u, population) {
            if (u < tumor_size_t[0] || u > tumor_size_t[tumor_size_t.length - 1]) {
              console.log(u, tumor_size_t[tumor_size_t.length - 1]);
              throw "Input outside interpolation range";
            }
            let n;
            for (n in tumor_size_t) {
              n = parseInt(n);
              if (tumor_size_t[n] > u) {
                break;
              }
            }
            let p0 = population[n - 1],
              p1 = population[n],
              d0 = (p0 - population[n - 2]) / h[n - 1],
              d1 = (p1 - p0) / h[n],
              d2 = (population[n + 1] - p1) / h[n + 1],
              fp0 = n === 1 ? d1 : (h[n - 1] * d0 + h[n] * d1) / (h[n - 1] + h[n]),
              fp1 = n === (tumor_size_t.length - 1) ? d1 : (h[n] * d1 + h[n + 1] * d2) / (h[n] + h[n + 1]);
            let v = (u - tumor_size_t[n - 1]) / (tumor_size_t[n] - tumor_size_t[n - 1]);
            return Math.max(0, (p0 * ((2 * v * v * v) - (3 * v * v) + 1)) +
              (p1 * ((-2 * v * v * v) + (3 * v * v))) +
              (fp0 * ((v * v * v) - (2 * v * v) + v)) +
              (fp1 * ((v * v * v) - (v * v))))
          };

          let getOrder = function(cluster, level) {
            cluster = cluster || child_dict[null][0];
            level = level || 1;
            let order = [cluster],
              breaks = {},
              children = child_dict[cluster];
            for (let i in children) {
              let {order: child_order, breaks: child_breaks, level: child_level} = getOrder(children[i], level + 1);
              order = [...order, ...child_order];
              breaks[children[i]] = children.length > 1 ? child_level : false;
              breaks = Object.assign({}, breaks, child_breaks);
            }
            return {order: order, breaks: breaks, level: level}
          };

          let {order, breaks} = getOrder(),
            max_break = Math.max(...Object.values(breaks));

          let fish_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + height)
            .style("max-width", "500px")
            .style("min-width", "300px")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          fish_plot.append("g")
            .call(xAxis);
          fish_plot.append("g")
            .call(yAxis);
          fish_plot.append("text")
            .attr("x", (width + margins.left - margins.right) / 2)
            .attr("y", height - 5)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Time");
          fish_plot.append("text")
            .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
            .attr("x", 10)
            .attr("y", (height + margins.top - margins.bottom) / 2)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Relative size");
          fish_plot.append("text")
            .attr("x", width / 2)
            .attr("y", margins.top / 2)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("text-decoration", "underline")
            .text("Tumor abundance plot");

          fish_plot.selectAll("circle")
            .data(Object.keys(tumor_sizes).filter(d => d >= Math.min(...time_points) & d <= Math.max(...time_points)))
            .join("circle")
            .attr("cx", d => x(d))
            .attr("cy", d => y(tumor_sizes[d]))
            .attr("r", 3)
            .attr("fill", "black")
            .attr("opacity", 0.5);

          let t0 = time_points[0],
            linspace = [t0],
            step = (time_points[time_points.length - 1] - t0) / 100;
          for (let i = 1; i < 101; i++) {
            linspace.push(i * step + t0);
          }

          let abundance_stack = Array(101).fill(0);

          for (let o in order) {
            let cluster = order[order.length - o - 1],
              unique_population = child_dict[cluster].reduce(
                (a, c) => a.map((d, i) => d - cluster_dict[c].tumor_abundance[i]), cluster_dict[cluster].tumor_abundance
              ),
              base = [],
              head = [],
              interp_pop = tumor_size_t.map(u => interp1d(u, unique_population) * tumor_sizes[u]);
            for (let i in linspace) {
              base.push(x(linspace[i]) + "," + y(abundance_stack[i]));
              abundance_stack[i] += pchip(linspace[i], interp_pop);
              head.push(x(linspace[i]) + "," + y(abundance_stack[i]));
            }
            fish_plot.append("path")
              .datum(linspace)
              .attr("stroke", cluster_dict[cluster].color)
              .attr("stroke-width", breaks[cluster] ? (max_break - breaks[cluster]) * 2 + 1 : 0)
              .attr("stroke-dasharray", 4)
              .attr("fill", "none")
              .attr("opacity", 1.0)
              .attr("d", d3.line()
                .x(d => x(d))
                .y((d, i) => y(abundance_stack[i])));

            fish_plot.append("polygon")
              .attr("points", head.join(" ") + " " + base.reverse().join(" "))
              .attr("fill", cluster_dict[cluster].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");
          }
          fish_plot.append("g")
            .selectAll("line")
            .data(time_points)
            .join("line")
            .attr("x1", d => x(d))
            .attr("y1", y.range()[0])
            .attr("x2", d => x(d))
            .attr("y2", y.range()["length"] + margins.top)
            .attr("stroke", "black")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "1 4");

          this._elements.fish_plot = fish_plot.node();

          this._refresh();

          d3.select(this.element.context.parentElement).append("button")
            .attr("onclick", "$(\"#fish-plot\").fish_plot(\"download\")")
            .attr("style", "font-size: 12px;")
            .html("Download as SVG")

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.fish_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.fish_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient2" + ".tumor_abundance_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
          let parent = this.element.context.parentElement;
          parent.removeChild(parent.getElementsByTagName("button")[0])
        }
      });

      let fish_options = {"tumor_sizes": [[100.0, 1.0], [150.0, 1.0], [180.0, 1.0]], "xlabels": ["T0", "T1", "T2"], "child_dict": {"1": [2, 3], "2": [4], "3": [5, 6], "4": [], "5": [], "6": [], "null": [1]}, "time_points": [100.0, 150.0, 180.0], "cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": ["ARID1A:27057838:C:G"], "ccf_low": [1.0, 1.0, 1.0], "muts": {"ZNF66:20989850:A:T": {"ref_cnt": ["50", "23", "97"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["40", "46", "12"], "chrom": "19", "pos": "20989850"}, "ABCA7:1055257:C:A": {"ref_cnt": ["65", "22", "89"], "ccf_hat": [0.94, 0.96, 0.96], "alt_cnt": ["24", "47", "19"], "chrom": "19", "pos": "1055257"}, "CTD-2583A14.9:58420105:T:C": {"ref_cnt": ["61", "14", "93"], "ccf_hat": [0.97, 0.99, 0.94], "alt_cnt": ["29", "55", "15"], "chrom": "19", "pos": "58420105"}, "ABL2:179077988:C:A": {"ref_cnt": ["89", "61", "111"], "ccf_hat": [0.97, 0.99, 0.7], "alt_cnt": ["31", "59", "9"], "chrom": "1", "pos": "179077988"}, "MLLT4:168227824:C:A": {"ref_cnt": ["56", "27", "99"], "ccf_hat": [0.98, 0.91, 0.79], "alt_cnt": ["34", "42", "10"], "chrom": "6", "pos": "168227824"}, "VPS11:118944611:C:T": {"ref_cnt": ["89", "77", "107"], "ccf_hat": [0.96, 0.91, 0.89], "alt_cnt": ["30", "44", "14"], "chrom": "11", "pos": "118944611"}, "ZNF714:21300107:T:A": {"ref_cnt": ["56", "19", "99"], "ccf_hat": [0.98, 0.98, 0.74], "alt_cnt": ["34", "50", "9"], "chrom": "19", "pos": "21300107"}, "MKL1:40816980:C:T": {"ref_cnt": ["77", "42", "103"], "ccf_hat": [0.96, 0.88, 0.71], "alt_cnt": ["28", "43", "9"], "chrom": "22", "pos": "40816980"}, "FAM189A2:71998617:G:T": {"ref_cnt": ["92", "66", "111"], "ccf_hat": [0.98, 0.99, 0.85], "alt_cnt": ["43", "76", "13"], "chrom": "9", "pos": "71998617"}, "PLXNA2:208224371:C:G": {"ref_cnt": ["82", "64", "106"], "ccf_hat": [0.98, 0.98, 0.87], "alt_cnt": ["38", "54", "13"], "chrom": "1", "pos": "208224371"}, "C1R:7188136:G:T": {"ref_cnt": ["96", "67", "106"], "ccf_hat": [0.87, 0.98, 0.9], "alt_cnt": ["24", "53", "14"], "chrom": "12", "pos": "7188136"}, "ZNF527:37880598:T:G": {"ref_cnt": ["77", "27", "102"], "ccf_hat": [0.54, 0.91, 0.57], "alt_cnt": ["13", "42", "6"], "chrom": "19", "pos": "37880598"}, "ZNF423:49672056:T:C": {"ref_cnt": ["85", "67", "113"], "ccf_hat": [0.98, 0.98, 0.62], "alt_cnt": ["35", "53", "7"], "chrom": "16", "pos": "49672056"}, "ZNF90:20228989:C:T": {"ref_cnt": ["66", "16", "95"], "ccf_hat": [0.93, 0.98, 0.91], "alt_cnt": ["24", "53", "13"], "chrom": "19", "pos": "20228989"}, "PTPN23:47446203:A:C": {"ref_cnt": ["60", "20", "92"], "ccf_hat": [0.97, 0.97, 0.95], "alt_cnt": ["29", "49", "17"], "chrom": "3", "pos": "47446203"}, "HCN3:155258135:A:T": {"ref_cnt": ["97", "64", "107"], "ccf_hat": [0.85, 0.98, 0.86], "alt_cnt": ["23", "56", "13"], "chrom": "1", "pos": "155258135"}, "NHS:17746888:A:C": {"ref_cnt": ["97", "73", "111"], "ccf_hat": [0.87, 0.95, 0.7], "alt_cnt": ["24", "47", "9"], "chrom": "23", "pos": "17746888"}, "GIMAP6:150325294:T:A": {"ref_cnt": ["95", "62", "109"], "ccf_hat": [0.99, 1.0, 0.96], "alt_cnt": ["55", "110", "22"], "chrom": "7", "pos": "150325294"}, "ARHGAP4:153196292:T:G": {"ref_cnt": ["100", "72", "112"], "ccf_hat": [0.74, 0.96, 0.66], "alt_cnt": ["20", "48", "8"], "chrom": "23", "pos": "153196292"}, "INADL:62261177:G:T": {"ref_cnt": ["90", "73", "105"], "ccf_hat": [0.96, 0.95, 0.83], "alt_cnt": ["31", "47", "12"], "chrom": "1", "pos": "62261177"}, "TTF1:135267525:A:C": {"ref_cnt": ["103", "96", "113"], "ccf_hat": [0.95, 0.84, 0.71], "alt_cnt": ["32", "42", "9"], "chrom": "9", "pos": "135267525"}, "TMEM87A:42536251:T:C": {"ref_cnt": ["87", "74", "112"], "ccf_hat": [0.97, 0.95, 0.73], "alt_cnt": ["33", "47", "10"], "chrom": "15", "pos": "42536251"}, "NOM1:156762272:T:C": {"ref_cnt": ["91", "79", "102"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "92", "30"], "chrom": "7", "pos": "156762272"}, "ZNF737:20728472:G:T": {"ref_cnt": ["74", "29", "100"], "ccf_hat": [0.69, 0.87, 0.68], "alt_cnt": ["16", "40", "8"], "chrom": "19", "pos": "20728472"}, "CPNE7:89649878:C:G": {"ref_cnt": ["84", "69", "108"], "ccf_hat": [0.98, 0.97, 0.78], "alt_cnt": ["36", "49", "11"], "chrom": "16", "pos": "89649878"}, "P4HA1:74813259:G:T": {"ref_cnt": ["127", "123", "120"], "ccf_hat": [0.78, 0.91, 0.83], "alt_cnt": ["23", "49", "13"], "chrom": "10", "pos": "74813259"}, "MSL3:11780989:A:C": {"ref_cnt": ["94", "67", "106"], "ccf_hat": [0.92, 0.98, 0.92], "alt_cnt": ["27", "52", "15"], "chrom": "23", "pos": "11780989"}, "WRNIP1:2766460:G:C": {"ref_cnt": ["64", "25", "96"], "ccf_hat": [0.95, 0.94, 0.88], "alt_cnt": ["26", "44", "12"], "chrom": "6", "pos": "2766460"}, "TNMD:99840058:C:G": {"ref_cnt": ["87", "77", "107"], "ccf_hat": [0.97, 0.89, 0.86], "alt_cnt": ["32", "42", "13"], "chrom": "23", "pos": "99840058"}, "NOS2:26099386:T:G": {"ref_cnt": ["91", "70", "109"], "ccf_hat": [0.96, 0.97, 0.86], "alt_cnt": ["31", "49", "13"], "chrom": "17", "pos": "26099386"}, "ARID1A:27057838:C:G": {"ref_cnt": ["103", "81", "106"], "ccf_hat": [0.6, 0.83, 0.9], "alt_cnt": ["17", "39", "14"], "chrom": "1", "pos": "27057838"}, "ORC6:46731489:G:A": {"ref_cnt": ["86", "67", "105"], "ccf_hat": [0.98, 0.98, 0.92], "alt_cnt": ["34", "54", "15"], "chrom": "16", "pos": "46731489"}, "POLR1D:28240056:A:C": {"ref_cnt": ["57", "23", "96"], "ccf_hat": [0.98, 0.96, 0.88], "alt_cnt": ["33", "46", "12"], "chrom": "13", "pos": "28240056"}, "TJP2:71835810:A:T": {"ref_cnt": ["85", "74", "107"], "ccf_hat": [0.99, 0.99, 0.94], "alt_cnt": ["50", "63", "17"], "chrom": "9", "pos": "71835810"}, "PVRL4:161047300:C:T": {"ref_cnt": ["95", "75", "106"], "ccf_hat": [0.91, 0.93, 0.9], "alt_cnt": ["26", "45", "14"], "chrom": "1", "pos": "161047300"}, "SCNN1A:6463716:A:G": {"ref_cnt": ["88", "75", "109"], "ccf_hat": [0.97, 0.94, 0.7], "alt_cnt": ["32", "46", "9"], "chrom": "12", "pos": "6463716"}, "ADRA2A:112839113:G:A": {"ref_cnt": ["90", "73", "108"], "ccf_hat": [0.99, 0.99, 0.97], "alt_cnt": ["60", "98", "24"], "chrom": "10", "pos": "112839113"}, "CMTR2:71319043:T:G": {"ref_cnt": ["97", "67", "109"], "ccf_hat": [0.85, 0.98, 0.78], "alt_cnt": ["23", "53", "11"], "chrom": "16", "pos": "71319043"}, "TPD52:80992572:T:A": {"ref_cnt": ["68", "26", "93"], "ccf_hat": [0.9, 0.92, 0.94], "alt_cnt": ["22", "42", "15"], "chrom": "8", "pos": "80992572"}, "C12orf40:40114915:A:T": {"ref_cnt": ["81", "59", "106"], "ccf_hat": [0.98, 0.99, 0.92], "alt_cnt": ["39", "61", "15"], "chrom": "12", "pos": "40114915"}, "IDS:148568525:G:T": {"ref_cnt": ["82", "70", "112"], "ccf_hat": [0.98, 0.97, 0.7], "alt_cnt": ["37", "50", "9"], "chrom": "23", "pos": "148568525"}, "IRX4:1878501:G:T": {"ref_cnt": ["89", "76", "109"], "ccf_hat": [0.97, 0.93, 0.78], "alt_cnt": ["31", "45", "11"], "chrom": "5", "pos": "1878501"}, "KIAA1755:36848130:C:A": {"ref_cnt": ["99", "69", "111"], "ccf_hat": [0.78, 0.97, 0.66], "alt_cnt": ["21", "51", "8"], "chrom": "20", "pos": "36848130"}, "PDE6A:149324156:G:A": {"ref_cnt": ["88", "54", "104"], "ccf_hat": [0.97, 0.98, 0.75], "alt_cnt": ["32", "54", "10"], "chrom": "5", "pos": "149324156"}}, "line_width": 12, "cnvs": {}}, "2": {"ccf_hat": [0.49, 0.69, 0.72], "tumor_abundance": [0.49, 0.69, 0.74], "ccf_high": [0.49, 0.69, 0.79], "color": "rgb(103,200,243)", "drivers": ["NF1:29663680:G:A", "CHD8:21899708:G:A", "NF1:29553490:G:T"], "ccf_low": [0.48, 0.68, 0.66], "muts": {"TRIM47:73874005:G:A": {"ref_cnt": ["107", "86", "116"], "ccf_hat": [0.46, 0.75, 0.4], "alt_cnt": ["12", "34", "4"], "chrom": "17", "pos": "73874005"}, "PCDHA1:140214066:A:T": {"ref_cnt": ["105", "80", "107"], "ccf_hat": [0.53, 0.66, 0.57], "alt_cnt": ["15", "29", "6"], "chrom": "5", "pos": "140214066"}, "WDR96:105951959:G:A": {"ref_cnt": ["142", "146", "128"], "ccf_hat": [0.35, 0.53, 0.5], "alt_cnt": ["9", "25", "5"], "chrom": "10", "pos": "105951959"}, "CXADR:18919504:A:C": {"ref_cnt": ["76", "48", "100"], "ccf_hat": [0.58, 0.54, 0.68], "alt_cnt": ["14", "21", "8"], "chrom": "21", "pos": "18919504"}, "ERCC3:128038035:G:T": {"ref_cnt": ["77", "43", "95"], "ccf_hat": [0.54, 0.62, 0.92], "alt_cnt": ["13", "26", "14"], "chrom": "2", "pos": "128038035"}, "CHRNA4:61990917:C:T": {"ref_cnt": ["98", "89", "111"], "ccf_hat": [0.82, 0.71, 0.66], "alt_cnt": ["22", "32", "8"], "chrom": "20", "pos": "61990917"}, "NF1:29663680:G:A": {"ref_cnt": ["110", "102", "110"], "ccf_hat": [0.38, 0.41, 0.74], "alt_cnt": ["9", "18", "10"], "chrom": "17", "pos": "29663680"}, "ITPRIP:106075464:G:T": {"ref_cnt": ["140", "126", "127"], "ccf_hat": [0.39, 0.9, 0.51], "alt_cnt": ["10", "45", "5"], "chrom": "10", "pos": "106075464"}, "NF1:29553490:G:T": {"ref_cnt": ["107", "92", "114"], "ccf_hat": [0.48, 0.65, 0.57], "alt_cnt": ["13", "29", "6"], "chrom": "17", "pos": "29553490"}, "SNX27:151641075:T:A": {"ref_cnt": ["109", "95", "113"], "ccf_hat": [0.43, 0.55, 0.62], "alt_cnt": ["11", "24", "7"], "chrom": "1", "pos": "151641075"}, "PAFAH1B2:117042354:C:G": {"ref_cnt": ["102", "89", "108"], "ccf_hat": [0.57, 0.71, 0.78], "alt_cnt": ["16", "32", "11"], "chrom": "11", "pos": "117042354"}, "KANK1:713113:C:A": {"ref_cnt": ["125", "97", "117"], "ccf_hat": [0.4, 0.81, 0.62], "alt_cnt": ["10", "40", "7"], "chrom": "9", "pos": "713113"}, "SNUPN:75913250:A:G": {"ref_cnt": ["100", "83", "115"], "ccf_hat": [0.7, 0.8, 0.56], "alt_cnt": ["19", "37", "6"], "chrom": "15", "pos": "75913250"}, "FSCB:44974476:G:A": {"ref_cnt": ["132", "129", "125"], "ccf_hat": [0.62, 0.85, 0.62], "alt_cnt": ["18", "42", "7"], "chrom": "14", "pos": "44974476"}, "KIAA1407:113755543:G:C": {"ref_cnt": ["86", "36", "104"], "ccf_hat": [0.24, 0.74, 0.43], "alt_cnt": ["4", "33", "4"], "chrom": "3", "pos": "113755543"}, "CHD8:21899708:G:A": {"ref_cnt": ["138", "136", "126"], "ccf_hat": [0.44, 0.71, 0.57], "alt_cnt": ["12", "34", "6"], "chrom": "14", "pos": "21899708"}, "TMED3:79603688:C:A": {"ref_cnt": ["106", "90", "114"], "ccf_hat": [0.5, 0.66, 0.66], "alt_cnt": ["14", "29", "8"], "chrom": "15", "pos": "79603688"}, "GANAB:62407178:A:G": {"ref_cnt": ["109", "86", "106"], "ccf_hat": [0.41, 0.76, 0.9], "alt_cnt": ["10", "35", "14"], "chrom": "11", "pos": "62407178"}, "RP11-557C18.3:124034951:T:A": {"ref_cnt": ["78", "39", "95"], "ccf_hat": [0.53, 0.69, 0.88], "alt_cnt": ["13", "30", "12"], "chrom": "8", "pos": "124034951"}, "GALNT11:151802332:G:A": {"ref_cnt": ["134", "132", "124"], "ccf_hat": [0.52, 0.77, 0.54], "alt_cnt": ["17", "39", "6"], "chrom": "7", "pos": "151802332"}, "NPY2R:156136173:A:G": {"ref_cnt": ["108", "76", "116"], "ccf_hat": [0.44, 0.93, 0.4], "alt_cnt": ["11", "45", "4"], "chrom": "4", "pos": "156136173"}, "SYNDIG1:24523893:G:C": {"ref_cnt": ["105", "79", "111"], "ccf_hat": [0.56, 0.87, 0.7], "alt_cnt": ["16", "41", "9"], "chrom": "20", "pos": "24523893"}, "ZNF107:64167885:C:A": {"ref_cnt": ["135", "131", "125"], "ccf_hat": [0.53, 0.82, 0.62], "alt_cnt": ["15", "40", "7"], "chrom": "7", "pos": "64167885"}, "LEPRE1:43220555:T:G": {"ref_cnt": ["106", "88", "114"], "ccf_hat": [0.5, 0.71, 0.57], "alt_cnt": ["14", "32", "6"], "chrom": "1", "pos": "43220555"}, "RPA2:28224208:C:T": {"ref_cnt": ["103", "95", "115"], "ccf_hat": [0.57, 0.58, 0.56], "alt_cnt": ["16", "26", "6"], "chrom": "1", "pos": "28224208"}, "LIMS2:128408714:C:A": {"ref_cnt": ["77", "28", "103"], "ccf_hat": [0.54, 0.89, 0.51], "alt_cnt": ["13", "41", "5"], "chrom": "2", "pos": "128408714"}, "TACC3:1729784:G:T": {"ref_cnt": ["107", "82", "111"], "ccf_hat": [0.48, 0.82, 0.7], "alt_cnt": ["13", "38", "9"], "chrom": "4", "pos": "1729784"}, "GPR157:9164641:C:G": {"ref_cnt": ["102", "89", "109"], "ccf_hat": [0.6, 0.71, 0.74], "alt_cnt": ["17", "32", "10"], "chrom": "1", "pos": "9164641"}, "TM9SF1:24675792:T:G": {"ref_cnt": ["135", "142", "124"], "ccf_hat": [0.48, 0.59, 0.65], "alt_cnt": ["15", "28", "8"], "chrom": "14", "pos": "24675792"}, "HMCN1:186047311:A:C": {"ref_cnt": ["110", "90", "109"], "ccf_hat": [0.43, 0.67, 0.78], "alt_cnt": ["11", "30", "11"], "chrom": "1", "pos": "186047311"}, "SOGA2:8784078:G:T": {"ref_cnt": ["108", "99", "120"], "ccf_hat": [0.59, 0.66, 0.16], "alt_cnt": ["17", "32", "1"], "chrom": "18", "pos": "8784078"}, "CDK5RAP2:123202054:T:C": {"ref_cnt": ["116", "98", "113"], "ccf_hat": [0.64, 0.8, 0.74], "alt_cnt": ["19", "39", "10"], "chrom": "9", "pos": "123202054"}, "DNAJA3:4493098:C:T": {"ref_cnt": ["111", "97", "112"], "ccf_hat": [0.41, 0.52, 0.7], "alt_cnt": ["10", "23", "9"], "chrom": "16", "pos": "4493098"}, "PDE1B:54960805:A:G": {"ref_cnt": ["102", "85", "116"], "ccf_hat": [0.73, 0.78, 0.49], "alt_cnt": ["20", "36", "5"], "chrom": "12", "pos": "54960805"}}, "line_width": 12, "cnvs": {}}, "3": {"ccf_hat": [0.49, 0.38, 0.18], "tumor_abundance": [0.49, 0.31, 0.18], "ccf_high": [0.49, 0.4, 0.18], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.48, 0.35, 0.18], "muts": {"FN1:216230270:T:C": {"ref_cnt": ["69", "53", "103"], "ccf_hat": [0.87, 0.43, 0.51], "alt_cnt": ["20", "16", "5"], "chrom": "2", "pos": "216230270"}, "ANKK1:113270024:C:A": {"ref_cnt": ["103", "98", "115"], "ccf_hat": [0.57, 0.48, 0.49], "alt_cnt": ["16", "21", "5"], "chrom": "11", "pos": "113270024"}, "GLCE:69560807:A:C": {"ref_cnt": ["106", "106", "117"], "ccf_hat": [0.5, 0.31, 0.31], "alt_cnt": ["14", "14", "3"], "chrom": "15", "pos": "69560807"}, "TIGIT:114014635:A:C": {"ref_cnt": ["72", "52", "107"], "ccf_hat": [0.79, 0.48, 0.17], "alt_cnt": ["18", "18", "1"], "chrom": "3", "pos": "114014635"}, "OSGEP:20922839:G:C": {"ref_cnt": ["137", "155", "128"], "ccf_hat": [0.45, 0.32, 0.43], "alt_cnt": ["12", "15", "4"], "chrom": "14", "pos": "20922839"}, "GALNT10:153796394:T:C": {"ref_cnt": ["107", "96", "108"], "ccf_hat": [0.48, 0.27, 0.47], "alt_cnt": ["13", "12", "5"], "chrom": "5", "pos": "153796394"}, "JAG1:10627668:G:T": {"ref_cnt": ["106", "104", "115"], "ccf_hat": [0.58, 0.37, 0.49], "alt_cnt": ["17", "16", "5"], "chrom": "20", "pos": "10627668"}, "C17orf70:79506933:G:T": {"ref_cnt": ["104", "106", "116"], "ccf_hat": [0.53, 0.31, 0.4], "alt_cnt": ["15", "14", "4"], "chrom": "17", "pos": "79506933"}, "AIFM1:129274566:G:A": {"ref_cnt": ["111", "99", "115"], "ccf_hat": [0.45, 0.5, 0.4], "alt_cnt": ["12", "22", "4"], "chrom": "23", "pos": "129274566"}, "FZR1:3527782:C:G": {"ref_cnt": ["73", "47", "107"], "ccf_hat": [0.75, 0.56, 0.17], "alt_cnt": ["17", "22", "1"], "chrom": "19", "pos": "3527782"}, "ZFC3H1:72009050:A:G": {"ref_cnt": ["106", "102", "116"], "ccf_hat": [0.48, 0.43, 0.4], "alt_cnt": ["13", "19", "4"], "chrom": "12", "pos": "72009050"}, "NYX:41333648:C:G": {"ref_cnt": ["112", "100", "118"], "ccf_hat": [0.35, 0.46, 0.23], "alt_cnt": ["8", "20", "2"], "chrom": "23", "pos": "41333648"}, "RHOT2:721110:T:C": {"ref_cnt": ["111", "102", "115"], "ccf_hat": [0.35, 0.41, 0.49], "alt_cnt": ["8", "18", "5"], "chrom": "16", "pos": "721110"}, "PKD1:2143870:C:A": {"ref_cnt": ["108", "103", "116"], "ccf_hat": [0.48, 0.37, 0.49], "alt_cnt": ["13", "16", "5"], "chrom": "16", "pos": "2143870"}, "FAM73B:131832709:G:A": {"ref_cnt": ["120", "123", "120"], "ccf_hat": [0.54, 0.33, 0.23], "alt_cnt": ["16", "15", "2"], "chrom": "9", "pos": "131832709"}, "CSAD:53565751:G:C": {"ref_cnt": ["104", "98", "116"], "ccf_hat": [0.53, 0.5, 0.31], "alt_cnt": ["15", "22", "3"], "chrom": "12", "pos": "53565751"}, "HHAT:210761317:A:T": {"ref_cnt": ["104", "104", "114"], "ccf_hat": [0.59, 0.34, 0.49], "alt_cnt": ["17", "15", "5"], "chrom": "1", "pos": "210761317"}, "TBL3:2029184:G:C": {"ref_cnt": ["102", "109", "119"], "ccf_hat": [0.6, 0.18, 0.23], "alt_cnt": ["17", "10", "2"], "chrom": "16", "pos": "2029184"}, "APOL5:36122711:G:A": {"ref_cnt": ["88", "81", "109"], "ccf_hat": [0.69, 0.13, 0.34], "alt_cnt": ["17", "6", "3"], "chrom": "22", "pos": "36122711"}, "STRIP1:110577271:A:T": {"ref_cnt": ["109", "101", "119"], "ccf_hat": [0.43, 0.43, 0.16], "alt_cnt": ["11", "19", "1"], "chrom": "1", "pos": "110577271"}, "PEPD:33882299:C:G": {"ref_cnt": ["74", "54", "103"], "ccf_hat": [0.69, 0.41, 0.44], "alt_cnt": ["16", "15", "4"], "chrom": "19", "pos": "33882299"}, "RNMT:13737057:T:C": {"ref_cnt": ["109", "119", "121"], "ccf_hat": [0.52, 0.27, 0.23], "alt_cnt": ["15", "13", "2"], "chrom": "18", "pos": "13737057"}, "ATG2B:96797965:G:A": {"ref_cnt": ["133", "155", "129"], "ccf_hat": [0.5, 0.32, 0.25], "alt_cnt": ["16", "15", "3"], "chrom": "14", "pos": "96797965"}, "SEC24B:110447443:T:G": {"ref_cnt": ["110", "99", "121"], "ccf_hat": [0.43, 0.46, 0.09], "alt_cnt": ["11", "20", "0"], "chrom": "4", "pos": "110447443"}, "RHBDL3:30615934:G:A": {"ref_cnt": ["111", "105", "119"], "ccf_hat": [0.35, 0.34, 0.16], "alt_cnt": ["8", "15", "1"], "chrom": "17", "pos": "30615934"}, "KIAA1875:145166610:C:T": {"ref_cnt": ["73", "50", "106"], "ccf_hat": [0.75, 0.52, 0.24], "alt_cnt": ["17", "20", "2"], "chrom": "8", "pos": "145166610"}, "KLF5:73636865:T:A": {"ref_cnt": ["81", "57", "105"], "ccf_hat": [0.42, 0.32, 0.34], "alt_cnt": ["9", "12", "3"], "chrom": "13", "pos": "73636865"}, "WNT8A:137426335:C:A": {"ref_cnt": ["108", "95", "112"], "ccf_hat": [0.48, 0.33, 0.19], "alt_cnt": ["13", "14", "1"], "chrom": "5", "pos": "137426335"}, "TTN-AS1:179416436:G:C": {"ref_cnt": ["82", "59", "102"], "ccf_hat": [0.39, 0.24, 0.57], "alt_cnt": ["8", "10", "6"], "chrom": "2", "pos": "179416436"}, "CXorf57:105855935:G:T": {"ref_cnt": ["100", "100", "114"], "ccf_hat": [0.74, 0.47, 0.57], "alt_cnt": ["20", "21", "6"], "chrom": "23", "pos": "105855935"}, "HNRNPM:8550997:A:T": {"ref_cnt": ["74", "49", "104"], "ccf_hat": [0.69, 0.52, 0.43], "alt_cnt": ["16", "20", "4"], "chrom": "19", "pos": "8550997"}}, "line_width": 12, "cnvs": {}}, "4": {"ccf_hat": [0.01, 0.13, 0.57], "tumor_abundance": [0.01, 0.13, 0.59], "ccf_high": [0.01, 0.13, 0.59], "color": "rgb(16,49,41)", "drivers": ["RUNX1:36164431:A:T"], "ccf_low": [0.01, 0.13, 0.53], "muts": {"KIAA1033:105520961:A:G": {"ref_cnt": ["121", "108", "112"], "ccf_hat": [0.04, 0.21, 0.62], "alt_cnt": ["0", "11", "7"], "chrom": "12", "pos": "105520961"}, "DMRT1:968100:C:T": {"ref_cnt": ["136", "126", "116"], "ccf_hat": [0.03, 0.19, 0.66], "alt_cnt": ["0", "10", "8"], "chrom": "9", "pos": "968100"}, "WDR81:1629300:G:C": {"ref_cnt": ["120", "109", "114"], "ccf_hat": [0.04, 0.21, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "17", "pos": "1629300"}, "ERBB2IP:65350307:G:T": {"ref_cnt": ["120", "112", "111"], "ccf_hat": [0.04, 0.14, 0.7], "alt_cnt": ["0", "8", "9"], "chrom": "5", "pos": "65350307"}, "SLC1A7:53555505:T:C": {"ref_cnt": ["120", "109", "116"], "ccf_hat": [0.04, 0.24, 0.4], "alt_cnt": ["0", "12", "4"], "chrom": "1", "pos": "53555505"}, "CHUK:101985693:G:T": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.23, 0.27], "alt_cnt": ["0", "12", "2"], "chrom": "10", "pos": "101985693"}, "CDC42BPG:64591978:G:A": {"ref_cnt": ["121", "107", "111"], "ccf_hat": [0.04, 0.21, 0.7], "alt_cnt": ["0", "11", "9"], "chrom": "11", "pos": "64591978"}, "SREBF2:42274089:T:A": {"ref_cnt": ["104", "72", "107"], "ccf_hat": [0.04, 0.31, 0.57], "alt_cnt": ["0", "14", "6"], "chrom": "22", "pos": "42274089"}, "UBR4:19441375:A:G": {"ref_cnt": ["119", "108", "114"], "ccf_hat": [0.04, 0.21, 0.31], "alt_cnt": ["0", "11", "3"], "chrom": "1", "pos": "19441375"}, "MLLT4:168317907:C:T": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.32, 0.44], "alt_cnt": ["0", "12", "4"], "chrom": "6", "pos": "168317907"}, "MROH2A:234740858:G:A": {"ref_cnt": ["90", "60", "100"], "ccf_hat": [0.04, 0.2, 0.78], "alt_cnt": ["0", "9", "10"], "chrom": "2", "pos": "234740858"}, "RP5-955M13.4:49620912:C:T": {"ref_cnt": ["120", "109", "111"], "ccf_hat": [0.04, 0.21, 0.66], "alt_cnt": ["0", "11", "8"], "chrom": "20", "pos": "49620912"}, "ADAMTS17:100881562:G:A": {"ref_cnt": ["119", "110", "115"], "ccf_hat": [0.04, 0.18, 0.49], "alt_cnt": ["0", "10", "5"], "chrom": "15", "pos": "100881562"}, "DNAH1:52378601:A:G": {"ref_cnt": ["91", "58", "103"], "ccf_hat": [0.04, 0.28, 0.57], "alt_cnt": ["0", "11", "6"], "chrom": "3", "pos": "52378601"}, "GAB4:17472793:T:G": {"ref_cnt": ["135", "118", "115"], "ccf_hat": [0.03, 0.39, 0.67], "alt_cnt": ["0", "19", "8"], "chrom": "22", "pos": "17472793"}, "NCCRP1:39687902:C:A": {"ref_cnt": ["91", "52", "101"], "ccf_hat": [0.04, 0.46, 0.63], "alt_cnt": ["0", "17", "7"], "chrom": "19", "pos": "39687902"}, "SRSF4:29475729:G:T": {"ref_cnt": ["120", "110", "116"], "ccf_hat": [0.04, 0.18, 0.4], "alt_cnt": ["0", "10", "4"], "chrom": "1", "pos": "29475729"}, "TBL3:2026293:G:C": {"ref_cnt": ["119", "106", "113"], "ccf_hat": [0.04, 0.34, 0.62], "alt_cnt": ["0", "15", "7"], "chrom": "16", "pos": "2026293"}, "BBC3:47731597:A:C": {"ref_cnt": ["90", "60", "102"], "ccf_hat": [0.04, 0.2, 0.57], "alt_cnt": ["0", "9", "6"], "chrom": "19", "pos": "47731597"}, "RNF175:154649424:G:C": {"ref_cnt": ["120", "104", "119"], "ccf_hat": [0.04, 0.34, 0.16], "alt_cnt": ["0", "15", "1"], "chrom": "4", "pos": "154649424"}, "ZAP70:98353960:G:C": {"ref_cnt": ["90", "53", "102"], "ccf_hat": [0.04, 0.43, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "2", "pos": "98353960"}, "SYNM:99673178:A:C": {"ref_cnt": ["120", "108", "112"], "ccf_hat": [0.04, 0.24, 0.66], "alt_cnt": ["0", "12", "8"], "chrom": "15", "pos": "99673178"}, "IGKV1D-8:90260001:C:T": {"ref_cnt": ["90", "53", "103"], "ccf_hat": [0.04, 0.43, 0.51], "alt_cnt": ["0", "16", "5"], "chrom": "2", "pos": "90260001"}, "IGFBP5:217543736:T:C": {"ref_cnt": ["90", "55", "103"], "ccf_hat": [0.04, 0.38, 0.51], "alt_cnt": ["0", "14", "5"], "chrom": "2", "pos": "217543736"}, "MINPP1:89312122:A:G": {"ref_cnt": ["149", "160", "127"], "ccf_hat": [0.03, 0.18, 0.56], "alt_cnt": ["0", "10", "6"], "chrom": "10", "pos": "89312122"}, "RUNX1:36164431:A:T": {"ref_cnt": ["90", "55", "101"], "ccf_hat": [0.04, 0.38, 0.63], "alt_cnt": ["0", "14", "7"], "chrom": "21", "pos": "36164431"}, "LOXL4:100013436:T:G": {"ref_cnt": ["150", "159", "125"], "ccf_hat": [0.03, 0.21, 0.65], "alt_cnt": ["0", "11", "8"], "chrom": "10", "pos": "100013436"}, "SF3B3:70588479:A:T": {"ref_cnt": ["119", "105", "114"], "ccf_hat": [0.04, 0.36, 0.57], "alt_cnt": ["0", "16", "6"], "chrom": "16", "pos": "70588479"}, "GALR1:74968154:A:G": {"ref_cnt": ["123", "116", "116"], "ccf_hat": [0.04, 0.28, 0.66], "alt_cnt": ["0", "13", "8"], "chrom": "18", "pos": "74968154"}}, "line_width": 12, "cnvs": {}}, "5": {"ccf_hat": [0.22, 0.13, 0.12], "tumor_abundance": [0.22, 0.13, 0.0], "ccf_high": [0.24, 0.13, 0.15], "color": "rgb(93,119,254)", "drivers": ["FAT1:187630396:C:G"], "ccf_low": [0.19, 0.13, 0.09], "muts": {"MYH7B:33587391:A:C": {"ref_cnt": ["116", "109", "121"], "ccf_hat": [0.24, 0.18, 0.09], "alt_cnt": ["5", "10", "0"], "chrom": "20", "pos": "33587391"}, "NAE1:66855435:G:A": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.28, 0.13, 0.09], "alt_cnt": ["6", "7", "0"], "chrom": "16", "pos": "66855435"}, "FAT1:187630396:C:G": {"ref_cnt": ["113", "109", "118"], "ccf_hat": [0.32, 0.21, 0.23], "alt_cnt": ["7", "11", "2"], "chrom": "4", "pos": "187630396"}, "ACSF2:48543131:A:G": {"ref_cnt": ["112", "109", "121"], "ccf_hat": [0.29, 0.18, 0.09], "alt_cnt": ["6", "10", "0"], "chrom": "17", "pos": "48543131"}, "FANCM:45644784:G:A": {"ref_cnt": ["145", "157", "131"], "ccf_hat": [0.22, 0.29, 0.08], "alt_cnt": ["5", "14", "0"], "chrom": "14", "pos": "45644784"}, "TBCE:235612022:A:T": {"ref_cnt": ["115", "113", "118"], "ccf_hat": [0.25, 0.14, 0.17], "alt_cnt": ["5", "8", "1"], "chrom": "1", "pos": "235612022"}, "TADA2A:35787086:G:A": {"ref_cnt": ["116", "107", "117"], "ccf_hat": [0.24, 0.28, 0.17], "alt_cnt": ["5", "13", "1"], "chrom": "17", "pos": "35787086"}, "NUP214:134021594:C:T": {"ref_cnt": ["130", "128", "122"], "ccf_hat": [0.18, 0.17, 0.22], "alt_cnt": ["4", "9", "2"], "chrom": "9", "pos": "134021594"}, "AKNAD1:109394539:C:G": {"ref_cnt": ["111", "109", "118"], "ccf_hat": [0.38, 0.21, 0.23], "alt_cnt": ["9", "11", "2"], "chrom": "1", "pos": "109394539"}, "ZCCHC8:122962428:G:A": {"ref_cnt": ["117", "114", "119"], "ccf_hat": [0.2, 0.12, 0.09], "alt_cnt": ["4", "6", "0"], "chrom": "12", "pos": "122962428"}, "TMEM63C:77706047:A:T": {"ref_cnt": ["148", "161", "129"], "ccf_hat": [0.14, 0.16, 0.27], "alt_cnt": ["3", "9", "2"], "chrom": "14", "pos": "77706047"}, "IER5L:131940089:G:C": {"ref_cnt": ["129", "126", "123"], "ccf_hat": [0.27, 0.22, 0.16], "alt_cnt": ["6", "11", "1"], "chrom": "9", "pos": "131940089"}, "FN1:216238128:T:A": {"ref_cnt": ["85", "58", "104"], "ccf_hat": [0.25, 0.28, 0.25], "alt_cnt": ["4", "11", "2"], "chrom": "2", "pos": "216238128"}, "KRTAP9-1:39346272:C:A": {"ref_cnt": ["112", "108", "118"], "ccf_hat": [0.35, 0.24, 0.23], "alt_cnt": ["8", "12", "2"], "chrom": "17", "pos": "39346272"}, "HNF4A:43052716:G:C": {"ref_cnt": ["114", "107", "120"], "ccf_hat": [0.28, 0.28, 0.09], "alt_cnt": ["6", "13", "0"], "chrom": "20", "pos": "43052716"}, "S100Z:76171313:G:C": {"ref_cnt": ["116", "112", "119"], "ccf_hat": [0.2, 0.14, 0.16], "alt_cnt": ["4", "8", "1"], "chrom": "5", "pos": "76171313"}, "C5orf15:133295309:G:C": {"ref_cnt": ["115", "100", "112"], "ccf_hat": [0.28, 0.11, 0.24], "alt_cnt": ["6", "8", "2"], "chrom": "5", "pos": "133295309"}, "RND1:49251924:A:G": {"ref_cnt": ["119", "110", "118"], "ccf_hat": [0.08, 0.18, 0.17], "alt_cnt": ["1", "10", "1"], "chrom": "12", "pos": "49251924"}, "RP11-347C12.3:30215989:T:A": {"ref_cnt": ["112", "111", "120"], "ccf_hat": [0.32, 0.16, 0.09], "alt_cnt": ["7", "9", "0"], "chrom": "16", "pos": "30215989"}, "WDR24:739523:G:T": {"ref_cnt": ["118", "115", "115"], "ccf_hat": [0.16, 0.11, 0.4], "alt_cnt": ["3", "5", "4"], "chrom": "16", "pos": "739523"}, "EPB41L3:5406792:G:A": {"ref_cnt": ["120", "125", "120"], "ccf_hat": [0.2, 0.11, 0.16], "alt_cnt": ["4", "5", "1"], "chrom": "18", "pos": "5406792"}, "ALDH18A1:97370040:G:T": {"ref_cnt": ["148", "156", "127"], "ccf_hat": [0.14, 0.29, 0.27], "alt_cnt": ["3", "14", "2"], "chrom": "10", "pos": "97370040"}, "MYO18A:27441955:G:T": {"ref_cnt": ["108", "110", "117"], "ccf_hat": [0.41, 0.18, 0.23], "alt_cnt": ["10", "10", "2"], "chrom": "17", "pos": "27441955"}, "ZBTB17:16271489:G:C": {"ref_cnt": ["113", "107", "119"], "ccf_hat": [0.29, 0.28, 0.16], "alt_cnt": ["6", "13", "1"], "chrom": "1", "pos": "16271489"}, "CGN:151492653:T:C": {"ref_cnt": ["114", "105", "117"], "ccf_hat": [0.25, 0.31, 0.23], "alt_cnt": ["5", "14", "2"], "chrom": "1", "pos": "151492653"}, "BCAP31:152986419:T:C": {"ref_cnt": ["118", "108", "118"], "ccf_hat": [0.2, 0.27, 0.23], "alt_cnt": ["4", "13", "2"], "chrom": "23", "pos": "152986419"}, "CEBPZ:37450499:C:T": {"ref_cnt": ["82", "61", "105"], "ccf_hat": [0.39, 0.2, 0.34], "alt_cnt": ["8", "9", "3"], "chrom": "2", "pos": "37450499"}}, "line_width": 12, "cnvs": {}}, "6": {"ccf_hat": [0.08, 0.16, 0.31], "tumor_abundance": [0.09, 0.13, 0.18], "ccf_high": [0.16, 0.27, 0.59], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.01, 0.08, 0.06], "muts": {"CT47A8:120083605:T:C": {"ref_cnt": ["119", "111", "117"], "ccf_hat": [0.08, 0.16, 0.31], "alt_cnt": ["1", "9", "3"], "chrom": "23", "pos": "120083605"}}, "line_width": 1.0, "cnvs": {}}}};

      if (fish_options) {
        $("#fish-plot").fish_plot(fish_options)
      }
    })
  </script>
  <style>
    .active-sample:hover {
      background-color: #f0f0f0;
    }

    .removed-sample {
      background-color: gray;
    }

    .active-cluster {
      opacity: 1.0;
    }

    .removed-cluster {
      opacity: 0.2;
    }
  </style>
</head>

<body>
  <main>
    <div class="container-fluid">
      <div class="row">
        <h2 class="ml-3" >Phylogic Results - patient2</h2>
      </div>
      <div class="card">
        <div id="headingOne" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Clustering plot/tree
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne">
          <div class="card-body">
            <div class="row">
              <div id="sample-name-table" style="max-height: 600px; width: 25%; padding-right: 30px; overflow-y: auto; display: table-cell">
              </div><div class="border-right" style="overflow-y: hidden; width: 45%; padding-right: 30px; display: table-cell">
                <div style="min-width: 450px">
                  <div style="display: inline-block; width: 84%; vertical-align: top">
                    <div id="clustering-plot"></div>
                    <div id="treatment-plot"></div>
                    <button onclick="$('#clustering-plot').clustering_plot('download')" style="font-size: 12px">Download as SVG</button>
                  </div><div style="display: inline-block; width: 16%; vertical-align: top">
                    <div id="time-switch"></div>
                    <div id="cluster-switches" style="overflow-x: hidden"></div>
                  </div>
                </div>
              </div><div style="width: 30%">
                <div id="tree"></div>
                <div id="tree-switch"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingTwo" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
              Clonality chart
            </button>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo">
          <div class="card-body">
            <div class="row">
              <div id="mutation-visual" class="col-md-12 overflow-auto"></div>
              <button onclick="$('#mutation-visual').mutation_visual('download')" style="font-size: 12px">Download as SVG</button>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingThree" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
              Mutation table
            </button>
          </h5>
        </div>
        <div id="collapseThree" class="collapse show" aria-labelledby="headingThree">
          <div class="card-body">
            <div class="row">
              <div id="cluster-table" class="col-md-12 overflow-auto"></div>
            </div>
            <button onclick="$('#cluster-table').cluster_table('download_as_tsv')" style="font-size: 12px">Download as TSV</button>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingFour" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
              Other plots
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse show" aria-labelledby="headingFour">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 text-center">
                <div id="mutation-plot"></div>
                <button onclick="$('#mutation-plot').mutation_plot('download')" style="font-size: 12px">Download as SVG</button>
              </div>
              <div class="col-md-6 text-center">
                <div id="fish-plot"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" style="padding-bottom: 50px"></div>
    </div>
  </main>
</body>
</html>