<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head>
  <title>patient1 Phylogic Report</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
  <script src="https://d3js.org/d3.v5.js"></script>
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.sample_name_table", {

        options: {
          columns: [],
          sample_names: [],
          sample_aliases: [],
          sample_dates: [],
          pie_plots: []
        },


        _create: function() {
          let columns = this.options.columns;

          let table = d3.select(this.element.context).append("table")
            .attr("class", "table table-bordered hover");

          table.append("thead")
            .selectAll("td")
            .data(columns)
            .join("td")
            .attr("style", "font-weight:bold; font-size: 12px")
            .html(d => d);

          table.append("tbody")
            .selectAll("tr")
            .data(this.options.sample_names)
            .join("tr")
            .attr("style", "font-size: 12px; cursor: pointer;")
            .attr("class", "active-sample")
            .attr("onclick", "$(\"#sample-name-table\").sample_name_table(\"toggle_sample\", this)")
            .html((d, i) => "<td>" + d + "</td>"
              + (this.options.sample_aliases.length ? "<td>" + this.options.sample_aliases[i] + "</td>" : "")
              + (this.options.sample_dates.length ? "<td>" + this.options.sample_dates[i] + "</td>" : "")
              + "<td><img src=data:image/png;base64," + this.options.pie_plots[i] + " alt=\"Run BuildTree to display\"></td>");

        },

        toggle_sample: function(row) {
          if (row.className === "active-sample") {
            row.className = "removed-sample";
          } else {
            row.className = "active-sample"
          }
        }

      });

      $("#sample-name-table").sample_name_table({"sample_aliases": ["T0", "T1", "T2"], "pie_plots": ["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"], "sample_names": ["t1", "t2", "t3"], "columns": ["Sample Name", "Alias", "Clonal Abundance"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.clustering_plot", {

        options: {
          xlabels: [],
          time_points: [],
          cluster_dict: {},
          width: 500,
          height: 400,
          margins: {top: 20, right: 50, bottom: 35, left: 50}
        },

        _elements: {
          nd: undefined,
          real_time: undefined,
          scaled: undefined,
          time_agnostic_plot: undefined,
          time_scaled_plot: undefined,
          plot_1d: undefined,
          t: undefined,
          n: undefined,
          y: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            n_samples = xlabels.length,
            unscaled_x = [...Array(n_samples).keys()];

          this._elements.nd = xlabels.length > 1;
          this._elements.real_time = time_points.reduce((a, c, i) => a || !(c===i), false);
          this._elements.scaled = this._elements.real_time;

          if (this._elements.nd) {
            let n = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let time_agnostic_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("overflow", "visible")
              .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
              .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
              .style("display", this._elements.real_time ? "none" : "block")
              .style("max-height", "450px");
            time_agnostic_plot.append("g")
              .call(g => g
                .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                .call(d3.axisBottom(n).tickValues(unscaled_x).tickFormat(d => xlabels[d]))
              );
            time_agnostic_plot.append("g")
              .call(yAxis);
            time_agnostic_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            time_agnostic_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            for (let clust in cluster_dict) {
              time_agnostic_plot.append("path")
                .datum(unscaled_x)
                .attr("fill", "none")
                .attr("stroke", cluster_dict[clust].color)
                .attr("stroke-width", cluster_dict[clust].line_width)
                .attr("opacity", 0.5)
                .attr("d", d3.line()
                  .x(d => n(d))
                  .y(d => y(cluster_dict[clust].ccf_hat[d])));
              time_agnostic_plot.append("polygon")
                .attr("fill", cluster_dict[clust].color)
                .attr("stroke", "none")
                .attr("opacity", 0.2)
                .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + n(i) + "," + y(c) + " ", "") +
                  cluster_dict[clust].ccf_low.reverse().reduce((a, c, i) => a + n(n_samples - i - 1) + "," + y(c) + " ", "")
                );
              time_agnostic_plot.append("g").selectAll("circle")
                .data(unscaled_x)
                .join("circle")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("r", 7)
                  .attr("opacity", 1.0)
                  .attr("cx", d => n(d))
                  .attr("cy", d => y(cluster_dict[clust].ccf_hat[d]))
            }
            time_agnostic_plot.append("g")
              .style("display", "none")
              .attr("class", "tooltip_");

            this._elements.n = n;
            this._elements.time_agnostic_plot = time_agnostic_plot.node();

            if (this._elements.real_time) {
              let t = d3.scaleLinear()
                .domain([Math.min(...time_points), Math.max(...time_points)])
                .range([margins.left, width - margins.right]);

              let time_scaled_plot = d3.select(document.createElement("svg"))
                .attr("baseProfile", "full")
                .attr("viewBox", "0 0 " + width + " " + height)
                .attr("version", "1.1")
                .attr("xmlns", "http://www.w3.org/2000/svg")
                .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
                .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
                .attr("overflow", "visible")
                .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
                .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\", this)")
                .style("display", "block")
                .style("max-height", "450px");
              time_scaled_plot.append("g")
                .call(g => g
                  .attr("transform", "translate(0 " + (height - margins.bottom) + ")")
                  .call(d3.axisBottom(t))
                );
              time_scaled_plot.append("g")
                .call(yAxis);
              time_scaled_plot.append("text")
                .attr("x", (width + margins.left - margins.right) / 2)
                .attr("y", height - 5)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("Time");
              time_scaled_plot.append("text")
                .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
                .attr("x", 10)
                .attr("y", (height + margins.top - margins.bottom) / 2)
                .style("text-anchor", "middle")
                .attr("font-size", "10px")
                .text("CCF(x)");
              for (let clust in cluster_dict) {
                time_scaled_plot.append("path")
                  .datum(time_points)
                  .attr("fill", "none")
                  .attr("stroke", cluster_dict[clust].color)
                  .attr("stroke-width", cluster_dict[clust].line_width)
                  .attr("opacity", 0.5)
                  .attr("d", d3.line()
                    .x(d => t(d))
                    .y((d, i) => y(cluster_dict[clust].ccf_hat[i])));
                time_scaled_plot.append("polygon")
                  .attr("fill", cluster_dict[clust].color)
                  .attr("stroke", "none")
                  .attr("opacity", 0.2)
                  .attr("points", cluster_dict[clust].ccf_high.reduce((a, c, i) => a + t(time_points[i]) + "," + y(c) + " ", "") +
                    cluster_dict[clust].ccf_low.reduce((a, c, i) => a + t(time_points[n_samples - i - 1]) + "," + y(c) + " ", "")
                  );
                time_scaled_plot.append("g").selectAll("circle")
                  .data(time_points)
                  .join("circle")
                    .attr("fill", cluster_dict[clust].color)
                    .attr("stroke", "none")
                    .attr("r", 7)
                    .attr("opacity", 1.0)
                    .attr("cx", d => t(d))
                    .attr("cy", (d, i) => y(cluster_dict[clust].ccf_hat[i]))
              }
              time_scaled_plot.append("g")
                .style("display", "none")
                .attr("class", "tooltip_");
              
              this._elements.t = t;
              this._elements.time_scaled_plot = time_scaled_plot.node()
            }
            for (let clust in cluster_dict) {
              cluster_dict[clust].ccf_low.reverse();
            }
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              max_bin = Math.max(max_bin, ...cluster_dict[c].ccf_dist);
              n_bins = cluster_dict[c].ccf_dist.length
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("style", "max-height: 450px");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            plot_1d.selectAll("polygon")
              .data(Object.keys(cluster_dict))
              .join("polygon")
              .attr("points", d =>
                cluster_dict[d].ccf_dist.reduce(
                  (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                ) + zero_str
              )
              .attr("fill", d => cluster_dict[d].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");

            this._elements.plot_1d = plot_1d.node()
          }
          
          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.nd ?
            (this._elements.real_time ? this._elements.time_scaled_plot.outerHTML : "") + this._elements.time_agnostic_plot.outerHTML :
            this._elements.plot_1d.outerHTML;
        },

        switch_plot: function() {
          let display = this._elements.time_agnostic_plot.style.display === "none";
          this._elements.time_agnostic_plot.style.display = display ? "block" : "none";
          this._elements.time_scaled_plot.style.display = display ? "none" : "block";
          this._elements.scaled = !this._elements.scaled;

          this._refresh();
        },

        show_value: function(eve, plot) {
          let {width, height} = plot.getBoundingClientRect(),
            mouse_pos_x = eve.layerX * this.options.width / width,
            mouse_pos_y = eve.layerY * this.options.height / height,
            cluster_dict = this.options.cluster_dict,
            xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tooltip = d3.select(plot).select(".tooltip_"),
            x,
            n;

          if (this._elements.scaled) {
            let scale_x = this._elements.t,
              x_s = scale_x.invert(mouse_pos_x),
              t = time_points.reduce((a, c) => (Math.abs(c - x_s) < Math.abs(a - x_s) ? c : a));
            n = time_points.indexOf(t);
            x = scale_x(t);
          } else {
            let scale_x = this._elements.n;
            n = Math.round(scale_x.invert(mouse_pos_x));
            x = scale_x(n);
          }

          tooltip
            .attr("style", "display: block;")
            .attr("transform", "translate(" + x + "," + mouse_pos_y + ")");

          let border = tooltip.selectAll("path")
            .data([null])
            .join("path")
              .attr("fill", "white")
              .attr("stroke", "black");

          let text_el = tooltip.selectAll("text")
            .data([null])
            .attr("font-size", "9px")
            .join("text")
            .call(t => t
              .selectAll("tspan")
              .data([xlabels[n], ...Object.keys(cluster_dict)])
              .join("tspan")
                .attr("x", 0)
                .attr("y", (d, i) => (i * 1.1) + "em")
                .style("font-weight", (d, i) => i ? null : "bold")
                .style("fill", (d, i) => i ? cluster_dict[d].color : "black")
                .text((d, i) => i ? cluster_dict[d].ccf_hat[n] + " (" + cluster_dict[d].ccf_low[n] + "-" +
                  cluster_dict[d].ccf_high[n] + ")" : d)
            );

          let {y, width: w, height: h} = text_el.node().getBBox();

          text_el.attr("transform", "translate(" + (-w / 2) + "," + (15 - y) + ")");
          border.attr("d", "M" + (-w / 2 - 10) + ",5H-5l5,-5l5,5H" +
            (w / 2 + 10) + "v" + (h + 20) +
            "h-" + (w + 20) + "z");
        },

        hide_value: function(plot) {
          d3.select(plot).select(".tooltip_").style("display", "none")
        },

        download: function() {
          let dl_link;
          if (this._elements.scaled) {
            let time_scaled_plot = this._elements.time_scaled_plot.cloneNode(true);
            time_scaled_plot.removeAttribute("onmousemove");
            time_scaled_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_scaled_plot.outerHTML);
          } else if (this._elements.nd) {
            let time_agnostic_plot = this._elements.time_agnostic_plot.cloneNode(true);
            time_agnostic_plot.removeAttribute("onmousemove");
            time_agnostic_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_agnostic_plot.outerHTML);
          } else {
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.plot_1d.outerHTML);
          }
          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".clustering_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
        }

      });

      $("#clustering-plot").clustering_plot({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.time_switch", {

        options: {show: true},

        _elements: {time_switch: undefined, input: undefined},

        _create: function() {
          if (this.options.show) {
            let time_switch = d3.select(document.createElement("label"))
              .html("Time-scaled");
            this._elements.input = time_switch.append("input")
              .attr("type", "checkbox")
              .attr("checked", "")
              .attr("onclick", "$(\"#time-switch\").time_switch(\"switch_plot\")")
              .node();

            this._elements.time_switch = time_switch.node();

            this._refresh()

          }
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.time_switch.outerHTML;
        },

        is_checked: function() {
          if (this.options.show) {
            return this._elements.input.hasAttribute("checked")
          }
          return true
        },

        switch_plot: function() {
          if (this.is_checked()) {
            this._elements.input.removeAttribute("checked");
          } else {
            this._elements.input.setAttribute("checked", "");
          }
          $("#clustering-plot").clustering_plot("switch_plot");

          this._refresh();
        }

      });

      $("#time-switch").time_switch({"show": false})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_switches", {
        options: {
          cluster_dict: {},
          time_points: [],
          xlabels: [],
          tumor_sizes: {},
          child_dict: {}
        },

        _elements: {
          active_clusters: [],
          svg_switches: undefined
        },

        _create: function() {
          let cluster_dict = this.options.cluster_dict,
            svg_layout = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          for (let c in cluster_dict) {
            this._elements.active_clusters.push(c);
          }
          svg_layout.attr("viewBox", "0 0 120 " + ((this._elements.active_clusters.length + 2) * 30));
          svg_layout.selectAll("rect")
            .data(this._elements.active_clusters)
            .join("rect")
            .attr("class", "active-cluster")
            .attr("style", "cursor: pointer;")
            .attr("cluster", (_, i) => i + 1)
            .attr("x", 0)
            .attr("y", (_, i) => i * 30 + 30)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", d => cluster_dict[d].color)
            .attr("stroke", "none")
            .attr("opacity", 0.8)
            .attr("onclick", "$(\"#cluster-switches\").cluster_switches(\"toggle_cluster\", this)");
          svg_layout.selectAll("text")
            .data(this._elements.active_clusters)
            .join("text")
            .attr("x", 30)
            .attr("y", (_, i) => i * 30 + 45)
            .attr("fill", d => cluster_dict[d].color)
            .text(d => d + " (" + Object.keys(cluster_dict[d].muts).length.toString() + ")");
          svg_layout.append("text")
            .attr("x", 0)
            .attr("y", 15)
            .attr("font-size", "11.5px")
            .text("Cluster (# variants)");

          this._elements.svg_switches = svg_layout.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_switches.outerHTML;
        },

        toggle_cluster: function(cluster_switch) {
          let c = cluster_switch.getAttribute("cluster"),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            active_clusters = this._elements.active_clusters,
            cluster_dict_subset = {},
            altered_child_dict = {};
          if (cluster_switch.getAttribute("class") === "active-cluster") {
            cluster_switch.setAttribute("class", "removed-cluster");
            for (let i in active_clusters) {
              if (active_clusters[i] === c) {
                active_clusters.splice(i, 1);
                break;
              }
            }
          } else {
            cluster_switch.setAttribute("class", "active-cluster");
            active_clusters.push(c);
          }

          let get_new_children = function(cluster) {
            let children = [];
            for (let i in child_dict[cluster]) {
              if (active_clusters.includes(child_dict[cluster][i].toString())) {
                children.push(child_dict[cluster][i])
              } else {
                children.push(...get_new_children(child_dict[cluster][i]))
              }
            }
            return children
          };

          for (let i in active_clusters) {
            let active_cluster = active_clusters[i];
            cluster_dict_subset[active_cluster] = cluster_dict[active_cluster];
            if (child_dict) {
              altered_child_dict[active_cluster] = get_new_children(active_cluster)
            }
          }
          if (child_dict) {
            altered_child_dict[null] = get_new_children(null);
          }

          let clustering_plot = $("#clustering-plot");
          clustering_plot.clustering_plot("destroy");
          clustering_plot.clustering_plot({
            xlabels: this.options.xlabels,
            time_points: this.options.time_points,
            cluster_dict: cluster_dict_subset});
          if (!$("#time-switch").time_switch("is_checked")) {
            clustering_plot.clustering_plot("switch_plot");
          }

          let mutation_plot = $("#mutation-plot");
          mutation_plot.mutation_plot("destroy");
          mutation_plot.mutation_plot({
            xlabels: this.options.xlabels,
            cluster_dict: cluster_dict_subset});

          if (child_dict) {
            let fish_plot = $("#fish-plot");
            fish_plot.fish_plot("destroy");
            fish_plot.fish_plot({
              xlabels: this.options.xlabels,
              time_points: this.options.time_points,
              tumor_sizes: this.options.tumor_sizes,
              cluster_dict: cluster_dict_subset,
              child_dict: altered_child_dict
            })
          }
        }
      });

      $("#cluster-switches").cluster_switches({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree", {

        options: {
          patient: "",
          child_dict: {},
          tree_coordinates: {},
          cluster_dict: {}
        },

        _elements: {
          svg_tree: undefined,
          branch_trunc_labels: {},
          branch_full_labels: {}
        },

        _create: function() {
          let patient = this.options.patient,
            child_dict = this.options.child_dict,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            clusters = Object.keys(tree_coordinates),
            edges = [];

          for (let parent in child_dict) {
            child_dict[parent].forEach(function(child) {
              edges.push([parent, child])
            })
          }

          let svg_tree = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("style", "max-height: 600px;")
            .attr("width", this.element.context.parentNode.getBoundingClientRect().width);
          svg_tree.append("g")
            .append("text")
              .attr("x", -20)
              .attr("y", 40)
              .attr("text-anchor", "end")
              .attr("font", "Arial")
              .attr("font-size", "20px")
              .html(patient);

          let branch_cont = svg_tree.append("g")
            .selectAll("line")
            .data(edges)
            .join("line")
            .attr("x1", d => tree_coordinates[d[0]][0])
            .attr("y1", d => tree_coordinates[d[0]][1])
            .attr("x2", d => tree_coordinates[d[1]][0])
            .attr("y2", d => tree_coordinates[d[1]][1])
            .attr("stroke", d => cluster_dict[d[1]].color)
            .attr("stroke-width", 8)
            .attr("opacity", 1.0)
            .attr("class", d => d[1]);

          let node_cont = svg_tree.append("g")
            .selectAll("circle")
            .data(clusters)
            .join("circle")
            .attr("cx", d => tree_coordinates[d][0])
            .attr("cy", d => tree_coordinates[d][1])
            .attr("r", d => d !== "null" ? 12 : 24)
            .attr("stroke", "white")
            .attr("stroke-width", 1)
            .attr("fill", d => d !== "null" ? cluster_dict[d].color : "blue")
            .attr("opacity", 1.0);

          let node_label_cont = svg_tree.append("g")
            .selectAll("text")
            .data(clusters)
            .join("text")
            .attr("x", d => tree_coordinates[d][0])
            .attr("y", d => tree_coordinates[d][1] + 5)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .text(d => d !== "null" ? d : "normal");

          let branch_label_cont = svg_tree.append("g"),
            branch_trunc_labels = {},
            branch_full_labels = {};
          for (let e in edges) {
            let edge = edges[e],
              cnvs = Object.keys(cluster_dict[edge[1]].muts).filter(m => m.startsWith("loss") || m.startsWith("gain") || m === "WGD"),
              branch_height = Math.abs(tree_coordinates[edge[0]][1] - tree_coordinates[edge[1]][1]),
              n_labels = Math.max(4, branch_height / 10 - 2),
              label_list = [Object.keys(cluster_dict[edge[1]].muts).length, ...cluster_dict[edge[1]].drivers, ...cnvs],
              truncate = label_list.length > n_labels + 1,
              trunc_labels = truncate ? [...label_list.slice(0, n_labels), "..."] : label_list;
            branch_trunc_labels[edge[1]] = (trunc_labels);
            branch_full_labels[edge[1]] = (label_list);
            branch_label_cont.append("text")
              .attr("y", (tree_coordinates[edge[0]][1] + tree_coordinates[edge[1]][1]) / 2 - (5 * (trunc_labels.length)))
              .attr("text-anchor", "middle")
              .attr("font-size", 10)
              .attr("font-weight", "bold")
              .attr("parent", edge[0])
              .attr("child", edge[1])
              .selectAll("tspan")
              .data(trunc_labels)
              .join("tspan")
              .attr("x", (tree_coordinates[edge[0]][0] + tree_coordinates[edge[1]][0]) / 2)
              .attr("dy", 10)
              .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
              .attr("style", d => d === "..." ? "cursor: pointer;" : "")
              .text((d, i) => i ? d : "(" + d + ")");
          }

          let x_values = Object.values(tree_coordinates).map(p => p[0]),
            y_values = Object.values(tree_coordinates).map(p => p[1]),
            x_min = Math.min(...x_values),
            x_max = Math.max(...x_values),
            y_min = Math.min(...y_values),
            y_max = Math.max(...y_values),
            view_x_min = x_max - x_min > 300 ? x_min - 50 : (x_min + x_max) / 2 - 200,
            view_y_min = y_max - y_min > 400 ? y_min - 50 : (y_min + y_max) / 2 - 250,
            view_width = x_max - x_min > 300 ? x_max - x_min + 100 : 400,
            view_height = y_max - y_min > 400 ? y_max - y_min + 100 : 500;

          svg_tree.attr("viewBox", [view_x_min, view_y_min, view_width, view_height].join(","));

          this._elements.svg_tree = svg_tree.node();
          this._elements.branch_full_labels = branch_full_labels;
          this._elements.branch_trunc_labels = branch_trunc_labels;

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_tree.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.svg_tree.outerHTML.replace("viewbox", "viewBox")),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".tree.svg");
          dl.click();
        },

        expand: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            label_list = [...this._elements.branch_full_labels[child], "Condense ^"],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (label_list.length)))
            .selectAll("tspan")
            .data(label_list)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "Condense ^" ? "$(\"#tree\").tree(\"condense\", this)" : "")
            .attr("style", d => d === "Condense ^" ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        condense: function(label) {
          let branch_label = d3.select(label.parentElement),
            parent = branch_label.attr("parent"),
            child = branch_label.attr("child"),
            trunc_labels = this._elements.branch_trunc_labels[child],
            tree_coordinates = this.options.tree_coordinates;
          branch_label
            .attr("y", (tree_coordinates[parent][1] + tree_coordinates[child][1]) / 2 - (5 * (trunc_labels.length)))
            .selectAll("tspan")
            .data(trunc_labels)
            .join("tspan")
            .attr("x", (tree_coordinates[parent][0] + tree_coordinates[child][0]) / 2)
            .attr("dy", 10)
            .attr("onclick", d => d === "..." ? "$(\"#tree\").tree(\"expand\", this)" : "")
            .attr("style", d => d === "..." ? "cursor: pointer;" : "")
            .text((d, i) => i ? d : "(" + d + ")")
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }

      });

      let tree_options = {"tree_coordinates": {"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [146.54095636175788, 284.60546060276613], "4": [359.9939460296807, 464.796083728305], "5": [260.49554077754567, 231.46756520781392], "6": [189.54484957770427, 402.75768616221666], "7": [-168.1153891597536, 521.4437692101992], "8": [357.78558465972174, 62.95626613327943], "9": [189.54484957770427, 571.9686073677489], "10": [452.3503620816996, 231.46756520781392], "null": [0.0, 0.0]}, "cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "child_dict": {"1": [2, 3], "2": [7], "3": [5, 6], "4": [], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, "patient": "patient1"};

      if (tree_options) {
        let tree_div = $("#tree");
        d3.select(tree_div[0].parentElement).append("button")
          .attr("onclick", "$(\"#tree\").tree(\"download\")")
          .attr("style", "font-size: 12px;")
          .html("Download as SVG");
        tree_div.tree(tree_options)
      } else {
        $("#tree").append("h3")
          .html("Run BuildTree to display tree")
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree_switch", {
        options: {
          patient: "",
          tree_iterations: [],
          child_dicts: [],
          tree_coordinates: [],
          cluster_dict: {}
        },

        _create: function() {
          let tree_iterations = this.options.tree_iterations,
            widg = this;

          let dropdown = d3.select(this.element.context).append("select")
            .attr("class", "form-control");

          dropdown.selectAll("option")
            .data(tree_iterations)
            .join("option")
            .html((d, i) => "Tree " + (i + 1) + " (" + d + ")");

          dropdown.on("change", function() {widg.switch_tree(this.selectedIndex)})
        },

        switch_tree: function(i) {
          let patient = this.options.patient,
            child_dicts = this.options.child_dicts,
            tree_coordinates = this.options.tree_coordinates,
            cluster_dict = this.options.cluster_dict,
            tree = $("#tree");

          tree.tree("destroy");

          tree.tree({
            patient: patient,
            child_dict: child_dicts[i],
            tree_coordinates: tree_coordinates[i],
            cluster_dict: cluster_dict
          })
        }
      });

      let tree_switch_options = {"tree_coordinates": [{"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [146.54095636175788, 284.60546060276613], "4": [359.9939460296807, 464.796083728305], "5": [260.49554077754567, 231.46756520781392], "6": [189.54484957770427, 402.75768616221666], "7": [-168.1153891597536, 521.4437692101992], "8": [357.78558465972174, 62.95626613327943], "9": [189.54484957770427, 571.9686073677489], "10": [452.3503620816996, 231.46756520781392], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [396.0740990136131, 634.3172773283394], "3": [1.0361180651756501e-14, 369.21092120553226], "4": [217.1688351484634, 586.3797563539956], "5": [137.19564514231664, 236.7614623209506], "6": [88.90805148123482, 458.11897268676705], "7": [574.6700813091402, 634.3172773283394], "8": [330.5389955584228, 236.7614623209506], "9": [-100.53632863051497, 489.0254520371806], "10": [738.7932045845083, 634.3172773283394], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [353.13831740574517, 246.94670513150587], "3": [-57.87354352298457, 359.0062540132244], "4": [175.20748879873443, 246.94670513150587], "5": [43.84331408432081, 606.4304401679922], "6": [-4.735648128032437, 472.96083842901226], "7": [-218.98345245051897, 452.02310330165244], "8": [143.12677869410743, 778.3944452236091], "9": [461.9437336406173, 338.2452897642775], "10": [480.14713721891286, 119.93788531833809], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [153.35717554021886, 271.5116253874245], "4": [285.0293786908816, 161.02552828740346], "5": [298.2547145189402, 485.8021093665844], "6": [249.675752306587, 352.3325076276045], "7": [-124.8957540302938, 535.0708678223094], "8": [450.36580723479364, 613.43847116243], "9": [418.8866735121192, 352.3325076276045], "10": [414.9477784995961, 31.10712847868885], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [163.44519888258816, 243.79500904733374], "4": [27.45721714613373, 515.5550826009492], "5": [289.1801710915158, 243.79500904733374], "6": [380.4787557242874, 134.98959281246158], "7": [71.8018270089772, 681.0514196509009], "8": [465.52961983462285, 326.02810750765696], "9": [471.1728256156855, -22.097144184642673], "10": [-200.41071759675395, 470.4357764906509], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [159.00625401322444, 257.87354352298456], "4": [350.13452378491684, 495.0240072672748], "5": [272.96083842901226, 204.73564812803235], "6": [221.87374011768824, 366.7632236000463], "7": [-230.4239946562414, 458.5449365437171], "8": [464.58481744114204, 238.52412577858345], "9": [370.0162356057591, 66.12617610649713], "10": [-6.22232941916036, 530.1523564521048], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [166.640227097546, 229.3831681086832], "4": [338.5260808928617, 229.3831681086832], "5": [-50.4263582790354, 485.9820889374224], "6": [3.119034052684839, 578.7254289671708], "7": [415.81054859734155, 63.646092268528434], "8": [-201.75221115852872, 591.9415918496572], "9": [119.71308284915627, 717.6768054954703], "10": [515.9979154505893, 276.93660285769613], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [319.4390399023365, 194.06638015470918], "3": [153.35717554021886, 271.5116253874245], "4": [479.6147478509282, 194.06638015470918], "5": [-71.01769173591734, 323.00625032287326], "6": [225.47579282451338, 374.5076849109871], "7": [650.949163543862, 194.06638015470918], "8": [-20.976750404298684, 509.76158583104746], "9": [334.2424763990748, 504.1307708155283], "10": [-226.71944029822646, 432.029788378635], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [342.31707909650186, 308.0902847204552], "3": [-43.79500904733371, 363.44519888258816], "4": [170.44909645197643, 262.0383975660884], "5": [445.21186774269376, 270.6396443921293], "6": [481.83907326214194, 170.00722428972156], "7": [403.4005025586066, 475.9156113855727], "8": [623.6519394004467, 318.45251749017586], "9": [572.53314315354, 12.92048729261731], "10": [-60.07260632246806, 549.4989871006596], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [353.13831740574517, 246.94670513150587], "3": [-57.87354352298457, 359.0062540132244], "4": [175.20748879873443, 246.94670513150587], "5": [462.6366643866295, 246.94670513150587], "6": [516.1820567183497, 154.20336510175747], "7": [-41.659638347424675, 544.3320382018865], "8": [604.1516975319038, 365.6919172497461], "9": [644.4428403855782, 25.942581434528904], "10": [17.36875151691204, 706.5112064609157], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [221.23422641242257, 794.7722578771486], "3": [1.0361180651756501e-14, 369.21092120553226], "4": [114.99848770518692, 643.0518993976339], "5": [139.87754684512487, 224.66418550410773], "6": [10.958524892225276, 494.4674338847789], "7": [367.5314904116042, 897.2107049488316], "8": [287.9871460453884, 348.94289556686357], "9": [282.25458053120843, 142.46276677902688], "10": [531.6546136869723, 897.2107049488316], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [326.450305143813, 113.7520874589876], "3": [1.0361180651756501e-14, 369.21092120553226], "4": [180.69790314834597, 215.80901804838564], "5": [132.145364152835, 600.9347548043554], "6": [72.11861728429453, 472.2069807290949], "7": [-142.51008102767156, 488.7910776348958], "8": [216.06337461879951, 780.8975090040099], "9": [468.48568861564775, 113.7520874589876], "10": [338.580799038458, 306.9627504909795], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [1.1603715355841732e-14, 389.50305286259993], "3": [45.75523107295134, 515.2145170574621], "4": [175.20748879873443, 246.94670513150587], "5": [243.59595515361977, 657.9176606423854], "6": [134.79053891874764, 566.6190760096138], "7": [356.5956285815306, 246.94670513150587], "8": [311.5098447450361, 844.509538762136], "9": [-50.16962621005775, 611.1393743404712], "10": [441.38106004960696, 657.9176606423854], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [146.54095636175788, 284.60546060276613], "4": [302.3224441378957, 211.96335985397369], "5": [-106.19990374495495, 469.20109359477783], "6": [209.4084424662217, 393.49514067982784], "7": [485.19307397333426, 211.96335985397369], "8": [-184.27218513182532, 636.6276413288911], "9": [339.0315283707629, 502.26182425438924], "10": [654.7274836897634, 211.96335985397369], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [166.640227097546, 229.3831681086832], "4": [298.31243024820867, 118.89707100866217], "5": [403.6010618362071, 353.5387552395527], "6": [280.59481151333387, 282.52106350363533], "7": [427.6214926847023, -10.411991427831467], "8": [602.1679910557802, 353.5387552395527], "9": [-89.44445443054606, 507.86933865008893], "10": [110.26434376124514, 486.87363166104694], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [319.4390399023365, 194.06638015470918], "3": [153.35717554021886, 271.5116253874245], "4": [479.6147478509282, 194.06638015470918], "5": [-48.57896221235323, 333.4696017389799], "6": [234.1780577803989, 367.8302021537926], "7": [650.949163543862, 194.06638015470918], "8": [-114.70628263273485, 515.152921403019], "9": [372.7875298019341, 464.88559933053943], "10": [820.4835732602912, 194.06638015470918], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [392.85054663562306, 444.1535486266635], "5": [272.3348789596498, 180.92752294286987], "6": [244.26608112276818, 340.1135858137019], "7": [-187.5631353516289, 500.8238944422978], "8": [354.5679774199729, 4.578074199762767], "9": [21.177844702494724, 480.5555449540211], "10": [464.18970026380373, 180.92752294286987], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [153.35717554021886, 271.5116253874245], "4": [-12.481895230910652, 521.8555154838486], "5": [249.675752306587, 352.3325076276045], "6": [320.6934440425044, 475.33875795047777], "7": [-207.01348581155457, 477.64386940446497], "8": [444.25584007093903, 352.3325076276045], "9": [281.4780943039721, 181.80039226669055], "10": [46.546494633426065, 684.0346837428779], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [159.00625401322444, 257.87354352298456], "4": [15.617158658255391, 521.7186269263442], "5": [393.5466424570241, 166.57495889021288], "6": [284.741226222152, 257.87354352298456], "7": [-191.24662369674695, 482.6151419336857], "8": [533.9546646275735, 26.166936719663454], "9": [423.35069824368725, 354.92894069973136], "10": [74.64554852259211, 683.8977951853734], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [284.9868516912954, 122.25335623862647], "5": [-56.02065123812482, 478.5814713159964], "6": [272.33487895964987, 306.66249515179754], "7": [414.29591412778893, -7.055706197867167], "8": [85.49438190714946, 597.3266834342367], "9": [-136.19004356873583, 593.0752291746852], "10": [461.27499443275235, 339.9777352478784], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [-23.54985615671218, 492.99335544811044], "4": [354.5150924095476, 60.801354374845516], "5": [128.7277740752605, 260.02674686854044], "6": [259.76356597824764, 224.91581224856242], "7": [-237.41676213183007, 445.11195520504594], "8": [253.00648413801636, 408.13634606880396], "9": [440.4614691265936, 240.72483029694806], "10": [21.98389912827765, 662.9276436311004], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [159.00625401322444, 257.87354352298456], "4": [290.6784571638872, 147.38744642296354], "5": [262.002313536787, 329.99216080727905], "6": [322.02906040532747, 458.7199348825395], "7": [-164.383110313796, 520.2742449022235], "8": [456.5824013011391, 329.99216080727905], "9": [21.177844702494724, 480.5555449540211], "10": [441.183197926636, 42.00289240458855], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [312.8741477818254, 308.7666835745614], "3": [129.6230859045412, 308.7666835745614], "4": [-116.59404879647141, 338.9513765282994], "5": [198.92715366859844, 567.4129856412195], "6": [162.16569134764782, 430.21734049890284], "7": [-233.18809759294282, 477.90275305659884], "8": [266.84104326001477, 754.0048637609701], "9": [394.34229686935464, 192.4181088422371], "10": [475.6629732911099, 384.67635957159854], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [475.2696667799661, 264.2793510286263], "3": [129.6230859045412, 308.7666835745614], "4": [295.6520712591836, 264.2793510286263], "5": [-91.29858463277164, 308.80541623487215], "6": [182.76098129949332, 422.72126799034925], "7": [653.8656490754931, 264.2793510286263], "8": [-215.57729469552748, 456.9150154351356], "9": [291.5276648740547, 552.3443538948904], "10": [817.9887723508613, 264.2793510286263], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-16.516279325188595, 388.7819365339218], "3": [166.640227097546, 229.3831681086832], "4": [307.4408756183376, 130.793492629609], "5": [-16.516279325188588, 489.67270730105656], "6": [65.52002117549104, 558.5093367943253], "7": [490.3115054537762, 130.793492629609], "8": [-135.26149144342878, 631.1877404463308], "9": [302.0924562400861, 307.5865490664636], "10": [191.3123675971266, 708.4228175631649], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [325.0881183753421, 180.42829829026925], "3": [159.00625401322444, 257.87354352298456], "4": [485.2638263239338, 180.42829829026925], "5": [-36.761462320950606, 337.1956451423166], "6": [9.636386362349874, 464.672686710957], "7": [656.5982420168676, 180.42829829026925], "8": [-184.87106152121407, 461.47435520507247], "9": [269.60253598714735, 368.46982549690745], "10": [92.34199857992277, 642.0354444765219], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [163.44519888258816, 243.79500904733374], "4": [177.8098930996161, 510.22450430568443], "5": [24.961708965413038, 469.2689568023612], "6": [266.4412584061507, 171.6763917630392], "7": [332.04898855402183, 322.4162473650779], "8": [24.96170896541305, 654.0037126203013], "9": [-148.76317187898007, 453.5137486493576], "10": [432.59240749407184, 75.74898111096216], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [164.1144578737169, 294.7515264312999], "3": [297.89380381529077, 294.7515264312999], "4": [-90.69406989139804, 357.08673699710425], "5": [472.78364720185164, 124.69658832597278], "6": [363.97823096697954, 215.99517295874446], "7": [-152.73246745748642, 527.5358334490807], "8": [635.4401532002524, 10.803276687039556], "9": [164.1144578737169, 428.5308723728738], "10": [442.0063389306242, 395.6602098695679], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [144.6034641921317, 659.7992480910555], "3": [-43.79500904733371, 363.44519888258816], "4": [54.79466643174045, 504.2458474033798], "5": [137.19564514231664, 236.7614623209506], "6": [233.12050242532575, 332.6863196039597], "7": [299.272121873894, 749.0972392388189], "8": [318.8789648063556, 170.63414190056886], "9": [-144.3313376778487, 483.2597297142365], "10": [448.01818653113617, 818.4586683089095], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [166.640227097546, 229.3831681086832], "4": [22.948170238408764, 503.41179080162976], "5": [275.5299071746077, 166.51568200421934], "6": [247.46110933772601, 325.7017448750513], "7": [-176.39773315320315, 511.05510054715796], "8": [372.8199510567837, -1.9956170703151486], "9": [444.7408283801399, 166.51568200421934], "10": [121.94027395695444, 644.7871664104794], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [312.05725039642107, 179.88609444878227], "3": [153.35717554021886, 271.5116253874245], "4": [287.51419039060175, 544.9567813629635], "5": [-81.4681490875292, 316.3485747323243], "6": [225.47579282451338, 374.5076849109871], "7": [490.6532326919481, 179.88609444878227], "8": [-31.427207755910544, 503.1039102404985], "9": [394.0428153886847, 389.25538842967075], "10": [-246.07943292514312, 411.3869437676206], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [159.00625401322444, 257.87354352298456], "4": [-211.9627860239693, 462.46638256775026], "5": [272.96083842901226, 204.73564812803235], "6": [231.12487129751895, 360.8696030465472], "7": [-7.954682364175014, 514.4510017346105], "8": [384.5673917537631, 45.344971457931905], "9": [442.1717596345445, 204.73564812803235], "10": [366.78671644501947, 496.5314481940477], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [487.50158899306757, 267.20773189846585], "3": [138.60947202153523, 297.05539717674685], "4": [307.88399347228506, 267.20773189846585], "5": [-91.29858463277164, 308.80541623487215], "6": [181.61336523748162, 415.2076227361974], "7": [666.0975712885946, 267.20773189846585], "8": [-108.14956794360808, 501.4130368306916], "9": [-245.78671782095364, 365.03449826272305], "10": [277.5407758895586, 581.3587718241185], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [153.35717554021886, 271.5116253874245], "4": [285.0293786908816, 161.02552828740346], "5": [234.1780577803989, 367.8302021537926], "6": [374.05560462552376, 392.49438765790035], "7": [-166.88429486247264, 522.0846363374858], "8": [234.1780577803989, 562.4102899181446], "9": [549.2630934242582, 439.4410927894062], "10": [425.7765343968024, 42.924641845314014], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [1.1603715355841732e-14, 389.50305286259993], "3": [23.230539632228176, 521.2499899387642], "4": [178.6324463625598, 231.49771992367698], "5": [249.482222206921, 580.2188774107091], "6": [107.44683873508627, 580.2188774107091], "7": [360.020586145356, 231.49771992367698], "8": [445.032473594183, 614.6996628146063], "9": [136.8300068437695, 746.8591045082551], "10": [-111.53883252347698, 634.3349204086101], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [324.38484835802683, 129.44078933427895], "3": [-29.383168108683204, 366.640227097546], "4": [178.6324463625598, 231.49771992367698], "5": [19.19579410367005, 625.8448010454536], "6": [-29.383168108683197, 492.37519930647363], "7": [470.6821123572083, 27.002342262595974], "8": [1.8895459024165149, 823.6561231503513], "9": [205.81986978224072, 658.7516608373639], "10": [336.5153422526718, 322.6514523662708], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-121.81021437785247, 345.1677605994766], "3": [129.6230859045412, 308.7666835745614], "4": [213.49513226371204, 603.0405554826642], "5": [255.35805811346881, 308.7666835745614], "6": [151.45673469762363, 432.5914590306878], "7": [-233.39408623033745, 478.14824075524746], "8": [380.4317276201137, 159.70968860107644], "9": [414.3643121266932, 366.64022709754596], "10": [293.1089929134273, 773.7730306144623], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [329.5270632447058, 166.34976381461843], "3": [163.44519888258816, 243.79500904733374], "4": [397.22024251102545, 21.18127240670151], "5": [-60.02674686854045, 328.7277740752605], "6": [252.35325036382295, 332.7030605285685], "7": [508.12304554023285, 166.34976381461843], "8": [-184.3054569312963, 476.837373275524], "9": [22.17467185654035, 471.1048077613441], "10": [409.5115194418198, 442.74646522897183], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [153.35717554021886, 271.5116253874245], "4": [482.37051121452816, 9.99529005562357], "5": [279.0921477491465, 271.5116253874245], "6": [360.5602968366757, 155.1630506551002], "7": [-6.723588066894109, 529.0774038130744], "8": [470.7161267612763, 305.3001030379756], "9": [206.85143866768274, 418.4859054004954], "10": [-223.25865434850337, 471.99764845906856], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [248.20982388021253, 656.623874560162], "3": [-29.383168108683204, 366.640227097546], "4": [63.69826981205322, 640.4812052896475], "5": [137.19564514231664, 236.7614623209506], "6": [-40.34169300090843, 491.8967397767927], "7": [96.29663140774537, 825.3557007566204], "8": [295.5732458853529, 125.86427239710883], "9": [-169.96477890544963, 600.6634233513541], "10": [315.8093532903084, 301.7715355187303], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [319.4390399023365, 194.06638015470918], "3": [153.35717554021886, 271.5116253874245], "4": [479.6147478509282, 194.06638015470918], "5": [-71.01769173591734, 323.00625032287326], "6": [234.1780577803989, 367.8302021537926], "7": [650.949163543862, 194.06638015470918], "8": [-37.44397127214175, 513.4122808060107], "9": [-213.39472542200096, 405.207669047954], "10": [381.1473775260305, 491.15210414672777], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [159.00625401322444, 257.87354352298456], "4": [436.7129705623887, 338.6944257631646], "5": [255.32483077959256, 177.0526612828045], "6": [255.32483077959256, 338.6944257631646], "7": [624.4394531185035, 338.6944257631646], "8": [305.68586329072673, -10.897270770376707], "9": [326.83645616701705, 492.05160130338345], "10": [429.20434930807215, 95.97131019667037], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-16.516279325188595, 388.7819365339218], "3": [168.5670225641713, 214.74770351868364], "4": [-149.02546900553006, 465.2861528659661], "5": [48.33505805565056, 466.06875084207604], "6": [271.5630820877339, 142.6290862343891], "7": [329.6769314917057, 307.7645528071117], "8": [96.14793115369716, 644.5088224998291], "9": [185.9826916016398, 490.33974246690553], "10": [445.4426006162135, 61.54773514825496], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [304.2458474033798, 145.20533356825953], "5": [-64.81386130071819, 478.9653911585218], "6": [272.33487895964987, 306.66249515179754], "7": [454.04469767349474, 40.31504939397733], "8": [-127.99686896280247, 652.5592780033268], "9": [425.69205449986873, 378.17412053922203], "10": [89.63751849769888, 568.137936861847], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [479.74693597126145, 238.2669728260179], "3": [138.60947202153523, 297.05539717674685], "4": [300.12934045047894, 238.2669728260179], "5": [-81.4681490875292, 316.3485747323243], "6": [191.74736741648735, 411.0099815925347], "7": [658.3429182667885, 238.2669728260179], "8": [-178.13982429558223, 483.7888278454689], "9": [176.99966389780374, 579.577004156706], "10": [365.62688594496694, 492.0913326786687], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [317.7063288694266, 166.24801258434235], "3": [159.00625401322444, 257.87354352298456], "4": [28.938667434964934, 482.8203917653467], "5": [-60.02674686854045, 328.7277740752605], "6": [239.82713625340446, 354.1921202893527], "7": [496.30231116495366, 166.24801258434235], "8": [-184.3054569312963, 476.837373275524], "9": [369.45022215794563, 462.9588038639141], "10": [660.4254344403219, 166.24801258434235], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [215.4335175107008, 748.4086976495502], "3": [-43.79500904733371, 363.44519888258816], "4": [84.46577461989486, 617.4409547587443], "5": [133.4696017389799, 248.57896221235325], "6": [-43.7950090473337, 489.1801710915158], "7": [383.25884417581835, 809.4921211116549], "8": [270.18399591553543, 385.2933563889088], "9": [-152.5616926218951, 618.8032569960569], "10": [312.0833098869716, 183.56888901457347], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [222.23362323331702, 405.3148774762775], "5": [289.1801710915158, 243.79500904733374], "6": [426.37581623383244, 280.55647136828435], "7": [-164.383110313796, 520.2742449022235], "8": [386.4702149736918, 75.28370997279924], "9": [607.0737193821784, 296.36548941667], "10": [35.43569468175815, 521.2458239445426], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [166.640227097546, 229.3831681086832], "4": [315.49774303546724, 143.44024121102524], "5": [-49.046999185910586, 483.93666368774257], "6": [26.677620852196476, 559.6612837258497], "7": [362.8281448267719, -33.199223016773146], "8": [-167.79221130415078, 625.4516968330169], "9": [286.45475792919433, 329.91949673919817], "10": [499.23010604676153, 143.44024121102524], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [153.35717554021886, 271.5116253874245], "4": [589.4577521385552, 368.69712374693495], "5": [421.1275312209812, 271.5116253874245], "6": [279.0921477491465, 271.5116253874245], "7": [231.97841385796303, 440.11541505885816], "8": [548.7638930168268, 119.40053267157103], "9": [-182.56837535798186, 457.73979847980513], "10": [-6.22232941916036, 530.1523564521048], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [33.98281317887651, 502.4803877656402], "4": [111.31568557314016, 636.4248518477455], "5": [137.19564514231664, 236.7614623209506], "6": [260.14375911753075, 179.42981521859457], "7": [-183.24340365280403, 473.4209197456955], "8": [285.3052443425801, 361.0401723837065], "9": [441.53189890032695, 179.42981521859457], "10": [203.18186707878732, 795.5417457128707], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [163.44519888258816, 243.79500904733374], "4": [304.2458474033798, 145.20533356825953], "5": [-49.046999185910586, 483.93666368774257], "6": [26.677620852196476, 559.6612837258497], "7": [332.04898855402183, 322.4162473650779], "8": [-190.56203233118487, 602.6818758059828], "9": [143.2716696486679, 698.6126602541491], "10": [463.3627412685049, 53.3391520626123], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [336.26146620576594, 322.7098274897511], "3": [-84.60546060276607, 346.54095636175794], "4": [164.39348356124052, 276.6579403353843], "5": [445.75981318665026, 322.7098274897511], "6": [507.1845638199437, 234.98619230818164], "7": [-52.30104786025598, 529.7483850417821], "8": [576.3870117463567, 453.33702604945756], "9": [623.7786126164151, 96.0348157798822], "10": [-260.1066675382044, 410.4181717640507], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [1.1603715355841732e-14, 389.50305286259993], "3": [166.640227097546, 229.3831681086832], "4": [2.0972779721073207e-14, 542.5114855266886], "5": [363.39289104239094, 106.37691778580995], "6": [292.3751993064736, 229.3831681086832], "7": [-29.751909056706236, 711.2429464589063], "8": [503.80091321294026, -34.03110438473948], "9": [455.82039818906173, 273.17817715601694], "10": [166.7066907223986, 587.1804086786202], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [353.13831740574517, 246.94670513150587], "3": [-29.383168108683204, 366.640227097546], "4": [175.20748879873443, 246.94670513150587], "5": [462.6366643866295, 246.94670513150587], "6": [559.6938764469706, 292.2052263944166], "7": [49.238070209060965, 535.2440167689797], "8": [568.5961672988642, 95.62085225201253], "9": [-149.19769894033155, 467.17655572806103], "10": [93.9069933609926, 701.9507074913782], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [163.44519888258816, 243.79500904733374], "4": [284.9868516912954, 122.25335623862647], "5": [277.399783298376, 296.93290444228586], "6": [368.6983679311477, 405.73832067715796], "7": [389.87713586557754, -27.54549403148856], "8": [465.3497153515572, 246.57187193115158], "9": [-115.9366721566975, 498.9022050076774], "10": [74.54095937305009, 506.6338514795685], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [153.35717554021886, 271.5116253874245], "4": [-147.08349250110743, 507.8953529661785], "5": [350.10983948506384, 148.50537506455123], "6": [279.0921477491465, 271.5116253874245], "7": [-205.68331391302434, 668.8970390794938], "8": [464.003151123997, -14.151130933849657], "9": [445.73237484669244, 300.8947934961077], "10": [232.28725689641587, 440.77773109217145], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [155.2318131514036, 308.6944857385739], "3": [289.01115909297744, 308.6944857385739], "4": [-104.03996281296159, 348.58446551285493], "5": [533.8556604691155, 308.6944857385739], "6": [391.8202769972808, 308.6944857385739], "7": [-194.73403270435963, 505.67120250995924], "8": [685.9667531849689, 436.3308475344196], "9": [178.46235278363176, 440.44142281473813], "10": [673.7108493587606, 168.83929684892874], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [309.11673596813034, 152.7650524938668], "3": [159.00625401322444, 257.87354352298456], "4": [299.8069025340161, 356.46321900205874], "5": [-48.57896221235323, 333.4696017389799], "6": [-126.38932871109522, 444.59432155803177], "7": [476.4463667618145, 403.7936207933635], "8": [62.318227711488504, 491.8472024820162], "9": [409.55091878949634, 52.330869672500754], "10": [645.9807764782437, 403.7936207933635], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [42.23969228194656, 703.2826066821003], "3": [-14.747703518683597, 368.56702256417134], "4": [57.894397230108765, 524.3485103403091], "5": [139.87754684512487, 224.66418550410773], "6": [257.3610238414604, 292.49330257327523], "7": [229.7365786449418, 586.8939493666811], "8": [315.10613089899755, 142.9537548321299], "9": [-142.86862228243686, 458.2782556849053], "10": [389.0468124247651, 644.8781324765268], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [65.19783490051184, 843.756338703434], "3": [-29.383168108683204, 366.640227097546], "4": [65.19783490051182, 658.5399804738638], "5": [133.4696017389799, 248.57896221235325], "6": [3.1594373344234192, 488.09088402188746], "7": [252.92431745662662, 658.5399804738638], "8": [291.84720248201614, 359.47615213619497], "9": [287.9577349271618, 192.34988018450227], "10": [422.4587271730558, 658.5399804738638], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-49.04699918591059, 383.0458929206078], "3": [159.00625401322444, 257.87354352298456], "4": [-49.046999185910586, 536.0543255846965], "5": [389.26232717243795, 199.11756433331954], "6": [280.45691093756585, 290.4161489660912], "7": [23.362053750595514, 691.3360407145767], "8": [587.8292563920111, 199.11756433331954], "9": [419.0663829591011, 387.47154614283806], "10": [108.12925860881012, 838.1571463446037], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [304.2458474033798, 145.20533356825953], "5": [-64.81386130071819, 478.9653911585218], "6": [244.26608112276818, 340.1135858137019], "7": [433.5549098398734, 15.8962711317659], "8": [-17.0009882026716, 657.4054628162748], "9": [315.7777065101927, 493.47076135392075], "10": [436.12090242692204, 340.1135858137019], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [409.1436952702601, 590.1081198229689], "3": [-14.747703518683597, 368.56702256417134], "4": [241.28066752023085, 511.8323044620453], "5": [139.87754684512487, 224.66418550410773], "6": [66.07317872149643, 464.88559933053943], "7": [571.0066247581559, 665.5860434145773], "8": [333.220897261231, 224.66418550410773], "9": [66.07317872149645, 634.0965205360717], "10": [-167.7362119482962, 475.6907294260459], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [153.35717554021886, 271.5116253874245], "4": [-59.47649529170263, 537.3079664424115], "5": [419.21733446818, 293.3452741805069], "6": [277.1819509963453, 293.3452741805069], "7": [71.77328176490633, 647.4396059627123], "8": [591.1813395237969, 392.6287387902935], "9": [541.0275488460325, 148.1775135810303], "10": [-181.51426286216957, 659.3457340128784], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [348.37992505898717, 262.0383975660884], "3": [-84.60546060276607, 346.54095636175794], "4": [170.44909645197643, 262.0383975660884], "5": [-94.05991005291224, 611.8606277739541], "6": [-106.43910939584848, 470.36573181788435], "7": [423.85784865059543, 100.17546807819252], "8": [-10.14189958694773, 791.8233819736085], "9": [485.5755702013038, 298.799859887039], "10": [261.6028288945703, 419.92129345620043], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-16.516279325188595, 388.7819365339218], "3": [166.640227097546, 229.3831681086832], "4": [408.969248102945, 90.43179158038376], "5": [-25.30948938778193, 489.28878745853115], "6": [292.3751993064736, 229.3831681086832], "7": [516.6447349761982, -63.34474037263945], "8": [80.65001352445285, 640.6146403380245], "9": [451.38145331969804, 287.25671163166777], "10": [-151.4185129127591, 615.3978109835083], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [295.0696351581917, 79.50609553442976], "3": [-14.747703518683597, 368.56702256417134], "4": [180.69790314834597, 215.80901804838564], "5": [147.5413278090257, 581.2341740628638], "6": [66.07317872149643, 464.88559933053943], "7": [-134.32785994804712, 511.07710359184296], "8": [164.84757601027928, 779.0454961677615], "9": [337.0443806716256, 581.2341740628638], "10": [360.23570799927967, 247.46637710077636], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [318.7406269590237, 221.92990615491627], "3": [146.54095636175788, 284.60546060276613], "4": [386.43380622534335, 76.76141474699935], "5": [-71.01769173591734, 323.00625032287326], "6": [209.4084424662217, 393.49514067982784], "7": [494.62333498048974, 252.9427730191699], "8": [-71.01769173591732, 516.3496007389795], "9": [318.1751260407831, 523.118226584369], "10": [-243.28571958382105, 403.3361509636093], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-220.80194240949865, 410.87406373168983], "3": [-43.79500904733371, 363.44519888258816], "4": [116.99001627404816, 603.864023135186], "5": [137.19564514231664, 236.7614623209506], "6": [-21.96136025425129, 487.2699743387146], "7": [260.79684506243166, 724.5322801322928], "8": [285.3052443425801, 361.0401723837065], "9": [-93.47298564167576, 640.6271498789334], "10": [309.4636729902203, 156.43156168021443], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-64.81386130071819, 378.07462039138704], "3": [163.44519888258816, 243.79500904733374], "4": [304.2458474033798, 145.20533356825953], "5": [-6.945292543394714, 460.71950151517757], "6": [259.7637756489563, 324.61589128751376], "7": [433.5549098398734, 15.8962711317659], "8": [25.133561156135954, 642.647721295502], "9": [-186.05912427223643, 434.6122150300227], "10": [445.0813024447127, 374.27157293576965], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-108.6944857385739, 355.2318131514036], "3": [146.54095636175788, 284.60546060276613], "4": [232.4838832594158, 433.46297654068746], "5": [260.49554077754567, 231.46756520781392], "6": [320.52228764608606, 102.73979113255336], "7": [232.4838832594158, 616.333606376126], "8": [455.07562854189774, 231.46756520781392], "9": [-165.2320803772095, 476.47707612292186], "10": [413.42493883219186, 465.3677665560376], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-121.81021437785247, 345.1677605994766], "3": [138.60947202153523, 297.05539717674685], "4": [183.09680456747034, 463.0843825313892], "5": [260.06012894587667, 264.51279173364026], "6": [351.3587135786483, 155.7073754987681], "7": [135.7664027761656, 639.7238467591876], "8": [448.0100609990579, 314.87382424477454], "9": [499.9431790915031, 51.66741268580641], "10": [342.21369843259555, 554.9505640370363], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [187.83289386792393, 778.8342664024267], "3": [-14.747703518683597, 368.56702256417134], "4": [155.6704107872537, 596.4317608332594], "5": [133.4696017389799, 248.57896221235325], "6": [7.085945274398821, 492.39179802029776], "7": [343.3968933433685, 596.4317608332594], "8": [326.81295215508607, 248.57896221235325], "9": [-89.96945190234797, 631.0012700418331], "10": [512.9313030597978, 596.4317608332594], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [-78.66209086486174, 512.3355398734329], "4": [92.4303106183323, 474.3861072176976], "5": [139.87754684512487, 224.66418550410773], "6": [251.00226666417666, 146.85381900536566], "7": [223.68008767494126, 584.5177467379984], "8": [315.1061308989976, 306.37461617608545], "9": [415.39575022541715, 70.19587866998124], "10": [-78.66209086486172, 688.2644606642251], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-80.08745079534782, 371.7480924765922], "3": [-114.71209336638574, 500.9690177456181], "4": [-25.99946664500189, 627.6637787706197], "5": [123.00625032287327, 271.01769173591737], "6": [234.1309701419251, 348.82805823465935], "7": [-257.8832969195413, 601.2185737280945], "8": [281.3838510659095, 160.1205018120756], "9": [412.7634165044849, 380.32577815833633], "10": [79.38508737337307, 778.1685195333686], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-94.75152643129991, 364.1144578737169], "3": [153.35717554021886, 271.5116253874245], "4": [324.6218524233938, 517.9246346141035], "5": [274.8078324645603, 238.96901994431786], "6": [196.36106875616525, 389.663850946875], "7": [-154.12406452740746, 527.2391656284817], "8": [372.09787634673637, 70.45772086978337], "9": [443.37485502873164, 253.7167234630015], "10": [-196.6022545727815, 685.7699290913843], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [356.56327496957056, 231.49771992367698], "3": [-29.383168108683204, 366.640227097546], "4": [178.6324463625598, 231.49771992367698], "5": [426.94745569004044, 147.61711968825682], "6": [436.28103256881207, 40.93384779205263], "7": [459.0017220412535, 377.7949839228586], "8": [611.6822115079806, 147.61711968825682], "9": [-119.09440122941706, 494.7611458612993], "10": [102.67926463308189, 498.7026598393111], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [163.44519888258816, 243.79500904733374], "4": [335.3310526779039, 243.79500904733374], "5": [-6.794406842303296, 484.0770767967563], "6": [68.93021319580376, 559.8016968348634], "7": [518.2016825133426, 243.79500904733374], "8": [-125.53961896054349, 625.5921099420306], "9": [207.8815897241032, 676.3957456313348], "10": [687.7360922297718, 243.79500904733374], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-133.99889373469716, 333.99889373469716], "3": [129.6230859045412, 308.7666835745614], "4": [129.6230859045412, 480.65253736987717], "5": [369.79643609299194, 412.06848145517307], "6": [253.44786136066762, 330.60033236764383], "7": [-149.128580560343, 506.9320054762287], "8": [549.7591902926464, 495.9864919211376], "9": [373.098051195922, 210.9501425323894], "10": [-306.1233634839224, 364.34908179162363], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [303.8236565293337, 126.00349701071404], "3": [163.44519888258816, 243.79500904733374], "4": [304.2458474033798, 342.3846845264079], "5": [-48.57896221235323, 333.4696017389799], "6": [-135.77839426843047, 437.3898381639847], "7": [351.5762491946846, 519.0241487542063], "8": [33.1314684596245, 508.69818579285266], "9": [420.17223126165794, 44.53534792318476], "10": [487.9782104146741, 342.3846845264079], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [-32.906859791910435, 386.62407567857065], "3": [159.00625401322444, 257.87354352298456], "4": [436.7129705623887, 338.6944257631646], "5": [247.9143054944592, 168.96549204174974], "6": [255.32483077959256, 338.6944257631646], "7": [-63.05108739090433, 557.5804856271632], "8": [359.52085881921005, 9.574815371649294], "9": [339.9302913823587, 485.23538212492247], "10": [625.0954136726275, 338.6944257631646], "null": [0.0, 0.0]}, {"1": [0.0, 200.0], "2": [296.65143831666376, 179.49696957364836], "3": [146.54095636175788, 284.60546060276613], "4": [-90.69406989139804, 357.08673699710425], "5": [335.8831906643587, 473.9476949053669], "6": [235.44900784299267, 373.5135120840009], "7": [-152.73246745748642, 527.5358334490807], "8": [419.80120113032325, 653.9104491050214], "9": [438.6868217884985, 179.49696957364836], "10": [533.6682955603459, 473.9476949053669], "null": [0.0, 0.0]}], "cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "child_dicts": [{"1": [2, 3], "2": [7], "3": [5, 6], "4": [], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [6, 9], "4": [2], "5": [8], "6": [4], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [9, 10], "3": [6, 7], "4": [2], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7], "3": [4, 6], "4": [10], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 10], "3": [5], "4": [7], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 10], "3": [5, 6], "4": [], "5": [8, 9], "6": [4], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4], "4": [7, 10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4], "3": [2, 6], "4": [7], "5": [8, 10], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [5, 7], "3": [10], "4": [2], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [5], "3": [7], "4": [2], "5": [6, 8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [6], "4": [2], "5": [8, 9], "6": [4], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [9], "3": [6, 7], "4": [2, 10], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 4], "2": [3], "3": [6, 9], "4": [7], "5": [8, 10], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 6], "4": [7], "5": [8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [9, 10], "3": [4, 6], "4": [7], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4], "3": [2, 6], "4": [7], "5": [8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 9], "3": [5, 6], "4": [], "5": [8, 10], "6": [4], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 7], "3": [5, 9], "4": [10], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 7], "3": [6], "4": [10], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 6], "4": [7], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 5], "2": [3, 7], "3": [10], "4": [], "5": [6, 8], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 9], "3": [4, 5], "4": [10], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [9, 10], "3": [2, 6], "4": [7], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [4, 6], "4": [2], "5": [8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 9], "4": [7], "5": [6, 8], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4], "3": [2, 9], "4": [7], "5": [6, 8], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5, 9], "3": [6, 7], "4": [], "5": [4, 8], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 4], "2": [3, 9], "3": [6, 10], "4": [7], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [4, 9], "4": [2], "5": [6, 8], "6": [], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 7], "3": [5, 6], "4": [10], "5": [8, 9], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [2, 6], "4": [], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 7], "3": [5, 6], "4": [], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [4, 6], "4": [2], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7], "3": [4, 5], "4": [10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 4], "2": [3], "3": [6, 10], "4": [7], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [7], "3": [6], "4": [2, 10], "5": [8, 9], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7], "3": [5, 6], "4": [10], "5": [8, 9], "6": [4], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4, 7], "3": [2, 6], "4": [], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 10], "3": [5, 9], "4": [], "5": [6, 8], "6": [4], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [], "3": [6], "4": [2, 7], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4], "3": [2, 6], "4": [7], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [], "3": [5, 6], "4": [7], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4, 5], "3": [6, 7], "4": [], "5": [8, 9], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 6], "4": [7], "5": [8, 10], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [4, 6], "4": [2], "5": [8], "6": [9, 10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [2, 6], "4": [], "5": [4, 8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [6], "4": [2], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 10], "3": [4, 5], "4": [], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 9], "4": [7, 10], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [9, 10], "3": [6, 7], "4": [], "5": [4, 8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 5], "2": [3, 7], "3": [4], "4": [10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 7], "4": [10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [5], "3": [7, 10], "4": [2], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4], "3": [6], "4": [7, 10], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [5], "3": [7, 9], "4": [2], "5": [6, 8], "6": [], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [9, 10], "3": [4, 5], "4": [7], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4], "3": [6, 10], "4": [7], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 4], "2": [3, 9], "3": [6], "4": [7], "5": [8, 10], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [9], "3": [2, 4], "4": [7], "5": [6, 8], "6": [], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [], "3": [4, 9], "4": [2, 7], "5": [6, 8], "6": [], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [], "3": [6], "4": [2, 7], "5": [8, 9], "6": [4], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4], "3": [6], "4": [7], "5": [8], "6": [5, 9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4, 6], "4": [7], "5": [8], "6": [9, 10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [7], "3": [6, 10], "4": [2], "5": [8], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [4], "3": [6], "4": [7, 10], "5": [8, 9], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [7, 9], "3": [6], "4": [2, 10], "5": [8], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [6], "4": [7], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [], "3": [6, 7], "4": [2, 10], "5": [8, 9], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [4, 7], "3": [2, 6], "4": [], "5": [8, 10], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [], "3": [2, 6], "4": [7], "5": [8, 10], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5, 9], "3": [4, 6], "4": [7], "5": [8], "6": [10], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [9], "3": [4, 5], "4": [7, 10], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [], "3": [4, 5], "4": [7, 10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [], "3": [6], "4": [2, 7], "5": [8], "6": [4, 9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 5], "2": [3, 4], "3": [10], "4": [7], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 5], "2": [3], "3": [4, 7], "4": [10], "5": [6, 8], "6": [9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7], "3": [5, 6], "4": [], "5": [8, 9], "6": [4], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [5, 7], "3": [9, 10], "4": [2], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [5], "3": [4], "4": [7], "5": [6, 8], "6": [9], "7": [10], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7, 10], "3": [4, 6], "4": [], "5": [8], "6": [5, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 5], "2": [9], "3": [2, 4], "4": [7, 10], "5": [6, 8], "6": [], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [2, 3], "2": [7], "3": [5, 6], "4": [10], "5": [8], "6": [4, 9], "7": [], "8": [], "9": [], "10": [], "null": [1]}, {"1": [3, 4], "2": [9], "3": [2, 6], "4": [7], "5": [8, 10], "6": [5], "7": [], "8": [], "9": [], "10": [], "null": [1]}], "patient": "patient1", "tree_iterations": ["12", "10", "8", "8", "8", "7", "6", "6", "6", "5", "5", "5", "5", "5", "5", "5", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "3", "3", "3", "3", "3", "3", "3", "3", "3", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1"]};

      if (tree_switch_options) {
        $("#tree-switch").tree_switch(tree_switch_options)
      }
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.treatment_plot", {

        options: {
          width: 500,
          height: 50,
          margins: {right: 50, left: 50},
          treatments: [],
          samples: [],
          treatment_color_map: {}
        },

        _elements: {
          treatment_plot: undefined,
          tooltip: undefined
        },

        _create: function() {
          const width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            treatments = this.options.treatments,
            samples = this.options.samples,
            treatment_color_map = this.options.treatment_color_map;

          let t = d3.scaleLinear()
            .domain([Math.min(...samples), Math.max(...samples)])
            .range([margins.left, width - margins.right]);

          let xAxis = g => g
            .attr("transform", "translate(0 " + height.toString() + ")")
            .call(d3.axisBottom(t));

          let treatment_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + (height * 2))
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("onclick", "$(\"#treatment-plot\").treatment_plot(\"toggle_tx\", event)")
            .style("max-height", "100px");
          treatment_plot.append("g")
            .call(xAxis);

          for (let tx in treatments) {
            let tx_start = Math.max(treatments[tx].tx_start, samples[0]),
              tx_end = Math.min(treatments[tx].tx_end, samples[samples.length - 1]);
            if (tx_end > samples[0] && tx_start < samples[samples.length - 1]) {
              let color = treatment_color_map[treatments[tx].tx];
              treatment_plot.append("line")
                .attr("stroke", color)
                .attr("stroke-width", 10)
                .attr("x1", t(tx_start))
                .attr("x2", t(tx_end))
                .attr("y1", 25)
                .attr("y2", 25)
                .attr("opacity", 1.0)
                .attr("tx", treatments[tx].tx)
                .attr("style", "cursor: pointer;")
            }
          }

          for (let s in samples) {
            treatment_plot.append("line")
              .attr("stroke", "black")
              .attr("stroke-width", 1)
              .attr("x1", t(samples[s]))
              .attr("x2", t(samples[s]))
              .attr("y1", 10)
              .attr("y2", 40)
              .attr("opacity", 1.0);
          }

          this._elements.tooltip = treatment_plot.append("g")
            .attr("style", "display: none;")
            .node();
          this._elements.treatment_plot = treatment_plot.node();

          this._refresh()
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.treatment_plot.outerHTML
        },

        toggle_tx: function(eve) {
          if (typeof eve.target.getAttribute("tx") === "string") {
            let tx_line = eve.target,
              tooltip = d3.select(this._elements.tooltip);
            let {x, width} = tx_line.getBBox(),
              tx_mid = x + (width / 2);
            tooltip.attr("style", "display: block;")
              .attr("transform", "translate(" + tx_mid.toString() + ",60)");

            let border = tooltip.selectAll("path")
              .data([null])
              .join("path")
                .attr("fill", "white")
                .attr("stroke", "black");

            tooltip.selectAll("text")
              .data([null])
              .join("text")
              .attr("id", "treatment-text")
              .attr("text-anchor", "middle")
              .call(t => t
                .selectAll("tspan")
                .data([tx_line.getAttribute("tx")])
                .join("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(d => d));

            this._refresh();

            let {width: w, height: h} = $("#treatment-text")[0].getBBox();

            border.attr("d", "M" + (-w / 2 - 10).toString() + " " + (-h / 2 - 15).toString() + " H " +
              (w / 2 + 10).toString() + " V " + (h / 2 + 5).toString() + " H " + (-w / 2 - 10).toString() + " Z");
          } else {
            this._elements.tooltip.setAttribute("style", "display: none;");
          }

          this._refresh();
        }

      });

      let treatment_data = false;

      if (treatment_data) {
        $("#treatment-plot").treatment_plot(treatment_data);
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_visual", {
        options: {
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}, drivers: []}},
          aliases: []
        },

        _elements: {
          mutation_visual: undefined
        },

        _create: function() {
          const cluster_dict = this.options.cluster_dict,
            aliases = this.options.aliases;
          let svg_visual = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "auto"),
            c_groups = [[], [], [], []],
            group_names = ["UNIVERSAL MUTATIONS", "OTHER COMMON MUTATIONS", "OTHER CLONAL", "SUBCLONAL"],
            group_min_lens = [200, 200, 150, 150];
          for (let c in cluster_dict) {
            let clonality = [];
            for (let s in cluster_dict[c].ccf_hat) {
              let cl = cluster_dict[c].ccf_hat[s];
              if (cl > 0.9) {
                clonality.push(1);
              } else if (cl > 0.1) {
                clonality.push(0.5);
              } else {
                clonality.push(0);
              }
            }
            if (clonality.every(v => v === 1)) {
              c_groups[0].push(c);
            } else if (clonality.reduce((p, a) => p + a) > 1) {
              c_groups[1].push(c);
            } else if (clonality.some(v => v === 1)) {
              c_groups[2].push(c);
            } else {
              c_groups[3].push(c);
            }
          }

          for (let a in aliases) {
            svg_visual.append("g")
              .attr("transform", "translate(15," + (a * 12 + 133).toString() + ")")
              .append("svg")
                .attr("width", "100px")
                .attr("height", "20px")
                .attr("x", 10)
                .attr("y", 10)
                .attr("stroke-width", 1)
                .attr("stroke", "black")
                .append("text")
                  .html(aliases[a])
                  .attr("font-size", "9px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("text-anchor", "start")
                  .attr("textLength", 50)
                  .attr("class", "samples");
          }

          let x_offset = 20,
            y_offset = 30,
            header_x_offset = 70;

          for (let g in c_groups) {
            if (c_groups[g].length) {
              let g_len = 0;
              for (let i in c_groups[g]) {
                let c = c_groups[g][i],
                  box_stroke = cluster_dict[c].color,
                  drivers = cluster_dict[c].drivers,
                  muts = cluster_dict[c].muts,
                  sorted_muts = Object.keys(muts).sort(function(a, b) {
                    if (drivers.includes(a) && drivers.includes(b)) {
                      return 0
                    }
                    if (drivers.includes(a)) {
                      return -1
                    }
                    if (drivers.includes(b)) {
                      return 1
                    }
                    return 0
                  }),
                  cnvs = cluster_dict[c].cnvs,
                  sorted_vars = [...sorted_muts, ...Object.keys(cnvs)];
                g_len += sorted_vars.length * 12;
                for (let ii in sorted_vars) {
                  let mut = sorted_vars[ii],
                    mut_group = svg_visual.append("g")
                    .attr("class", "mut_group"),
                    mut_suffix = mut.includes("_") ? mut.split("_")[1] : "p.A0A",
                    text_color = mut.startsWith("loss") || mut.startsWith("gain") ?
                      "black" : ((mut_suffix.length > 3 && mut_suffix[2] === mut_suffix[mut_suffix.length - 1]) ? "gray" : "black"),
                    text_weight = drivers.includes(mut) ? "bold" : "normal";
                  mut_group.append("g")
                    .attr("transform", "rotate(-75," + (x_offset + 53).toString() + ",145) " +
                      "translate(" + (x_offset + 53).toString() + ",145)")
                    .append("svg")
                      .attr("width", "100px")
                      .attr("height", "20px")
                      .attr("x", 10)
                      .attr("y", 10)
                      .append("text")
                        .html(mut)
                        .attr("font-size", "9px")
                        .attr("font-family", "Arial")
                        .attr("fill", text_color)
                        .attr("x", 10)
                        .attr("y", 10)
                        .attr("text-anchor", "start")
                        .attr("textLength", 70)
                        .attr("font-weight", text_weight)
                        .attr("class", "cluster_" + c.toString());
                  for (let a in aliases) {
                    let ccf_hat = cluster_dict[c].ccf_hat[a],
                      ccf_1d = mut in muts ? muts[mut].ccf_hat[a] : cnvs[mut].ccf_hat[a],
                      box_color = ccf_1d < 0.1 ? "white" : cluster_dict[c].color,
                      box_size = ccf_hat * 9 + 1,
                      a_box_stroke = ccf_hat > 0.9 ? "red" : box_stroke;
                    mut_group.append("rect")
                      .attr("x", x_offset + 75 - (box_size / 2.0))
                      .attr("y", y_offset + 120 + (a * 12) - (box_size / 2.0))
                      .attr("width", box_size.toString() + "px")
                      .attr("height", box_size.toString() + "px")
                      .attr("stroke-width", 1)
                      .attr("stroke", a_box_stroke)
                      .attr("fill", box_color)
                      .attr("opacity", 0.8)
                      .attr("class", "cluster_" + c.toString());
                  }
                  x_offset += 12;
                }
              }
              svg_visual.append("g")
                .attr("transform", "translate(" + (20 + header_x_offset).toString() + ",30)")
                .append("svg")
                  .attr("width", g_len)
                  .attr("height", "20px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("stroke-width", 1)
                  .attr("stroke", "black")
                  .append("text")
                    .html(group_names[g])
                    .attr("font-size", g_len > group_min_lens[g] ? "12px" : "8px")
                    .attr("x", 10)
                    .attr("y", 10)
                    .attr("text-anchor", "start");
              header_x_offset += g_len + 8;
              x_offset += 10;
            }
          }
          svg_visual
            .attr("width", x_offset + 110)
            .attr("height", y_offset + 160 + (aliases.length * 12));
          this._elements.mutation_visual = svg_visual.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_visual.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_visual.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".clonality_chart.svg");
          dl.click();
        }
      });

      $("#mutation-visual").mutation_visual({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "aliases": ["T0", "T1", "T2"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_table", {

        options: {
          aliases: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}}},
        },

        _elements: {
          cluster_table: undefined,
          column_data: undefined,
          table_data: undefined,
          cluster_datatable: undefined
        },

        _create: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            table_el = d3.select(document.createElement("table"))
              .attr("id", "cluster_table")
              .attr("class", "hover"),
            col_width = Math.round(82 / (aliases.length + 1.3)),
            cluster_col_width = 82 - (aliases.length * col_width),
            columns = [{"data": "Cluster", "width": cluster_col_width + "%"},
              {"data": "Chromosome", "width": "9%"},
              {"data": "Position", "width": "9%"}
            ],
            col_list = ["Cluster", "Chromosome", "Position"];
          for (let i in aliases) {
            columns.push({"data": aliases[i] + " CCF", "width": col_width + "%"});
            col_list.push(aliases[i] + " CCF");
          }
          table_el.append("thead")
            .selectAll("th")
            .data(col_list)
            .join("th")
            .text(d => d);
          let cluster_data = [];
          for (let c in cluster_dict) {
            let cluster_dat = {"Cluster": c, "Chromosome": null, "Position": null};
            for (let i in aliases) {
              cluster_dat[aliases[i] + " CCF"] = cluster_dict[c].ccf_hat[i] + " (" + cluster_dict[c].ccf_low[i] + "-" + cluster_dict[c].ccf_high[i] + ")";
            }
            cluster_data.push(cluster_dat);
          }
          this._elements.cluster_table = table_el.node();
          this._elements.column_data = columns;
          this._elements.table_data = {"columns": columns,
            "data": cluster_data,
            "order": [[0, "asc"]],
            "paging": false,
            "bInfo": false,
            "createdRow": function(row, data, dataIndex) {
              $(row).css("color", cluster_dict[dataIndex + 1].color)
                .css("cursor", "pointer")
                .attr("id", "mutation_row_cluster " + (dataIndex + 1).toString())
            }};

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.cluster_table.outerHTML;
          this._elements.cluster_datatable = $("#cluster_table").DataTable(this._elements.table_data);
          $("#cluster_table tbody").on("click", "tr", this.toggle_mutations(this));
          let search_input = $(".dataTables_filter input");
          search_input.unbind().bind("keyup", function(e) {
            if (search_input.val().length === 0) {
              for (let c in this.options.cluster_dict) {
                this.hide_mutations(c);
              }
            } else if (e.keyCode === 13) {
              for (let c in this.options.cluster_dict) {
                let cluster_table = this.show_mutations(c);
                cluster_table.search(search_input.val()).draw();
                if (cluster_table.page.info().recordsDisplay === 0) {
                  this.hide_mutations(c);
                }
              }
            }
          }
          .bind(this));
        },

        toggle_mutations: function(widg) {
          return function() {
            let row = widg._elements.cluster_datatable.row($(this));
            if (row.data()) {
              if (row.child.isShown()) {
                row.child.hide();
              } else {
                let c = row.data().Cluster,
                  cluster_muts = widg.options.cluster_dict[c].muts,
                  cluster_cnvs = widg.options.cluster_dict[c].cnvs,
                  drivers = widg.options.cluster_dict[c].drivers,
                  color = widg.options.cluster_dict[c].color,
                  aliases = widg.options.aliases,
                  mut_data = [];
                for (let mut in cluster_muts) {
                  let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                    "Cluster": mut,
                    "Chromosome": cluster_muts[mut].chrom,
                    "Position": cluster_muts[mut].pos
                  };
                  for (let i in aliases) {
                    mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                      (" (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
                  }
                  mut_data.push(mut_dat);
                }
                for (let cnv in cluster_cnvs) {
                  let cnv_dat = {"is_driver": 1,
                    "Cluster": cnv,
                    "Chromosome": cluster_cnvs[cnv].chrom,
                    "Position": null
                  };
                  for (let i in aliases) {
                    cnv_dat[aliases[i] + " CCF"] = cluster_cnvs[cnv].ccf_hat[i];
                  }
                  mut_data.push(cnv_dat);
                }
                row.child("<table id=\"cluster_" + row.data().Cluster + "_table\" class=\"hover\"></table>").show();
                $("#cluster_" + row.data().Cluster + "_table").DataTable({
                  "columns": [{"data": "is_driver", "visible": false}].concat(widg._elements.column_data),
                  "data": mut_data,
                  "autoWidth": false,
                  "order": [[0, "asc"]],
                  "paging": false,
                  "scrollY": 320,
                  "scrollCollapse": true,
                  "createdRow": function(row, data) {
                    $(row).css("color", color);
                    if (data.is_driver === 0) {
                      $(row).css("font-weight", "bold");
                    }
                  }
                });
              }
            }
          }
        },

        show_mutations: function(cluster) {
          let row = this._elements.cluster_datatable.row(cluster - 1),
            cluster_table;
          if (~row.child.isShown()) {
            let cluster_muts = this.options.cluster_dict[cluster].muts,
              drivers = this.options.cluster_dict[cluster].drivers,
              color = this.options.cluster_dict[cluster].color,
              aliases = this.options.aliases,
              mut_data = [];
            for (let mut in cluster_muts) {
              let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1,
                  "Cluster": mut,
                  "Chromosome": cluster_muts[mut].chrom,
                  "Position": cluster_muts[mut].pos
                },
                is_cnv = mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD";
              for (let i in aliases) {
                mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] +
                  (is_cnv ? "" : " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")");
              }
              mut_data.push(mut_dat);
            }
            row.child("<table id=\"cluster_" + cluster.toString() + "_table\" class=\"hover\"></table>").show();
            cluster_table = $("#cluster_" + cluster.toString() + "_table").DataTable({
              "columns": [{"data": "is_driver", "visible": false}].concat(this._elements.column_data),
              "data": mut_data,
              "autoWidth": false,
              "order": [[0, "asc"]],
              "paging": false,
              "scrollY": 320,
              "scrollCollapse": true,
              "createdRow": function(row, data) {
                $(row).css("color", color);
                if (data.is_driver === 0) {
                  $(row).css("font-weight", "bold");
                }
              }
            });
          } else {
            cluster_table = row.child.DataTable();
          }
          return cluster_table;
        },

        hide_mutations: function(cluster) {
          this._elements.cluster_datatable.row(cluster - 1).child.hide();
        },

        download_as_tsv: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            columns = ["Cluster", "Mutation", "Driver", "Chromosome", "Position", ...aliases.map(d => d + " CCF")],
            dl_link = "data:text/plain;charset=utf-8,";
          
          let is_driver = function(mut, drivers) {
            if (mut.startsWith("gain") || mut.startsWith("loss") || mut.startsWith("homdel") || mut === "WGD") {
              return null
            }
            return drivers.includes(mut)
          };

          dl_link += columns.join("\t") + "\n";
          for (let c in cluster_dict) {
            let cluster_row = [c, null, null, null, null, ...aliases.map(
              (_, i) => cluster_dict[c].ccf_hat[i]
                + " (" + cluster_dict[c].ccf_low[i]
                + "-" + cluster_dict[c].ccf_high[i] + ")")];
            dl_link += cluster_row.join("\t") + "\n";
            let cluster_muts = cluster_dict[c].muts,
              drivers = cluster_dict[c].drivers,
              mut_rows = Object.keys(cluster_muts).map(
                d => [c, d, is_driver(d, drivers), cluster_muts[d].chrom, cluster_muts[d].pos,
                  ...aliases.map((_, i) => cluster_muts[d].ccf_hat[i] + " ("
                    + cluster_muts[d].alt_cnt[i] + ":"
                    + cluster_muts[d].ref_cnt[i] + ")"
                  )
                ].join("\t")
              );
            dl_link += mut_rows.join("\n") + "\n"
          }

          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".cluster_table.tsv");
          dl.click();

        }

      });

      $("#cluster-table").cluster_table({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "aliases": ["T0", "T1", "T2"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_plot", {
        options: {
          xlabels: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          mutation_plot: undefined
        },

        _create: function() {
          const xlabels = this.options.xlabels,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          if (xlabels.length > 1) {
            let x = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x).tickValues([...Array(xlabels.length).keys()]).tickFormat(d => xlabels[d]));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let line = d3.line()
              .x(d => x(d.x))
              .y(d => y(d.y));

            let mutation_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            mutation_plot.append("g")
              .call(xAxis);
            mutation_plot.append("g")
              .call(yAxis);
            mutation_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            mutation_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            mutation_plot.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            for (let cluster in cluster_dict) {
              let muts = cluster_dict[cluster].muts,
                color = cluster_dict[cluster].color;
              for (let mut in muts) {
                let ccf_hat = muts[mut].ccf_hat,
                  mutation_data = [];
                for (let sample in ccf_hat) {
                  mutation_data.push({
                    x: sample,
                    y: ccf_hat[sample]
                  });
                }
                mutation_plot.append("path")
                  .datum(mutation_data)
                  .attr("fill", "none")
                  .attr("stroke", color)
                  .attr("stroke-width", 3)
                  .attr("opacity", 0.3)
                  .attr("d", line);
              }
            }

            this._elements.mutation_plot = mutation_plot.node();
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              for (let mut in cluster_dict[c].muts) {
                max_bin = Math.max(max_bin, ...cluster_dict[c].muts[mut].ccf_dist);
                n_bins = cluster_dict[c].muts[mut].ccf_dist.length
              }
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            for (let c in cluster_dict) {
              plot_1d.append("g")
                .selectAll("polygon")
                .data(Object.keys(cluster_dict[c].muts))
                .join("polygon")
                .attr("fill", cluster_dict[c].color)
                .attr("opacity", 0.05)
                .attr("stroke", "none")
                .attr("points", d =>
                  cluster_dict[c].muts[d].ccf_dist.reduce(
                    (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                  ) + zero_str
                );
            }

            plot_1d.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            this._elements.mutation_plot = plot_1d.node()
          }

          this._refresh();

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".mutation_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = ""
        }
      });

      $("#mutation-plot").mutation_plot({"cluster_dict": {"1": {"ccf_hat": [1.0, 1.0, 1.0], "tumor_abundance": [1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.99, 0.98, 0.99], "muts": {"CDC14A_None": {"ref_cnt": ["32", "60", "15"], "ccf_hat": [0.98, 0.98, 0.99], "alt_cnt": ["46", "32", "51"], "chrom": "1", "pos": "100817363"}, "BRD1_None": {"ref_cnt": ["37", "65", "10"], "ccf_hat": [0.98, 0.97, 0.99], "alt_cnt": ["42", "28", "56"], "chrom": "22", "pos": "50197948"}, "ERMAP_None": {"ref_cnt": ["35", "69", "7"], "ccf_hat": [0.98, 0.96, 0.99], "alt_cnt": ["44", "24", "59"], "chrom": "1", "pos": "43300797"}, "THSD4_None": {"ref_cnt": ["79", "89", "62"], "ccf_hat": [0.96, 0.97, 0.8], "alt_cnt": ["39", "30", "57"], "chrom": "15", "pos": "72057401"}}, "line_width": 2.0, "cnvs": {}}, "2": {"ccf_hat": [1.0, 1.0, 0.29], "tumor_abundance": [1.0, 1.0, 0.29], "ccf_high": [1.0, 1.0, 0.32], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [1.0, 1.0, 0.26], "muts": {"FAM47C_None": {"ref_cnt": ["111", "106", "139"], "ccf_hat": [0.86, 0.93, 0.23], "alt_cnt": ["41", "28", "14"], "chrom": "23", "pos": "37027734"}, "DUOX2_None": {"ref_cnt": ["82", "96", "107"], "ccf_hat": [0.96, 0.92, 0.17], "alt_cnt": ["39", "25", "12"], "chrom": "15", "pos": "45403721"}, "LRP8_None": {"ref_cnt": ["36", "66", "54"], "ccf_hat": [0.98, 0.97, 0.46], "alt_cnt": ["41", "27", "12"], "chrom": "1", "pos": "53741345"}, "SMAD7_None": {"ref_cnt": ["126", "121", "119"], "ccf_hat": [0.73, 0.86, 0.28], "alt_cnt": ["36", "26", "15"], "chrom": "18", "pos": "46476739"}, "TMEM202_None": {"ref_cnt": ["87", "100", "100"], "ccf_hat": [0.86, 0.83, 0.3], "alt_cnt": ["33", "21", "20"], "chrom": "15", "pos": "72699532"}, "BCORL1_None": {"ref_cnt": ["112", "101", "122"], "ccf_hat": [0.83, 0.97, 0.17], "alt_cnt": ["39", "32", "10"], "chrom": "23", "pos": "129147973"}, "CACNB4_None": {"ref_cnt": ["72", "93", "80"], "ccf_hat": [0.96, 0.95, 0.42], "alt_cnt": ["48", "27", "19"], "chrom": "2", "pos": "152726982"}, "HSPA1L_None": {"ref_cnt": ["58", "78", "100"], "ccf_hat": [0.98, 0.98, 0.37], "alt_cnt": ["41", "35", "17"], "chrom": "6", "pos": "31779368"}, "SLCO3A1_None": {"ref_cnt": ["82", "86", "107"], "ccf_hat": [0.95, 0.98, 0.22], "alt_cnt": ["38", "34", "15"], "chrom": "15", "pos": "92397224"}, "TOX2_None": {"ref_cnt": ["95", "101", "106"], "ccf_hat": [0.71, 0.75, 0.3], "alt_cnt": ["26", "19", "14"], "chrom": "20", "pos": "42680096"}, "MYOM3_None": {"ref_cnt": ["32", "71", "53"], "ccf_hat": [0.98, 0.96, 0.5], "alt_cnt": ["45", "23", "13"], "chrom": "1", "pos": "24418752"}, "ROR1_None": {"ref_cnt": ["28", "67", "55"], "ccf_hat": [0.99, 0.97, 0.43], "alt_cnt": ["50", "26", "11"], "chrom": "1", "pos": "64644361"}}, "line_width": 6.0, "cnvs": {}}, "3": {"ccf_hat": [0.68, 0.99, 0.56], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.69, 1.0, 0.62], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.65, 0.98, 0.51], "muts": {"NLK_None": {"ref_cnt": ["79", "85", "71"], "ccf_hat": [0.68, 0.98, 0.63], "alt_cnt": ["41", "34", "50"], "chrom": "17", "pos": "26499632"}, "KCNN1_None": {"ref_cnt": ["100", "110", "124"], "ccf_hat": [0.67, 0.94, 0.43], "alt_cnt": ["40", "30", "48"], "chrom": "19", "pos": "18109140"}, "ABCC3_None": {"ref_cnt": ["83", "86", "65"], "ccf_hat": [0.68, 0.98, 0.69], "alt_cnt": ["37", "35", "55"], "chrom": "17", "pos": "48746801"}}, "line_width": 2.0, "cnvs": {}}, "4": {"ccf_hat": [1.0, 0.47, 0.49], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [1.0, 0.54, 0.57], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.99, 0.4, 0.41], "muts": {"OR52K2_None": {"ref_cnt": ["44", "85", "54"], "ccf_hat": [0.98, 0.45, 0.46], "alt_cnt": ["34", "8", "12"], "chrom": "11", "pos": "4470854"}, "TMEM132A_None": {"ref_cnt": ["44", "83", "54"], "ccf_hat": [0.98, 0.51, 0.46], "alt_cnt": ["34", "10", "12"], "chrom": "11", "pos": "60695200"}, "CYFIP2_None": {"ref_cnt": ["45", "84", "55"], "ccf_hat": [0.98, 0.48, 0.43], "alt_cnt": ["33", "9", "11"], "chrom": "5", "pos": "156769923"}, "UBR4_None": {"ref_cnt": ["44", "86", "55"], "ccf_hat": [0.98, 0.41, 0.43], "alt_cnt": ["34", "7", "11"], "chrom": "1", "pos": "19449328"}, "ZMYM1_None": {"ref_cnt": ["38", "79", "48"], "ccf_hat": [0.98, 0.67, 0.68], "alt_cnt": ["40", "14", "18"], "chrom": "1", "pos": "35578593"}, "MADD_None": {"ref_cnt": ["47", "82", "51"], "ccf_hat": [0.97, 0.54, 0.6], "alt_cnt": ["32", "11", "16"], "chrom": "11", "pos": "47306709"}}, "line_width": 3.0, "cnvs": {}}, "5": {"ccf_hat": [0.38, 0.64, 0.95], "tumor_abundance": [0.0, 0.0, 0.56], "ccf_high": [0.55, 1.0, 1.0], "color": "rgb(93,119,254)", "drivers": [], "ccf_low": [0.22, 0.44, 0.85], "muts": {"GPR125_None": {"ref_cnt": ["104", "103", "71"], "ccf_hat": [0.38, 0.64, 0.95], "alt_cnt": ["16", "17", "50"], "chrom": "4", "pos": "22389781"}}, "line_width": 1.0, "cnvs": {}}, "6": {"ccf_hat": [0.27, 0.53, 0.53], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.42, 0.81, 0.71], "color": "rgb(152,22,26)", "drivers": [], "ccf_low": [0.13, 0.3, 0.33], "muts": {"TMC7_None": {"ref_cnt": ["71", "83", "52"], "ccf_hat": [0.27, 0.53, 0.53], "alt_cnt": ["7", "11", "14"], "chrom": "16", "pos": "19067879"}}, "line_width": 1.0, "cnvs": {}}, "7": {"ccf_hat": [0.69, 0.42, 0.09], "tumor_abundance": [0.69, 0.43, 0.09], "ccf_high": [0.69, 0.43, 0.09], "color": "rgb(104,236,172)", "drivers": [], "ccf_low": [0.68, 0.4, 0.08], "muts": {"ABCF1_None": {"ref_cnt": ["75", "103", "116"], "ccf_hat": [0.79, 0.4, 0.06], "alt_cnt": ["25", "8", "2"], "chrom": "6", "pos": "30558048"}, "HINFP_None": {"ref_cnt": ["56", "88", "64"], "ccf_hat": [0.87, 0.33, 0.08], "alt_cnt": ["22", "5", "2"], "chrom": "11", "pos": "119003239"}, "HDAC9_None": {"ref_cnt": ["88", "102", "109"], "ccf_hat": [0.88, 0.86, 0.1], "alt_cnt": ["33", "19", "10"], "chrom": "7", "pos": "18674257"}, "MCM4_None": {"ref_cnt": ["87", "110", "71"], "ccf_hat": [0.86, 0.46, 0.24], "alt_cnt": ["33", "11", "8"], "chrom": "8", "pos": "48887367"}, "NUP160_None": {"ref_cnt": ["57", "83", "65"], "ccf_hat": [0.88, 0.51, 0.03], "alt_cnt": ["23", "10", "0"], "chrom": "11", "pos": "47827794"}, "DRD1_None": {"ref_cnt": ["56", "89", "64"], "ccf_hat": [0.87, 0.28, 0.08], "alt_cnt": ["22", "4", "2"], "chrom": "5", "pos": "174869713"}, "LINGO1_None": {"ref_cnt": ["82", "109", "107"], "ccf_hat": [0.95, 0.47, 0.19], "alt_cnt": ["38", "11", "13"], "chrom": "15", "pos": "77907391"}, "FKBP4_None": {"ref_cnt": ["96", "115", "121"], "ccf_hat": [0.76, 0.32, 0.02], "alt_cnt": ["25", "6", "0"], "chrom": "12", "pos": "2904384"}, "SKIV2L2_None": {"ref_cnt": ["62", "83", "63"], "ccf_hat": [0.68, 0.49, 0.11], "alt_cnt": ["16", "9", "3"], "chrom": "5", "pos": "54683858"}, "HMCN1_None": {"ref_cnt": ["45", "89", "64"], "ccf_hat": [0.84, 0.22, 0.05], "alt_cnt": ["33", "4", "2"], "chrom": "1", "pos": "186023017"}, "IGSF1_None": {"ref_cnt": ["116", "120", "123"], "ccf_hat": [0.77, 0.5, 0.14], "alt_cnt": ["36", "14", "9"], "chrom": "23", "pos": "130419189"}, "GYG2_None": {"ref_cnt": ["119", "118", "142"], "ccf_hat": [0.73, 0.51, 0.18], "alt_cnt": ["34", "14", "12"], "chrom": "23", "pos": "2772140"}, "ZNF534_None": {"ref_cnt": ["96", "117", "163"], "ccf_hat": [0.67, 0.85, 0.07], "alt_cnt": ["45", "24", "9"], "chrom": "19", "pos": "52941821"}, "ZNF551_None": {"ref_cnt": ["104", "133", "163"], "ccf_hat": [0.67, 0.42, 0.08], "alt_cnt": ["41", "13", "11"], "chrom": "19", "pos": "58220320"}, "RNF31_None": {"ref_cnt": ["100", "114", "120"], "ccf_hat": [0.58, 0.38, 0.02], "alt_cnt": ["20", "8", "0"], "chrom": "14", "pos": "24619359"}}, "line_width": 7.0, "cnvs": {}}, "8": {"ccf_hat": [0.01, 0.01, 0.76], "tumor_abundance": [0.0, 0.0, 0.47], "ccf_high": [0.01, 0.01, 0.79], "color": "rgb(249,142,135)", "drivers": [], "ccf_low": [0.01, 0.01, 0.74], "muts": {"ZNF225_None": {"ref_cnt": ["141", "140", "132"], "ccf_hat": [0.01, 0.03, 0.35], "alt_cnt": ["0", "0", "39"], "chrom": "19", "pos": "44636203"}, "MORC2_None": {"ref_cnt": ["79", "92", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "31336780"}, "ATG2B_None": {"ref_cnt": ["162", "146", "131"], "ccf_hat": [0.02, 0.03, 0.63], "alt_cnt": ["0", "0", "45"], "chrom": "14", "pos": "96775791"}, "ADRA2C_None": {"ref_cnt": ["120", "120", "75"], "ccf_hat": [0.01, 0.04, 0.89], "alt_cnt": ["0", "0", "45"], "chrom": "4", "pos": "3768770"}, "GLB1_None": {"ref_cnt": ["78", "93", "19"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "47"], "chrom": "3", "pos": "33134929"}, "C6orf222_None": {"ref_cnt": ["99", "113", "79"], "ccf_hat": [0.03, 0.04, 0.8], "alt_cnt": ["0", "0", "39"], "chrom": "6", "pos": "36284351"}, "RYR3_None": {"ref_cnt": ["121", "121", "90"], "ccf_hat": [0.02, 0.04, 0.44], "alt_cnt": ["0", "0", "30"], "chrom": "15", "pos": "33991950"}, "TEX14_None": {"ref_cnt": ["121", "120", "81"], "ccf_hat": [0.02, 0.04, 0.5], "alt_cnt": ["0", "0", "39"], "chrom": "17", "pos": "56688648"}, "TTN-AS1_None": {"ref_cnt": ["120", "120", "57"], "ccf_hat": [0.02, 0.04, 0.89], "alt_cnt": ["0", "0", "43"], "chrom": "2", "pos": "179432602"}, "KIAA1549L_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.71], "alt_cnt": ["0", "0", "19"], "chrom": "11", "pos": "33564907"}, "PTPRF_None": {"ref_cnt": ["78", "93", "27"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "1", "pos": "44019566"}, "SOHLH2_None": {"ref_cnt": ["121", "122", "125"], "ccf_hat": [0.03, 0.04, 0.73], "alt_cnt": ["0", "0", "35"], "chrom": "13", "pos": "36857787"}, "M6PR_None": {"ref_cnt": ["120", "120", "76"], "ccf_hat": [0.03, 0.04, 0.92], "alt_cnt": ["0", "0", "43"], "chrom": "12", "pos": "9095049"}, "XPNPEP3_None": {"ref_cnt": ["78", "94", "29"], "ccf_hat": [0.04, 0.05, 0.98], "alt_cnt": ["0", "0", "37"], "chrom": "22", "pos": "41282441"}, "XPNPEP2_None": {"ref_cnt": ["149", "133", "109"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "128881715"}, "CCDC88B_None": {"ref_cnt": ["78", "93", "47"], "ccf_hat": [0.04, 0.05, 0.69], "alt_cnt": ["0", "0", "18"], "chrom": "11", "pos": "64120619"}, "CCDC78_None": {"ref_cnt": ["78", "92", "22"], "ccf_hat": [0.01, 0.05, 0.98], "alt_cnt": ["0", "0", "43"], "chrom": "16", "pos": "775566"}, "SGOL1_None": {"ref_cnt": ["78", "94", "52"], "ccf_hat": [0.04, 0.05, 0.53], "alt_cnt": ["0", "0", "14"], "chrom": "3", "pos": "20225168"}, "PRDM14_None": {"ref_cnt": ["119", "124", "53"], "ccf_hat": [0.02, 0.04, 0.82], "alt_cnt": ["0", "0", "27"], "chrom": "8", "pos": "70980717"}, "PRRC2A_None": {"ref_cnt": ["99", "113", "101"], "ccf_hat": [0.03, 0.04, 0.36], "alt_cnt": ["0", "0", "17"], "chrom": "6", "pos": "31599358"}, "MSRA_None": {"ref_cnt": ["120", "120", "42"], "ccf_hat": [0.02, 0.04, 0.96], "alt_cnt": ["0", "0", "37"], "chrom": "8", "pos": "10285712"}, "MYH15_None": {"ref_cnt": ["78", "93", "48"], "ccf_hat": [0.04, 0.05, 0.68], "alt_cnt": ["0", "0", "18"], "chrom": "3", "pos": "108117664"}, "AF001550.7_None": {"ref_cnt": ["78", "92", "27"], "ccf_hat": [0.03, 0.05, 0.98], "alt_cnt": ["0", "0", "39"], "chrom": "16", "pos": "21215504"}, "C2orf53_None": {"ref_cnt": ["121", "120", "39"], "ccf_hat": [0.02, 0.04, 0.99], "alt_cnt": ["0", "0", "61"], "chrom": "2", "pos": "27360304"}, "SLC25A14_None": {"ref_cnt": ["149", "133", "110"], "ccf_hat": [0.02, 0.04, 0.43], "alt_cnt": ["0", "0", "23"], "chrom": "23", "pos": "129484687"}}, "line_width": 11.0, "cnvs": {}}, "9": {"ccf_hat": [0.21, 0.54, 0.02], "tumor_abundance": [0.0, 0.0, 0.0], "ccf_high": [0.26, 0.65, 0.03], "color": "rgb(55,18,48)", "drivers": [], "ccf_low": [0.16, 0.45, 0.01], "muts": {"10:6296308:T:G": {"ref_cnt": ["111", "108", "118"], "ccf_hat": [0.19, 0.5, 0.04], "alt_cnt": ["8", "12", "1"], "chrom": "10", "pos": "6296308"}, "EXOC6_None": {"ref_cnt": ["113", "105", "121"], "ccf_hat": [0.19, 0.61, 0.01], "alt_cnt": ["8", "16", "0"], "chrom": "10", "pos": "94715387"}, "FAM21D_None": {"ref_cnt": ["105", "105", "119"], "ccf_hat": [0.3, 0.59, 0.04], "alt_cnt": ["14", "15", "1"], "chrom": "10", "pos": "51187973"}}, "line_width": 2.0, "cnvs": {}}, "10": {"ccf_hat": [0.28, 0.27, 0.09], "tumor_abundance": [0.0, 0.0, 0.09], "ccf_high": [0.29, 0.31, 0.09], "color": "rgb(83,82,22)", "drivers": ["DIAPH1_None"], "ccf_low": [0.27, 0.24, 0.09], "muts": {"SNRK_None": {"ref_cnt": ["72", "88", "56"], "ccf_hat": [0.25, 0.33, 0.39], "alt_cnt": ["6", "5", "10"], "chrom": "3", "pos": "43344816"}, "BCL2L10_None": {"ref_cnt": ["115", "111", "104"], "ccf_hat": [0.17, 0.38, 0.24], "alt_cnt": ["5", "8", "16"], "chrom": "15", "pos": "52404858"}, "LIPG_None": {"ref_cnt": ["162", "143", "124"], "ccf_hat": [0.04, 0.22, 0.14], "alt_cnt": ["1", "5", "9"], "chrom": "18", "pos": "47109932"}, "SH2D4B_None": {"ref_cnt": ["101", "114", "118"], "ccf_hat": [0.35, 0.24, 0.03], "alt_cnt": ["19", "5", "1"], "chrom": "10", "pos": "82298169"}, "PIK3C2A_None": {"ref_cnt": ["75", "86", "59"], "ccf_hat": [0.17, 0.41, 0.26], "alt_cnt": ["3", "7", "7"], "chrom": "11", "pos": "17190693"}, "DNAJC1_None": {"ref_cnt": ["98", "112", "118"], "ccf_hat": [0.55, 0.33, 0.03], "alt_cnt": ["23", "8", "1"], "chrom": "10", "pos": "22048486"}, "BZRAP1_None": {"ref_cnt": ["103", "116", "115"], "ccf_hat": [0.31, 0.16, 0.06], "alt_cnt": ["17", "4", "5"], "chrom": "17", "pos": "56389788"}, "LRRK2_None": {"ref_cnt": ["112", "114", "107"], "ccf_hat": [0.29, 0.3, 0.27], "alt_cnt": ["9", "5", "12"], "chrom": "12", "pos": "40645067"}, "FMN1_None": {"ref_cnt": ["102", "115", "116"], "ccf_hat": [0.51, 0.27, 0.07], "alt_cnt": ["18", "5", "4"], "chrom": "15", "pos": "33446826"}, "NRIP1_None": {"ref_cnt": ["141", "140", "130"], "ccf_hat": [0.41, 0.29, 0.07], "alt_cnt": ["21", "7", "4"], "chrom": "21", "pos": "16340166"}, "THOC2_None": {"ref_cnt": ["134", "127", "129"], "ccf_hat": [0.38, 0.32, 0.07], "alt_cnt": ["19", "7", "4"], "chrom": "23", "pos": "122774438"}, "DIAPH1_None": {"ref_cnt": ["74", "89", "56"], "ccf_hat": [0.2, 0.28, 0.39], "alt_cnt": ["4", "4", "10"], "chrom": "5", "pos": "140953446"}, "DCHS2_None": {"ref_cnt": ["115", "116", "110"], "ccf_hat": [0.13, 0.22, 0.2], "alt_cnt": ["5", "4", "10"], "chrom": "4", "pos": "155156789"}, "ABCA13_None": {"ref_cnt": ["113", "112", "107"], "ccf_hat": [0.2, 0.41, 0.27], "alt_cnt": ["6", "8", "16"], "chrom": "7", "pos": "48377998"}, "SLC9A6_None": {"ref_cnt": ["126", "127", "130"], "ccf_hat": [0.56, 0.32, 0.05], "alt_cnt": ["24", "7", "2"], "chrom": "23", "pos": "135077116"}, "ATP10A_None": {"ref_cnt": ["114", "114", "111"], "ccf_hat": [0.19, 0.31, 0.08], "alt_cnt": ["6", "6", "9"], "chrom": "15", "pos": "25924935"}}, "line_width": 7.0, "cnvs": {}}}, "xlabels": ["T0", "T1", "T2"]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.fish_plot", {
        options: {
          xlabels: [],
          time_points: [],
          tumor_sizes: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          child_dict: {},
          timed: true,
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          fish_plot: undefined
        },

        _create: function() {
          let xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tumor_sizes = Object.assign(...this.options.tumor_sizes.map(t => ({[t[0]]: t[1]}))),
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            timed = this.options.timed,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          let x = d3.scaleLinear()
            .domain([Math.min(...time_points), Math.max(...time_points)])
            .range([margins.left, width - margins.right]);

          let y = d3.scaleLinear()
            .domain([0, Math.max(...Object.values(tumor_sizes))]).nice()
            .range([height - margins.bottom, margins.top]);

          let xAxis = timed ?
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)) :
            g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x)).tickValues(time_points).tickFormat(d => xlabels[d]);

          let yAxis = g => g
            .attr("transform", "translate(" + margins.left.toString() + " 0)")
            .call(d3.axisLeft(y));

          let interp1d = function(u, population) {
            let p0, p1, t0, t1;
            if (u < time_points[0]) {
              p0 = population[0];
              p1 = population[1];
              t0 = time_points[0];
              t1 = time_points[1];
            } else {
              let n;
              for (n in time_points) {
                n = parseInt(n);
                if (time_points[n] > u) {
                  break;
                }
              }
              p0 = population[n - 1];
              p1 = population[n];
              t0 = time_points[n - 1];
              t1 = time_points[n];
            }
            let m = (p1 - p0) / (t1 - t0),
              dx = u - t0;
            return p0 + (m * dx)
          };

          let h = [],
            tumor_size_t = Object.keys(tumor_sizes).sort((a, b) => a - b);
          for (let i in tumor_size_t) {
            h.push(tumor_size_t[i] - tumor_size_t[i - 1]);
          }

          let pchip = function(u, population) {
            if (u < tumor_size_t[0] || u > tumor_size_t[tumor_size_t.length - 1]) {
              console.log(u, tumor_size_t[tumor_size_t.length - 1]);
              throw "Input outside interpolation range";
            }
            let n;
            for (n in tumor_size_t) {
              n = parseInt(n);
              if (tumor_size_t[n] > u) {
                break;
              }
            }
            let p0 = population[n - 1],
              p1 = population[n],
              d0 = (p0 - population[n - 2]) / h[n - 1],
              d1 = (p1 - p0) / h[n],
              d2 = (population[n + 1] - p1) / h[n + 1],
              fp0 = n === 1 ? d1 : (h[n - 1] * d0 + h[n] * d1) / (h[n - 1] + h[n]),
              fp1 = n === (tumor_size_t.length - 1) ? d1 : (h[n] * d1 + h[n + 1] * d2) / (h[n] + h[n + 1]);
            let v = (u - tumor_size_t[n - 1]) / (tumor_size_t[n] - tumor_size_t[n - 1]);
            return Math.max(0, (p0 * ((2 * v * v * v) - (3 * v * v) + 1)) +
              (p1 * ((-2 * v * v * v) + (3 * v * v))) +
              (fp0 * ((v * v * v) - (2 * v * v) + v)) +
              (fp1 * ((v * v * v) - (v * v))))
          };

          let getOrder = function(cluster, level) {
            cluster = cluster || child_dict[null][0];
            level = level || 1;
            let order = [cluster],
              breaks = {},
              children = child_dict[cluster];
            for (let i in children) {
              let {order: child_order, breaks: child_breaks, level: child_level} = getOrder(children[i], level + 1);
              order = [...order, ...child_order];
              breaks[children[i]] = children.length > 1 ? child_level : false;
              breaks = Object.assign({}, breaks, child_breaks);
            }
            return {order: order, breaks: breaks, level: level}
          };

          let {order, breaks} = getOrder(),
            max_break = Math.max(...Object.values(breaks));

          let fish_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + height)
            .style("max-width", "500px")
            .style("min-width", "300px")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          fish_plot.append("g")
            .call(xAxis);
          fish_plot.append("g")
            .call(yAxis);
          fish_plot.append("text")
            .attr("x", (width + margins.left - margins.right) / 2)
            .attr("y", height - 5)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Time");
          fish_plot.append("text")
            .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
            .attr("x", 10)
            .attr("y", (height + margins.top - margins.bottom) / 2)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Relative size");
          fish_plot.append("text")
            .attr("x", width / 2)
            .attr("y", margins.top / 2)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("text-decoration", "underline")
            .text("Tumor abundance plot");

          fish_plot.selectAll("circle")
            .data(Object.keys(tumor_sizes).filter(d => d >= Math.min(...time_points) & d <= Math.max(...time_points)))
            .join("circle")
            .attr("cx", d => x(d))
            .attr("cy", d => y(tumor_sizes[d]))
            .attr("r", 3)
            .attr("fill", "black")
            .attr("opacity", 0.5);

          let t0 = time_points[0],
            linspace = [t0],
            step = (time_points[time_points.length - 1] - t0) / 100;
          for (let i = 1; i < 101; i++) {
            linspace.push(i * step + t0);
          }

          let abundance_stack = Array(101).fill(0);

          for (let o in order) {
            let cluster = order[order.length - o - 1],
              unique_population = child_dict[cluster].reduce(
                (a, c) => a.map((d, i) => d - cluster_dict[c].tumor_abundance[i]), cluster_dict[cluster].tumor_abundance
              ),
              base = [],
              head = [],
              interp_pop = tumor_size_t.map(u => interp1d(u, unique_population) * tumor_sizes[u]);
            for (let i in linspace) {
              base.push(x(linspace[i]) + "," + y(abundance_stack[i]));
              abundance_stack[i] += pchip(linspace[i], interp_pop);
              head.push(x(linspace[i]) + "," + y(abundance_stack[i]));
            }
            fish_plot.append("path")
              .datum(linspace)
              .attr("stroke", cluster_dict[cluster].color)
              .attr("stroke-width", breaks[cluster] ? (max_break - breaks[cluster]) * 2 + 1 : 0)
              .attr("stroke-dasharray", 4)
              .attr("fill", "none")
              .attr("opacity", 1.0)
              .attr("d", d3.line()
                .x(d => x(d))
                .y((d, i) => y(abundance_stack[i])));

            fish_plot.append("polygon")
              .attr("points", head.join(" ") + " " + base.reverse().join(" "))
              .attr("fill", cluster_dict[cluster].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");
          }
          fish_plot.append("g")
            .selectAll("line")
            .data(time_points)
            .join("line")
            .attr("x1", d => x(d))
            .attr("y1", y.range()[0])
            .attr("x2", d => x(d))
            .attr("y2", y.range()["length"] + margins.top)
            .attr("stroke", "black")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "1 4");

          this._elements.fish_plot = fish_plot.node();

          this._refresh();

          d3.select(this.element.context.parentElement).append("button")
            .attr("onclick", "$(\"#fish-plot\").fish_plot(\"download\")")
            .attr("style", "font-size: 12px;")
            .html("Download as SVG")

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.fish_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.fish_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "patient1" + ".tumor_abundance_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
          let parent = this.element.context.parentElement;
          parent.removeChild(parent.getElementsByTagName("button")[0])
        }
      });

      let fish_options = false;

      if (fish_options) {
        $("#fish-plot").fish_plot(fish_options)
      }
    })
  </script>
  <style>
    .active-sample:hover {
      background-color: #f0f0f0;
    }

    .removed-sample {
      background-color: gray;
    }

    .active-cluster {
      opacity: 1.0;
    }

    .removed-cluster {
      opacity: 0.2;
    }
  </style>
</head>

<body>
  <main>
    <div class="container-fluid">
      <div class="row">
        <h2 class="ml-3" >Phylogic Results - patient1</h2>
      </div>
      <div class="card">
        <div id="headingOne" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Clustering plot/tree
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne">
          <div class="card-body">
            <div class="row">
              <div id="sample-name-table" style="max-height: 600px; width: 25%; padding-right: 30px; overflow-y: auto; display: table-cell">
              </div><div class="border-right" style="overflow-y: hidden; width: 45%; padding-right: 30px; display: table-cell">
                <div style="min-width: 450px">
                  <div style="display: inline-block; width: 84%; vertical-align: top">
                    <div id="clustering-plot"></div>
                    <div id="treatment-plot"></div>
                    <button onclick="$('#clustering-plot').clustering_plot('download')" style="font-size: 12px">Download as SVG</button>
                  </div><div style="display: inline-block; width: 16%; vertical-align: top">
                    <div id="time-switch"></div>
                    <div id="cluster-switches" style="overflow-x: hidden"></div>
                  </div>
                </div>
              </div><div style="width: 30%">
                <div id="tree"></div>
                <div id="tree-switch"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingTwo" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
              Clonality chart
            </button>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo">
          <div class="card-body">
            <div class="row">
              <div id="mutation-visual" class="col-md-12 overflow-auto"></div>
              <button onclick="$('#mutation-visual').mutation_visual('download')" style="font-size: 12px">Download as SVG</button>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingThree" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
              Mutation table
            </button>
          </h5>
        </div>
        <div id="collapseThree" class="collapse show" aria-labelledby="headingThree">
          <div class="card-body">
            <div class="row">
              <div id="cluster-table" class="col-md-12 overflow-auto"></div>
            </div>
            <button onclick="$('#cluster-table').cluster_table('download_as_tsv')" style="font-size: 12px">Download as TSV</button>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingFour" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
              Other plots
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse show" aria-labelledby="headingFour">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 text-center">
                <div id="mutation-plot"></div>
                <button onclick="$('#mutation-plot').mutation_plot('download')" style="font-size: 12px">Download as SVG</button>
              </div>
              <div class="col-md-6 text-center">
                <div id="fish-plot"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" style="padding-bottom: 50px"></div>
    </div>
  </main>
</body>
</html>